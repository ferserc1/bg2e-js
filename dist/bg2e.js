!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.bg2e=e():t.bg2e=e()}(self,(function(){return(()=>{var t,e,n={757:(t,e,n)=>{t.exports=n(666)},463:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>de});var i=function(){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}},s=function(t){var e={gl:null,supported:!1,experimental:!1};try{e.gl=t.getContext("webgl",{preserveDrawingBuffer:!0}),e.supported=null!=e.gl}catch(t){e.supported=!1}if(!e.supported)try{e.gl=t.getContext("experimental-webgl",{preserveDrawingBuffer:!0}),e.supported=null!=e.gl,e.experimental=!0}catch(t){}return e&&(e.gl.uuid=Symbol(e.gl)),e},r=n(671),o=n(144),a=function(){function t(e){(0,r.Z)(this,t),this.system={},this.browser={},e||(e=navigator.userAgent),this.parseOperatingSystem(e),this.parseBrowser(e)}return(0,o.Z)(t,[{key:"parseOperatingSystem",value:function(t){this.system.OSX=/Macintosh/.test(t),this.system.Windows=/Windows/.test(t),this.system.iPhone=/iPhone/.test(t),this.system.iPodTouch=/iPod/.test(t),this.system.iPad=/iPad/.test(t),this.system.iOS=this.system.iPhone||this.system.iPad||this.system.iPodTouch,this.system.Android=/Android/.test(t),this.system.Linux=!this.system.Android&&/Linux/.test(t),this.system.OSX?(this.system.OSName="OS X",this.parseOSXVersion(t)):this.system.Windows?(this.system.OSName="Windows",this.parseWindowsVersion(t)):this.system.Linux?(this.system.OSName="Linux",this.parseLinuxVersion(t)):this.system.iOS?(this.system.OSName="iOS",this.parseIOSVersion(t)):this.system.Android&&(this.system.OSName="Android",this.parseAndroidVersion(t))}},{key:"parseBrowser",value:function(t){if(this.browser.Version={},this.browser.Safari=/Version\/([\d\.]+) Safari\//.test(t),this.browser.Safari&&(this.browser.Name="Safari",this.browser.Vendor="Apple",this.browser.Version.versionString=RegExp.$1),this.browser.Chrome=/Chrome\/([\d\.]+) Safari\//.test(t),this.browser.Chrome&&(this.browser.Name="Chrome",this.browser.Vendor="Google",this.browser.Version.versionString=RegExp.$1),this.browser.Opera=/Opera\/[\d\.]+/.test(t),this.browser.Opera&&(this.browser.Name="Opera",this.browser.Vendor="Opera Software",/Version\/([\d\.]+)/.test(t),this.browser.Version.versionString=RegExp.$1),this.browser.Firefox=/Gecko\/[\d\.]+ Firefox\/([\d\.]+)/.test(t),this.browser.Firefox&&(this.browser.Name="Firefox",this.browser.Vendor="Mozilla Foundation",this.browser.Version.versionString=RegExp.$1),this.browser.Edge=/Edge\/(.*)/.test(t),this.browser.Edge){var e=/Edge\/(.*)/.exec(t);this.browser.Name="Edge",this.browser.Chrome=!1,this.browser.Vendor="Microsoft",this.browser.Version.versionString=e[1]}if(this.browser.Explorer=/MSIE ([\d\.]+)/.test(t),this.browser.Explorer)this.browser.Name="Internet Explorer",this.browser.Vendor="Microsoft",this.browser.Version.versionString=RegExp.$1;else{var n=/\Mozilla\/5.0 \(([^)]+)\) like Gecko/,i=n.exec(t);if(i){var s=(n=/rv:(.*)/).exec(i[1]);this.browser.Explorer=!0,this.browser.Name="Internet Explorer",this.browser.Vendor="Microsoft",this.browser.Version.versionString=s?s[1]:"unknown"}}this.system.iOS?(this.browser.IsMobileVersion=!0,this.browser.MobileSafari=/Version\/([\d\.]+) Mobile/.test(t),this.browser.MobileSafari&&(this.browser.Name="Mobile Safari",this.browser.Vendor="Apple",this.browser.Version.versionString=RegExp.$1),this.browser.Android=!1):this.system.Android?(this.browser.IsMobileVersion=!0,this.browser.Android=/Version\/([\d\.]+) Mobile/.test(t),this.browser.MobileSafari?(this.browser.Name="Android Browser",this.browser.Vendor="Google",this.browser.Version.versionString=RegExp.$1):(this.browser.Chrome=/Chrome\/([\d\.]+)/.test(t),this.browser.Name="Chrome",this.browser.Vendor="Google",this.browser.Version.versionString=RegExp.$1),this.browser.Safari=!1):this.browser.IsMobileVersion=!1,this.parseBrowserVersion(t)}},{key:"parseBrowserVersion",value:function(t){/([\d]+)\.([\d]+)\.*([\d]*)/.test(this.browser.Version.versionString)&&(this.browser.Version.major=Number(RegExp.$1),this.browser.Version.minor=Number(RegExp.$2),this.browser.Version.revision=RegExp.$3?Number(RegExp.$3):0)}},{key:"parseOSXVersion",value:function(t){var e=/Mac OS X (\d+_\d+_*\d*)/.test(t)?RegExp.$1:"";switch(this.system.Version={},""!=e?/(\d+)_(\d+)_*(\d*)/.test(e)&&(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0):(e=/Mac OS X (\d+\.\d+\.*\d*)/.test(t)?RegExp.$1:"Unknown",/(\d+)\.(\d+)\.*(\d*)/.test(e)&&(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0)),this.system.Version.major||(this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.revision=0),this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision,this.system.Version.minor){case 0:this.system.Version.name="Cheetah";break;case 1:this.system.Version.name="Puma";break;case 2:this.system.Version.name="Jaguar";break;case 3:this.system.Version.name="Panther";break;case 4:this.system.Version.name="Tiger";break;case 5:this.system.Version.name="Leopard";break;case 6:this.system.Version.name="Snow Leopard";break;case 7:this.system.Version.name="Lion";break;case 8:this.system.Version.name="Mountain Lion"}}},{key:"parseWindowsVersion",value:function(t){if(this.system.Version={},/NT (\d+)\.(\d*)/.test(t)){this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=0,this.system.Version.stringValue="NT "+this.system.Version.major+"."+this.system.Version.minor;var e=this.system.Version.major,n=this.system.Version.minor;5==e?this.system.Version.name=0==n?"2000":"XP":6==e&&(0==n?this.system.Version.name="Vista":1==n?this.system.Version.name="7":2==n&&(this.system.Version.name="8"))}else this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.name="Unknown",this.system.Version.stringValue="Unknown"}},{key:"parseLinuxVersion",value:function(t){this.system.Version={},this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.revision=0,this.system.Version.name="",this.system.Version.stringValue="Unknown distribution"}},{key:"parseIOSVersion",value:function(t){this.system.Version={},/iPhone OS (\d+)_(\d+)_*(\d*)/i.test(t)?(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0,this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision,this.system.Version.name="iOS"):(this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.name="Unknown",this.system.Version.stringValue="Unknown")}},{key:"parseAndroidVersion",value:function(t){this.system.Version={},/Android (\d+)\.(\d+)\.*(\d*)/.test(t)?(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0,this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision):(this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.revision=0),/Build\/([a-zA-Z]+)/.test(t)?this.system.Version.name=RegExp.$1:this.system.Version.name="Unknown version",this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision}},{key:"getInfoString",value:function(){return navigator.userAgent}}]),t}(),u=function(){function t(){(0,r.Z)(this,t)}return(0,o.Z)(t,[{key:"sep",get:function(){return"/"}},{key:"join",value:function(t,e){return t.lastIndexOf(this.sep)!=t.length-1?t+this.sep+e:t+e}},{key:"extension",value:function(t){return t.split(".").pop()}},{key:"fileName",value:function(t){return t.split(this.sep).pop()}},{key:"removeFileName",value:function(t){var e=t.split(this.sep);return e.pop(),e.join(this.sep)}}]),t}();window.s_bg_utils_preventImageDump=window.s_bg_utils_preventImageDump||[],window.s_bg_utils_preventVideoDump=window.s_bg_utils_preventVideoDump||[];var h=function(t){window.s_bg_utils_preventImageDump.push(t)},l=function(t){var e=window.s_bg_utils_preventImageDump.indexOf(t);-1!==e&&window.s_bg_utils_preventImageDump.splice(e,1)},c=function(t){window.s_bg_utils_preventVideoDump.push(t)},_=function(t){var e=window.s_bg_utils_preventVideoDump.indexOf(t);-1!==e&&window.s_bg_utils_preventVideoDump.splice(e,1)},f=function(){function t(){(0,r.Z)(this,t)}return(0,o.Z)(t,[{key:"getRequest",value:function(t,e,n,i){}},{key:"loadImage",value:function(t,e,n){}},{key:"loadVideo",value:function(t,e,n){}}]),t}();function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function g(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}window.s_bg_utils_videoLoaders=window.s_bg_utils_videoLoaders||{},window.s_bg_utils_videoLoaders.mp4=function(t,e,n){var i=document.createElement("video");c(i),i.crossOrigin="",i.autoplay=!0,i.setAttribute("playsinline",null),i.addEventListener("canplay",(function(t){_(t.target),e(t.target)})),i.addEventListener("error",(function(e){n(new Error("Error loading video: ".concat(t)))})),i.addEventListener("abort",(function(e){n(new Error("Error loading video: ".concat(t)))})),i.src=t},window.s_bg_utils_videoLoaders.m4v=window.s_bg_utils_videoLoaders.mp4;var y=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){return(0,r.Z)(this,s),i.apply(this,arguments)}return(0,o.Z)(s,[{key:"getRequest",value:function(t,e,n,i){var s=new XMLHttpRequest;return i||(i=function(t){console.log("Loading ".concat(t.file,": ").concat(t.loaded/t.total*100," %"))}),s.open("GET",t,!0),s.addEventListener("load",(function(){200===s.status?e(s):n(new Error("Error receiving data: ".concat(s.status,", url: ").concat(t)))}),!1),s.addEventListener("error",(function(){n(new Error("Cannot make AJAX request. Url: ".concat(t)))}),!1),s.addEventListener("progress",(function(e){i({file:t,loaded:e.loaded,total:e.total})}),!1),s}},{key:"loadImage",value:function(t,e,n){var i=new Image;h(i),i.crossOrigin="",i.addEventListener("load",(function(t){l(t.target),e(t.target)})),i.addEventListener("error",(function(e){n(new Error("Error loading image: ".concat(t)))})),i.addEventListener("abort",(function(e){n(new Error("Image load aborted: ".concat(t)))})),i.src=t+"?"+bg.utils.generateUUID()}},{key:"loadVideo",value:function(t,e,n){var i=Resource.GetExtension(t),s=bg.utils.HTTPResourceProvider.GetVideoLoaderForType(i);s?s.apply(this,[t,e,n]):n(new Error("Could not find video loader for resource: ".concat(t)))}}],[{key:"AddVideoLoader",value:function(t,e){window.s_bg_utils_videoLoaders[t]=e}},{key:"GetVideoLoaderForType",value:function(t){return window.s_bg_utils_videoLoaders[t]}},{key:"GetCompatibleVideoFormats",value:function(){return Object.keys(window.s_bg_utils_videoLoaders)}},{key:"IsVideoCompatible",value:function(t){var e=Resource.GetExtension(t);return-1!=bg.utils.HTTPResourceProvider.GetCompatibleVideoFormats().indexOf(e)}}]),s}(f),k=new y,E="bg2e:image-load",w=function(t){var e=new CustomEvent(E,{image:t});document.dispatchEvent(e)},M=function(t){return document.addEventListener(E,t)},x=function(){function t(){(0,r.Z)(this,t)}return(0,o.Z)(t,null,[{key:"SetResourceProvider",value:function(t){k=t}},{key:"GetResourceProvider",value:function(){return k}},{key:"GetExtension",value:function(t){var e=/\.([a-z0-9-_]*)(\?.*)?(\#.*)?$/i.exec(t);return e&&e[1].toLowerCase()||""}},{key:"JoinUrl",value:function(t,e){return 0==t.length?e:0==e.length?t:/\/$/.test(t)?t+e:t+"/"+e}},{key:"IsFormat",value:function(e,n){return null!=n.find((function(t){return t==this}),t.GetExtension(e))}},{key:"IsImage",value:function(e){return t.IsFormat(e,["jpg","jpeg","gif","png"])}},{key:"IsBinary",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["vwglb","bg2"];return t.IsFormat(e,n)}},{key:"IsVideo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["mp4","m4v","ogg","ogv","m3u8","webm"];return t.IsFormat(e,n)}},{key:"LoadMultiple",value:function(e,n){var i={},s=function(t){i[t.file]=t;var s=0,r=0;for(var o in i){var a=i[o];s+=a.total,r+=a.loaded}n?n({fileList:e,total:s,loaded:r}):console.log("Loading ".concat(Object.keys(i).length," files: ").concat(r/s*100,"% completed"))},r=[];e.forEach((function(e){r.push(t.Load(e,s))}));var o=r.map((function(t){return new Promise((function(e){var n=new Array(2);t.then((function(t){n[0]=t})).catch((function(t){n[1]=t})).then((function(){e(n)}))}))}));return Promise.all(o).then((function(t){var n={};return e.forEach((function(e,i){var s=t[i];n[e]=s[1]?null:s[0]})),n}))}},{key:"Load",value:function(e,n){var i=null;switch(!0){case e.constructor===Array:i=t.LoadMultiple;break;case t.IsImage(e):i=t.LoadImage;break;case t.IsBinary(e):i=t.LoadBinary;break;case t.IsVideo(e):i=t.LoadVideo;break;case"json"==t.GetExtension(e):i=t.LoadJson;break;default:i=t.LoadText}return i(e,n)}},{key:"LoadText",value:function(t,e){return new Promise((function(n,i){k.getRequest(t,(function(t){n(t.responseText)}),(function(t){i(t)}),e).send()}))}},{key:"LoadVideo",value:function(t,e){return new Promise((function(e,n){k.loadVideo(t,(function(t){e(t),w(t)}),(function(t){n(t)}))}))}},{key:"LoadBinary",value:function(t,e){return new Promise((function(n,i){var s=k.getRequest(t,(function(t){n(t.response)}),(function(t){i(t)}),e);s.responseType="arraybuffer",s.send()}))}},{key:"LoadImage",value:function(t){return new Promise((function(e,n){k.loadImage(t,(function(t){e(t),w(t)}),(function(t){n(t)}))}))}},{key:"LoadJson",value:function(t){return new Promise((function(e,n){k.getRequest(t,(function(t){try{e(JSON.parse(t.responseText))}catch(t){n(new Error("Error parsing JSON data"))}}),(function(t){n(t)})).send()}))}}]),t}();window.s_bg_utils_Engine=null;var b=function(){function t(){(0,r.Z)(this,t),this._shaderLibrary={inputs:{},functions:{}}}return(0,o.Z)(t,[{key:"id",get:function(){return this._engineId}},{key:"texture",get:function(){return this._texture}},{key:"pipeline",get:function(){return this._pipeline}},{key:"polyList",get:function(){return this._polyList}},{key:"shader",get:function(){return this._shader}},{key:"colorBuffer",get:function(){return this._colorBuffer}},{key:"textureBuffer",get:function(){return this._textureBuffer}},{key:"shaderSource",get:function(){return this._shaderSource}},{key:"cubemapCapture",get:function(){return this._cubemapCapture}},{key:"textureMerger",get:function(){return this._textureMerger}}],[{key:"Set",value:function(t){window.s_bg_utils_Engine=t}},{key:"Get",value:function(){return window.s_bg_utils_Engine}}]),t}(),S=function(){function t(){(0,r.Z)(this,t)}return(0,o.Z)(t,[{key:"init",value:function(){}},{key:"frame",value:function(t){}},{key:"displayGizmo",value:function(t,e){}},{key:"willDisplay",value:function(t,e){}},{key:"display",value:function(t,e){}},{key:"didDisplay",value:function(t,e){}},{key:"willUpdate",value:function(t,e,n){}},{key:"draw",value:function(t,e,n,i){}},{key:"didUpdate",value:function(t,e,n){}},{key:"reshape",value:function(t,e,n,i){}},{key:"keyDown",value:function(t){}},{key:"keyUp",value:function(t){}},{key:"mouseUp",value:function(t){}},{key:"mouseDown",value:function(t){}},{key:"mouseMove",value:function(t){}},{key:"mouseOut",value:function(t){}},{key:"mouseDrag",value:function(t){}},{key:"mouseWheel",value:function(t){}},{key:"touchStart",value:function(t){}},{key:"touchMove",value:function(t){}},{key:"touchEnd",value:function(t){}},{key:"postRedisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;bg.app.MainLoop.singleton.postRedisplay(t)}},{key:"postReshape",value:function(){bg.app.MainLoop.singleton.postReshape()}}]),t}();!function(t){function e(t){var e,i;if(m=!1,v=d=(t+="").length,d>63){for(n(t.substring(0,64)),s(h),m=!0,e=128;d>=e;e+=64)n(t.substring(e-64,e)),r(h);t=t.substring(e-64),d=t.length}for(u[0]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0,e=0;d>e;e++)0==(i=3&e)?u[e>>2]=t.charCodeAt(e):u[e>>2]|=t.charCodeAt(e)<<_[i];return u[e>>2]|=l[3&e],e>55?(m?r(u):(s(u),m=!0),r([0,0,0,0,0,0,0,0,0,0,0,0,0,0,v<<3,0])):(u[14]=v<<3,void(m?r(u):s(u)))}function n(t){for(var e=16;e--;){var n=e<<2;h[e]=t.charCodeAt(n)+(t.charCodeAt(n+1)<<8)+(t.charCodeAt(n+2)<<16)+(t.charCodeAt(n+3)<<24)}}function i(t,e,n,i,s,r,o){return((e+=t+i+o)<<s|e>>>r)+n<<0}function s(t){o(0,0,0,0,t),f[0]=g[0]+1732584193<<0,f[1]=g[1]-271733879<<0,f[2]=g[2]-1732584194<<0,f[3]=g[3]+271733878<<0}function r(t){o(f[0],f[1],f[2],f[3],t),f[0]=g[0]+f[0]<<0,f[1]=g[1]+f[1]<<0,f[2]=g[2]+f[2]<<0,f[3]=g[3]+f[3]<<0}function o(t,e,n,s,r){var o,a;m?(t=i((n^s)&e^s,t,e,r[0],7,25,-680876936),s=i((e^n)&t^n,s,t,r[1],12,20,-389564586),n=i((t^e)&s^e,n,s,r[2],17,15,606105819),e=i((s^t)&n^t,e,n,r[3],22,10,-1044525330)):(t=((t=r[0]-680876937)<<7|t>>>25)-271733879<<0,s=((s=r[1]-117830708+(2004318071&t^-1732584194))<<12|s>>>20)+t<<0,n=((n=r[2]-1126478375+((-271733879^t)&s^-271733879))<<17|n>>>15)+s<<0,e=((e=r[3]-1316259209+((s^t)&n^t))<<22|e>>>10)+n<<0),t=i((n^s)&e^s,t,e,r[4],7,25,-176418897),s=i((e^n)&t^n,s,t,r[5],12,20,1200080426),n=i((t^e)&s^e,n,s,r[6],17,15,-1473231341),e=i((s^t)&n^t,e,n,r[7],22,10,-45705983),t=i((n^s)&e^s,t,e,r[8],7,25,1770035416),s=i((e^n)&t^n,s,t,r[9],12,20,-1958414417),n=i((t^e)&s^e,n,s,r[10],17,15,-42063),e=i((s^t)&n^t,e,n,r[11],22,10,-1990404162),t=i((n^s)&e^s,t,e,r[12],7,25,1804603682),s=i((e^n)&t^n,s,t,r[13],12,20,-40341101),n=i((t^e)&s^e,n,s,r[14],17,15,-1502002290),e=i((s^t)&n^t,e,n,r[15],22,10,1236535329),t=i((e^n)&s^n,t,e,r[1],5,27,-165796510),s=i((t^e)&n^e,s,t,r[6],9,23,-1069501632),n=i((s^t)&e^t,n,s,r[11],14,18,643717713),e=i((n^s)&t^s,e,n,r[0],20,12,-373897302),t=i((e^n)&s^n,t,e,r[5],5,27,-701558691),s=i((t^e)&n^e,s,t,r[10],9,23,38016083),n=i((s^t)&e^t,n,s,r[15],14,18,-660478335),e=i((n^s)&t^s,e,n,r[4],20,12,-405537848),t=i((e^n)&s^n,t,e,r[9],5,27,568446438),s=i((t^e)&n^e,s,t,r[14],9,23,-1019803690),n=i((s^t)&e^t,n,s,r[3],14,18,-187363961),e=i((n^s)&t^s,e,n,r[8],20,12,1163531501),t=i((e^n)&s^n,t,e,r[13],5,27,-1444681467),s=i((t^e)&n^e,s,t,r[2],9,23,-51403784),n=i((s^t)&e^t,n,s,r[7],14,18,1735328473),e=i((n^s)&t^s,e,n,r[12],20,12,-1926607734),t=i((o=e^n)^s,t,e,r[5],4,28,-378558),s=i(o^t,s,t,r[8],11,21,-2022574463),n=i((a=s^t)^e,n,s,r[11],16,16,1839030562),e=i(a^n,e,n,r[14],23,9,-35309556),t=i((o=e^n)^s,t,e,r[1],4,28,-1530992060),s=i(o^t,s,t,r[4],11,21,1272893353),n=i((a=s^t)^e,n,s,r[7],16,16,-155497632),e=i(a^n,e,n,r[10],23,9,-1094730640),t=i((o=e^n)^s,t,e,r[13],4,28,681279174),s=i(o^t,s,t,r[0],11,21,-358537222),n=i((a=s^t)^e,n,s,r[3],16,16,-722521979),e=i(a^n,e,n,r[6],23,9,76029189),t=i((o=e^n)^s,t,e,r[9],4,28,-640364487),s=i(o^t,s,t,r[12],11,21,-421815835),n=i((a=s^t)^e,n,s,r[15],16,16,530742520),e=i(a^n,e,n,r[2],23,9,-995338651),t=i(n^(e|~s),t,e,r[0],6,26,-198630844),s=i(e^(t|~n),s,t,r[7],10,22,1126891415),n=i(t^(s|~e),n,s,r[14],15,17,-1416354905),e=i(s^(n|~t),e,n,r[5],21,11,-57434055),t=i(n^(e|~s),t,e,r[12],6,26,1700485571),s=i(e^(t|~n),s,t,r[3],10,22,-1894986606),n=i(t^(s|~e),n,s,r[10],15,17,-1051523),e=i(s^(n|~t),e,n,r[1],21,11,-2054922799),t=i(n^(e|~s),t,e,r[8],6,26,1873313359),s=i(e^(t|~n),s,t,r[15],10,22,-30611744),n=i(t^(s|~e),n,s,r[6],15,17,-1560198380),e=i(s^(n|~t),e,n,r[13],21,11,1309151649),t=i(n^(e|~s),t,e,r[4],6,26,-145523070),s=i(e^(t|~n),s,t,r[11],10,22,-1120210379),n=i(t^(s|~e),n,s,r[2],15,17,718787259),e=i(s^(n|~t),e,n,r[9],21,11,-343485551),g[0]=t,g[1]=e,g[2]=n,g[3]=s}var a=[],u=[],h=[],l=[],c="0123456789abcdef".split(""),_=[],f=[],m=!1,v=0,d=0,g=[];if(t.Int32Array)u=new Int32Array(16),h=new Int32Array(16),l=new Int32Array(4),_=new Int32Array(4),f=new Int32Array(4),g=new Int32Array(4);else{var p;for(p=0;16>p;p++)u[p]=h[p]=0;for(p=0;4>p;p++)l[p]=_[p]=f[p]=g[p]=0}l[0]=128,l[1]=32768,l[2]=8388608,l[3]=-2147483648,_[0]=0,_[1]=8,_[2]=16,_[3]=24,t.md5=t.md5||function(t,n,i){e(n?t:function(t){for(var e="",n="",i=0,s=0,r=0,o=t.length;o>r;r++){var a=t.charCodeAt(r);128>a?s++:(n=2048>a?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),s>i&&(e+=t.slice(i,s)),e+=n,i=s=r+1)}return s>i&&(e+=t.slice(i,o)),e}(t));var s=f[0];return a[1]=c[15&s],a[0]=c[15&(s>>=4)],a[3]=c[15&(s>>=4)],a[2]=c[15&(s>>=4)],a[5]=c[15&(s>>=4)],a[4]=c[15&(s>>=4)],a[7]=c[15&(s>>=4)],a[6]=c[15&(s>>=4)],s=f[1],a[9]=c[15&s],a[8]=c[15&(s>>=4)],a[11]=c[15&(s>>=4)],a[10]=c[15&(s>>=4)],a[13]=c[15&(s>>=4)],a[12]=c[15&(s>>=4)],a[15]=c[15&(s>>=4)],a[14]=c[15&(s>>=4)],s=f[2],a[17]=c[15&s],a[16]=c[15&(s>>=4)],a[19]=c[15&(s>>=4)],a[18]=c[15&(s>>=4)],a[21]=c[15&(s>>=4)],a[20]=c[15&(s>>=4)],a[23]=c[15&(s>>=4)],a[22]=c[15&(s>>=4)],s=f[3],a[25]=c[15&s],a[24]=c[15&(s>>=4)],a[27]=c[15&(s>>=4)],a[26]=c[15&(s>>=4)],a[29]=c[15&(s>>=4)],a[28]=c[15&(s>>=4)],a[31]=c[15&(s>>=4)],a[30]=c[15&(s>>=4)],i?a:a.join("")}}(void 0===n.g?window:n.g);const I=md5;var A=n(9),T={version:"2.0.0",setupRequestAnimFrame:i,initWebGLContext:s,isBigEndian:function(){var t=new Uint32Array(1);return new Uint8Array(t.buffer),t[0]=255,255==t[3]},isLittleEndian:function(){var t=new Uint32Array(1);return new Uint8Array(t.buffer),t[0]=255,255==t[0]},UserAgent:a,userAgent:new a,Path:u,path:new u,ResourceProvider:f,beginImageLoad:h,endImageLoad:l,beginVideoLoad:c,endVideoLoad:_,HTTPResourceProvider:y,Resource:x,IMG_LOAD_EVENT_NAME:E,emitImageLoadEvent:w,bindImageLoadEvent:M,requireGlobal:function(t){var e=document.createElement("script");e.src=t,e.type="text/javascript",e.async=!1,document.getElementsByTagName("head")[0].appendChild(e)},Engine:b,LifeCycle:S,md5:I,generateUUID:function(){var t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))},electron:new A.Z};const N=T;var C,R=function(){function t(e){if((0,r.Z)(this,t),this._domElem=e,this._domElem.style.MozUserSelect="none",this._domElem.style.WebkitUserSelect="none",this._domElem.setAttribute("onselectstart","return false"),this._multisample=1,this._context=s(e),!this._context.supported)throw new Error("Sorry, your browser does not support WebGL.")}return(0,o.Z)(t,[{key:"multisample",get:function(){return this._multisample},set:function(t){this._multisample=t}},{key:"context",get:function(){return this._context}},{key:"domElement",get:function(){return this._domElem}},{key:"width",get:function(){return this._domElem.clientWidth}},{key:"height",get:function(){return this._domElem.clientHeight}},{key:"screenshot",value:function(t,e,n){var i="",s={};e&&(n=n||e,i=this.domElement.style.cssText,s.width=this.domElement.width,s.height=this.domElement.height,this.domElement.style.cssText="top:auto;left:auto;bottom:auto;right:auto;width:"+e+"px;height:"+n+"px;",this.domElement.width=e,this.domElement.height=n);var r=this.domElement.toDataURL(t);return e&&(this.domElement.style.cssText=i,this.domElement.width=s.width,this.domElement.height=s.height),r}}]),t}(),L=function(){function t(e){(0,r.Z)(this,t),this._context=e}return(0,o.Z)(t,[{key:"context",get:function(){return this._context},set:function(t){this._context=t}}]),t}(),O=function(){function t(){(0,r.Z)(this,t),this._executeDefault=!1}return(0,o.Z)(t,[{key:"executeDefault",get:function(){return this._executeDefault},set:function(t){this._executeDefault=t}}]),t}();function V(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var F=(V(C={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",SHIFT:"Shift",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CTRL:"Control",CTRL_LEFT:"ControlLeft"},"CTRL_LEFT","ControlRight"),V(C,"ALT","Alt"),V(C,"ALT_LEFT","AltLeft"),V(C,"ALT_RIGHT","AltRight"),V(C,"PAUSE","Pause"),V(C,"CAPS_LOCK","CapsLock"),V(C,"ESCAPE","Escape"),V(C,"PAGE_UP","PageUp"),V(C,"PAGEDOWN","PageDown"),V(C,"END","End"),V(C,"HOME","Home"),V(C,"LEFT_ARROW","ArrowLeft"),V(C,"UP_ARROW","ArrowUp"),V(C,"RIGHT_ARROW","ArrowRight"),V(C,"DOWN_ARROW","ArrowDown"),V(C,"INSERT","Insert"),V(C,"DELETE","Delete"),C),P=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t,e){var n;return(0,r.Z)(this,s),(n=i.call(this)).key=t,n.event=e,n}return(0,o.Z)(s,[{key:"isSpecialKey",value:function(){return s.IsSpecialKey(this.event)}}],[{key:"IsSpecialKey",value:function(t){return null!=F[t.code]}}]),s}(O);var G={LEFT:0,MIDDLE:1,RIGHT:2,NONE:-1},B=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G.NONE,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return(0,r.Z)(this,s),(t=i.call(this)).button=e,t.x=n,t.y=o,t.delta=a,t.event=u,t}return(0,o.Z)(s)}(O);var D=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t,e){var n;return(0,r.Z)(this,s),(n=i.call(this)).touches=t,n.event=e,n}return(0,o.Z)(s)}(O);window.s_bg_app_mouseStatus={leftButton:!1,middleButton:!1,rightButton:!1,pos:{x:-1,y:-1}},Object.defineProperty(s_bg_app_mouseStatus,"anyButton",{get:function(){return this.leftButton||this.middleButton||this.rightButton}});var U=function(){function t(){(0,r.Z)(this,t)}return(0,o.Z)(t,null,[{key:"LeftButton",value:function(){return s_bg_app_mouseStatus.leftButton}},{key:"MiddleButton",value:function(){return s_bg_app_mouseStatus.middleButton}},{key:"RightButton",value:function(){return s_bg_app_mouseStatus.rightButton}},{key:"Position",value:function(){return s_bg_app_mouseStatus.pos}},{key:"AnyButton",value:function(){return s_bg_app_mouseStatus.anyButton}},{key:"SetLeftButton",value:function(t){return s_bg_app_mouseStatus.leftButton=t,s_bg_app_mouseStatus.leftButton}},{key:"SetMiddleButton",value:function(t){return s_bg_app_mouseStatus.middleButton=t,s_bg_app_mouseStatus.middleButton}},{key:"SetRightButton",value:function(t){return s_bg_app_mouseStatus.rightButton=t,s_bg_app_mouseStatus.rightButton}},{key:"SetPosition",value:function(t,e){return s_bg_app_mouseStatus.pos={x:t,y:e},s_bg_app_mouseStatus.pos}}]),t}();window.s_bg_app_mainLoop=null;var X=0;function H(t){t=t||0,window.requestAnimFrame||i(),requestAnimFrame(H);var e,n=t-X;X=t,e=n,s_bg_app_mainLoop.redisplay&&(s_bg_app_mainLoop.windowController.frame(e),0==s_bg_app_mainLoop.updateMode?s_bg_app_mainLoop._redisplayFrames=1:s_bg_app_mainLoop._redisplayFrames--,s_bg_app_mainLoop.windowController.display())}function Z(){if(s_bg_app_mainLoop.canvas&&s_bg_app_mainLoop.windowController){var t=s_bg_app_mainLoop.canvas.multisample;s_bg_app_mainLoop.canvas.domElement.width=s_bg_app_mainLoop.canvas.width*t,s_bg_app_mainLoop.canvas.domElement.height=s_bg_app_mainLoop.canvas.height*t,s_bg_app_mainLoop.windowController.reshape(s_bg_app_mainLoop.canvas.width*t,s_bg_app_mainLoop.canvas.height*t)}}function z(t){var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=s_bg_app_mainLoop.canvas.multisample,i=U.SetPosition((t.clientX-e.left)*n,(t.clientY-e.top)*multisampl),s=new B(G.NONE,i.x,i.y,0,t);return s_bg_app_mainLoop.windowController.mouseMove(s),U.AnyButton()&&s_bg_app_mainLoop.windowController.mouseDrag(s),s}function j(t){for(var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=[],i=0;i<t.touches.length;++i){var s=t.touches[i];n.push({identifier:s.identifier,x:s.clientX-e.left,y:s.clientY-e.top,force:s.force,rotationAngle:s.rotationAngle,radiusX:s.radiusX,radiusY:s.radiusY})}return new D(n,t)}var W=function(){function t(){var e=this;(0,r.Z)(this,t),this._canvas=null,this._windowController=null,this._updateMode=0,this._redisplayFrames=1,M((function(){e.postRedisplay()}))}return(0,o.Z)(t,[{key:"canvas",get:function(){return this._canvas},set:function(t){this._canvas=new R(t)}},{key:"windowController",get:function(){return this._windowController}},{key:"updateMode",get:function(){return this._updateMode},set:function(t){this._updateMode=t,0==this._updateMode&&(this._redisplayFrames=1)}},{key:"redisplay",get:function(){return this._redisplayFrames>0}},{key:"mouseButtonStatus",get:function(){return s_mouseStatus}},{key:"run",value:function(t){this._windowController=t,this.postRedisplay(),this.windowController.init(),function(){if(Z(),window.addEventListener("resize",(function(){Z()})),!s_bg_app_mainLoop.canvas)throw new Error("Configuration error in MainLoop: no canvas defined");var t=s_bg_app_mainLoop.canvas.domElement;t.addEventListener("mousedown",(function(t){if(!function(t){var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=s_bg_app_mainLoop.canvas.multisample,i=U.Position();switch(i.x=(t.clientX-e.left)*n,i.y=(t.clientY-e.top)*n,t.button){case G.LEFT:U.SetLeftButton(!0);break;case G.MIDDLE:U.SetMiddleButton(!0);break;case G.RIGHT:U.SetRightButton(!0)}var s=new B(t.button,i.x,i.y,0,t);return s_bg_app_mainLoop.windowController.mouseDown(s),s}(t).executeDefault)return t.preventDefault(),!1})),t.addEventListener("mousemove",(function(t){if(!z(t).executeDefault)return t.preventDefault(),!1})),t.addEventListener("mouseout",(function(t){if(!(e=U.Position(),n=new B(G.NONE,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseOut(n),U.LeftButton()&&(U.SetLeftButton(!1),n=new B(G.LEFT,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseUp(n)),U.MiddleButton()&&(U.SetMiddleButton(!1),n=new B(G.MIDDLE,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseUp(n)),U.RightButton()&&(U.SetRightButton(!1),n=new B(G.RIGHT,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseUp(n)),n).executeDefault)return t.preventDefault(),!1;var e,n})),t.addEventListener("mouseover",(function(t){if(!(e=t,z(e)).executeDefault)return t.preventDefault(),!1;var e})),t.addEventListener("mouseup",(function(t){if(!function(t){switch(t.button){case G.LEFT:U.SetLeftButton(!1);break;case G.MIDDLE:U.SetMiddleButton(!1);break;case G.RIGHT:U.SetRightButton(!1)}var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=s_bg_app_mainLoop.canvas.multisample,i=U.SetPosition((t.clientX-e.left)*n,(t.clientY-e.top)*n),s=new B(t.button,i.x,i.y,0,t);return s_bg_app_mainLoop.windowController.mouseUp(s),s}(t).executeDefault)return t.preventDefault(),!1})),t.addEventListener("touchstart",(function(t){if(!(e=t,n=j(e),s_bg_app_mainLoop.windowController.touchStart(n),n).executeDefault)return t.preventDefault(),!1;var e,n})),t.addEventListener("touchmove",(function(t){if(!(e=t,n=j(e),s_bg_app_mainLoop.windowController.touchMove(n),n).executeDefault)return t.preventDefault(),!1;var e,n})),t.addEventListener("touchend",(function(t){if(!(e=t,n=j(e),s_bg_app_mainLoop.windowController.touchEnd(n),n).executeDefault)return t.preventDefault(),!1;var e,n}));var e=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";t.addEventListener(e,(function(t){if(!(e=t,n=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),i=s_bg_app_mainLoop.canvas.multisample,s=U.SetPosition((e.clientX-n.left)*i,(e.clientY-n.top)*i),r=e.wheelDelta?-1*e.wheelDelta:10*e.detail,o=new B(G.NONE,s.x,s.y,r,e),s_bg_app_mainLoop.windowController.mouseWheel(o),o).executeDefault)return t.preventDefault(),!1;var e,n,i,s,r,o})),window.addEventListener("keydown",(function(t){var e,n;e=t,n=P.IsSpecialKey(e)?e.keyCode:e.code,s_bg_app_mainLoop.windowController.keyDown(new P(n,e))})),window.addEventListener("keyup",(function(t){var e,n;e=t,n=P.IsSpecialKey(e)?e.keyCode:e.code,s_bg_app_mainLoop.windowController.keyUp(new P(n,e))})),t.oncontextmenu=function(t){return!1}}(),H()}},{key:"postRedisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this._redisplayFrames=t}},{key:"postReshape",value:function(){Z()}}]),t}();Object.defineProperty(W,"singleton",{get:function(){return s_bg_app_mainLoop||(s_bg_app_mainLoop=new W),s_bg_app_mainLoop}});var Y=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){return(0,r.Z)(this,s),i.apply(this,arguments)}return(0,o.Z)(s,[{key:"postRedisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;W.singleton.postRedisplay(t)}},{key:"postReshape",value:function(){W.singleton.postReshape()}},{key:"canvas",get:function(){return W.singleton.canvas}},{key:"context",get:function(){return W.singleton.canvas.context}},{key:"gl",get:function(){return W.singleton.canvas.context.gl}}]),s}(S);const K={Canvas:R,ContextObject:L,EventBase:O,SpecialKey:F,KeyboardEvent:P,MouseEvent:B,MouseButton:G,TouchEvent:D,Mouse:U,MainLoop:W,WindowController:Y};var $={VERTEX:null,FRAGMENT:null};window.s_bg_base_activeShader=null;var q=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t){var e;return(0,r.Z)(this,s),(e=i.call(this,t))._shader=b.Get().shader.create(t),e._linked=!1,e._compileError=null,e._linkError=null,e}return(0,o.Z)(s,[{key:"shader",get:function(){return this._shader}},{key:"compileError",get:function(){return this._compileError}},{key:"compileErrorSource",get:function(){return this._compileErrorSource}},{key:"linkError",get:function(){return this._linkError}},{key:"status",get:function(){return null==this._compileError&&null==this._linkError}},{key:"addShaderSource",value:function(t,e){var n;return this._linked?this._compileError="Tying to attach a shader to a linked program":this._compileError||(this._compileError=b.Get().shader.addShaderSource(this.context,this._shader,t,e),this._compileError&&(this._compileErrorSource=(n="",e.split("\n").forEach((function(t,e){++e,n+=(e<10?"00":e<100?"0":"")+e+" | "+t+"\n"})),n))),null==this._compileError}},{key:"link",value:function(){return this._linkError=null,this._linked?this._linkError="Shader already linked":(this._linkError=b.Get().shader.link(this.context,this._shader),this._linked=null==this._linkError),this._linked}},{key:"setActive",value:function(){b.Get().shader.setActive(this.context,this._shader),g_window.s_bg_base_activeShader=this}},{key:"clearActive",value:function(){s.ClearActive(this.context),g_window.s_bg_base_activeShader=null}},{key:"initVars",value:function(t,e){b.Get().shader.initVars(this.context,this._shader,t,e)}},{key:"setInputBuffer",value:function(t,e,n){b.Get().shader.setInputBuffer(this.context,this._shader,t,e,n)}},{key:"disableInputBuffer",value:function(t){b.Get().shader.disableInputBuffer(this.context,this._shader,t)}},{key:"setValueInt",value:function(t,e){b.Get().shader.setValueInt(this.context,this._shader,t,e)}},{key:"setValueIntPtr",value:function(t,e){b.Get().shader.setValueIntPtr(this.context,this._shader,t,e)}},{key:"setValueFloat",value:function(t,e){b.Get().shader.setValueFloat(this.context,this._shader,t,e)}},{key:"setValueFloatPtr",value:function(t,e){b.Get().shader.setValueFloatPtr(this.context,this._shader,t,e)}},{key:"setVector2",value:function(t,e){b.Get().shader.setValueVector2(this.context,this._shader,t,e)}},{key:"setVector3",value:function(t,e){b.Get().shader.setValueVector3(this.context,this._shader,t,e)}},{key:"setVector4",value:function(t,e){b.Get().shader.setValueVector4(this.context,this._shader,t,e)}},{key:"setVector2Ptr",value:function(t,e){b.Get().shader.setValueVector2v(this.context,this._shader,t,e)}},{key:"setVector3Ptr",value:function(t,e){b.Get().shader.setValueVector3v(this.context,this._shader,t,e)}},{key:"setVector4Ptr",value:function(t,e){b.Get().shader.setValueVector4v(this.context,this._shader,t,e)}},{key:"setMatrix3",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.Get().shader.setValueMatrix3(this.context,this._shader,t,n,e)}},{key:"setMatrix4",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];b.Get().shader.setValueMatrix4(this.context,this._shader,t,n,e)}},{key:"setTexture",value:function(t,e,n){b.Get().shader.setTexture(this.context,this._shader,t,e,n)}},{key:"destroy",value:function(){console.warn("TODO: Shader.destroy(): not implemented.")}}],[{key:"ClearActive",value:function(t){b.Get().shader.setActive(t,null)}},{key:"GetActiveShader",value:function(){return window.s_bg_base_activeShader}}]),s}(L);var J=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t){var e;return(0,r.Z)(this,s),(e=i.call(this,t))._shader=null,e._inputVars=[],e._shaders=[],e}return(0,o.Z)(s,[{key:"inputVars",get:function(){return this._inputVars}},{key:"numberOfShaders",get:function(){return this._shaders.length}},{key:"setCurrentShader",value:function(t){this._shader=this._shaders[t]}},{key:"shader",get:function(){return this._shader}},{key:"setupShaderSource",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n?this._shaders.length:0,s=new q(this.context);this._inputVars=[];var r=[],o=[];return t.forEach((function(t){t.params.forEach((function(t){t&&("buffer"==t.role?(e._inputVars[t.target]=t.name,r.push(t.name)):"value"==t.role&&o.push(t.name))})),s.addShaderSource(t.type,t.toString())})),s.link(),s.status?s.initVars(r,o):(console.error(s.compileError),s.compileErrorSource&&(console.error("Shader source:"),console.error(s.compileErrorSource)),console.error(s.linkError)),n?(this._shaders.push(s),this._shader||(this._shader=s)):(this._shaders=[s],this._shader=s),i}},{key:"beginDraw",value:function(){}},{key:"setupVars",value:function(){}},{key:"setActive",value:function(){this.shader.setActive(),this.beginDraw()}},{key:"clearActive",value:function(){this.shader.clearActive()}},{key:"bindPolyList",value:function(t){var e=this.shader;this.inputVars.vertex&&e.setInputBuffer(this.inputVars.vertex,t.vertexBuffer,3),this.inputVars.normal&&e.setInputBuffer(this.inputVars.normal,t.normalBuffer,3),this.inputVars.tex0&&e.setInputBuffer(this.inputVars.tex0,t.texCoord0Buffer,2),this.inputVars.tex1&&e.setInputBuffer(this.inputVars.tex1,t.texCoord1Buffer,2),this.inputVars.tex2&&e.setInputBuffer(this.inputVars.tex2,t.texCoord2Buffer,2),this.inputVars.color&&e.setInputBuffer(this.inputVars.color,t.colorBuffer,4),this.inputVars.tangent&&e.setInputBuffer(this.inputVars.tangent,t.tangentBuffer,3),this.setupVars()}},{key:"unbind",value:function(){var t=this.shader;this.inputVars.vertex&&t.disableInputBuffer(this.inputVars.vertex),this.inputVars.normal&&t.disableInputBuffer(this.inputVars.normal),this.inputVars.tex0&&t.disableInputBuffer(this.inputVars.tex0),this.inputVars.tex1&&t.disableInputBuffer(this.inputVars.tex1),this.inputVars.tex2&&t.disableInputBuffer(this.inputVars.tex2),this.inputVars.color&&t.disableInputBuffer(this.inputVars.color),this.inputVars.tangent&&t.disableInputBuffer(this.inputVars.tangent)}}]),s}(L);function Q(t,e,n,i,s,r,o){try{var a=t[r](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,s)}var tt=n(757),et=n.n(tt),nt=function(){function t(){(0,r.Z)(this,t)}var e,n;return(0,o.Z)(t,[{key:"acceptType",value:function(t,e){return!1}},{key:"load",value:(e=et().mark((function t(e,n,i){return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Error("Not implemented"));case 1:case"end":return t.stop()}}),t)})),n=function(){var t=this,n=arguments;return new Promise((function(i,s){var r=e.apply(t,n);function o(t){Q(r,i,s,o,a,"next",t)}function a(t){Q(r,i,s,o,a,"throw",t)}o(void 0)}))},function(t,e,i){return n.apply(this,arguments)})}]),t}();function it(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(s,r){x.Load(e,n).then((function(n){return ot.LoadData(t,e,n,i)})).then((function(t,e){s(t,e)})).catch((function(t){r(t)}))}))}function st(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(s,r){x.LoadMultiple(e,n).then((function(e){var n=[];for(var s in e){var r=e[s];n.push(rt(t,s,r,i))}return Promise.all(n)})).then((function(t){var n={};e.forEach((function(e,i){n[e]=t[i]})),s(n)})).catch((function(t){r(t)}))}))}function rt(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(s,r){var o=null;if(s_loaderPlugins.some((function(t){if(t.acceptType(e,n))return o=t,!0})),!o)return r(new Error("No suitable plugin found for load "+e));i||(i={}),s(o.load(t,e,n,i))}))}window.s_bg_base_loaderPlugins=window.s_bg_base_loaderPlugins||[];var ot=function(){function t(){(0,r.Z)(this,t)}return(0,o.Z)(t,null,[{key:"RegisterPlugin",value:function(t){window.s_bg_base_loaderPlugins.push(t)}},{key:"Load",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Array.isArray(e)?st(t,e,n,i):it(t,e,n,i)}},{key:"LoadData",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return rt(t,e,n,i)}}]),t}(),at={NONE:0,X:1,Y:2,Z:3,name:function(t){switch(t){case at.NONE:return"NONE";case at.X:return"X";case at.Y:return"Y";case at.Z:return"Z";case at.W:return"W";default:return"UNKNOWN"}}},ut=3.141592653589793,ht=.01745329251994,lt=57.29577951308233,ct=1e-7,_t=Float32Array,ft=Array;function mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=p(t);if(e){var s=p(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return g(this,n)}}var vt=function(){function t(e){(0,r.Z)(this,t),this._v=e}return(0,o.Z)(t,[{key:"v",get:function(){return this._v}},{key:"length",get:function(){return this._v.length}},{key:"x",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"y",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"module",get:function(){return this.magnitude()}},{key:"toArray",value:function(){for(var t=[],e=0;e<this.v.length;++e)t.push(this.v[e]);return t}}],[{key:"MinComponents",value:function(t,e){var n=Math.min(t.length,e.length),i=null;switch(n){case 2:i=new dt;break;case 3:i=new gt;break;case 4:i=new pt}for(var s=0;s<n;++s)i._v[s]=t._v[s]<e._v[s]?t._v[s]:e._v[s];return i}},{key:"MaxComponents",value:function(t,e){var n=Math.min(t.length,e.length),i=null;switch(n){case 2:i=new dt;break;case 3:i=new gt;break;case 4:i=new pt}for(var s=0;s<n;++s)i._v[s]=t._v[s]>e._v[s]?t._v[s]:e._v[s];return i}}]),t}(),dt=function(t){v(n,t);var e=mt(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1?arguments[1]:void 0;return(0,r.Z)(this,n),t=e.call(this,new ft(2)),i instanceof n?(t._v[0]=i._v[0],t._v[1]=i._v[1]):Array.isArray(i)&&i.length>=2?(t._v[0]=i[0],t._v[1]=i[1]):(void 0===s&&(s=i),t._v[0]=i,t._v[1]=s),t}return(0,o.Z)(n,[{key:"distance",value:function(t){return new n(this._v[0]-t._v[0],this._v[1]-t._v[1]).magnitude()}},{key:"normalize",value:function(){var t=this.magnitude();return this._v[0]=this._v[0]/t,this._v[1]=this._v[1]/t,this}},{key:"add",value:function(t){return this._v[0]+=t._v[0],this._v[1]+=t._v[1],this}},{key:"sub",value:function(t){return this._v[0]-=t._v[0],this._v[1]-=t._v[1],this}},{key:"dot",value:function(t){return this._v[0]*t._v[0]+this._v[1]*t._v[1]}},{key:"scale",value:function(t){return this._v[0]*=t,this._v[1]*=t,this}},{key:"magnitude",value:function(){return Math.sqrt(this._v[0]*this._v[0]+this._v[1]*this._v[1])}},{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1]}},{key:"set",value:function(t,e){void 0===e&&(e=t),this._v[0]=t,this._v[1]=e}},{key:"width",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"height",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"aspectRatio",get:function(){return this._v[0]/this._v[1]}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])}},{key:"toString",value:function(){return"["+this._v+"]"}}],[{key:"Add",value:function(t,e){return new n(t.x+e.x,t.y+e.y)}},{key:"Sub",value:function(t,e){return new n(t.x-e.x,t.y-e.y)}},{key:"Distance",value:function(t,e){return new n(t._v[0]-e._v[0],t._v[1]-e._v[1]).magnitude()}},{key:"Dot",value:function(t,e){return t._v[0]*e._v[0]+t._v[1]*e._v[1]}},{key:"Cross",value:function(t,e){var n=t._v[1]*e._v[2]-t._v[2]*e._v[1],i=t._v[2]*e._v[0]-t._v[0]*e._v[2],s=t._v[0]*e._v[1]-t._v[1]*e._v[0];return new gt(n,i,s)}}]),n}(vt),gt=function(t){v(n,t);var e=mt(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,r.Z)(this,n),t=e.call(this,new ft(3)),i instanceof dt?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=s):i instanceof n?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=i._v[2]):Array.isArray(i)&&i.length>=3?(t._v[0]=i[0],t._v[1]=i[1],t._v[2]=i[2]):(void 0===s&&(s=i),void 0===o&&(o=s),t._v[0]=i,t._v[1]=s,t._v[2]=o),t}return(0,o.Z)(n,[{key:"z",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"magnitude",value:function(){return Math.sqrt(this._v[0]*this._v[0]+this._v[1]*this._v[1]+this._v[2]*this._v[2])}},{key:"normalize",value:function(){var t=this.magnitude();return this._v[0]=this._v[0]/t,this._v[1]=this._v[1]/t,this._v[2]=this._v[2]/t,this}},{key:"distance",value:function(t){return new n(this._v[0]-t._v[0],this._v[1]-t._v[1],this._v[2]-t._v[2]).magnitude()}},{key:"add",value:function(t){return this._v[0]+=t._v[0],this._v[1]+=t._v[1],this._v[2]+=t._v[2],this}},{key:"sub",value:function(t){return this._v[0]-=t._v[0],this._v[1]-=t._v[1],this._v[2]-=t._v[2],this}},{key:"dot",value:function(t){return this._v[0]*t._v[0]+this._v[1]*t._v[1]+this._v[2]*t._v[2]}},{key:"scale",value:function(t){return this._v[0]*=t,this._v[1]*=t,this._v[2]*=t,this}},{key:"cross",value:function(t){var e=this._v[1]*t._v[2]-this._v[2]*t._v[1],n=this._v[2]*t._v[0]-this._v[0]*t._v[2],i=this._v[0]*t._v[1]-this._v[1]*t._v[0];return this._v[0]=e,this._v[1]=n,this._v[2]=i,this}},{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]&&this._v[2]==t._v[2]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]||this._v[2]!=t._v[2]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],t._v.length>=3&&(this._v[2]=t._v[2])}},{key:"set",value:function(t,e,n){this._v[0]=t,this._v[1]=void 0===e?t:e,this._v[2]=void 0===e?t:void 0===n?e:n}},{key:"width",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"height",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"depth",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"xy",get:function(){return new dt(this._v[0],this._v[1])}},{key:"yz",get:function(){return new dt(this._v[1],this._v[2])}},{key:"xz",get:function(){return new dt(this._v[0],this._v[2])}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])||isNaN(this._v[2])}},{key:"toString",value:function(){return"["+this._v+"]"}}],[{key:"Add",value:function(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z)}},{key:"Sub",value:function(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z)}},{key:"Distance",value:function(t,e){return new n(t._v[0]-e._v[0],t._v[1]-e._v[1],t._v[2]-e._v[2]).magnitude()}},{key:"Dot",value:function(t,e){return t._v[0]*e._v[0]+t._v[1]*e._v[1]+t._v[2]*e._v[2]}},{key:"Cross",value:function(t,e){return new n(t._v[1]*e._v[2]-t._v[2]*e._v[1],t._v[2]*e._v[0]-t._v[0]*e._v[2],t._v[0]*e._v[1]-t._v[1]*e._v[0])}}]),n}(vt),pt=function(t){v(n,t);var e=mt(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return(0,r.Z)(this,n),t=e.call(this,new ft(4)),i instanceof dt?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=s,t._v[3]=o):i instanceof gt?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=i._v[2],t._v[3]=s):i instanceof n?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=i._v[2],t._v[3]=i._v[3]):Array.isArray(i)&&i.length>=4?(t._v[0]=i[0],t._v[1]=i[1],t._v[2]=i[2],t._v[3]=i[3]):(void 0===s&&(s=i),void 0===o&&(o=s),void 0===a&&(a=o),t._v[0]=i,t._v[1]=s,t._v[2]=o,t._v[3]=a),t}return(0,o.Z)(n,[{key:"z",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"w",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"magnitude",value:function(){return Math.sqrt(this._v[0]*this._v[0]+this._v[1]*this._v[1]+this._v[2]*this._v[2]+this._v[3]*this._v[3])}},{key:"normalize",value:function(){var t=this.magnitude();return this._v[0]=this._v[0]/t,this._v[1]=this._v[1]/t,this._v[2]=this._v[2]/t,this._v[3]=this._v[3]/t,this}},{key:"distance",value:function(t){return new n(this._v[0]-t._v[0],this._v[1]-t._v[1],this._v[2]-t._v[2],this._v[3]-t._v[3]).magnitude()}},{key:"add",value:function(t){return this._v[0]+=t._v[0],this._v[1]+=t._v[1],this._v[2]+=t._v[2],this._v[3]+=t._v[3],this}},{key:"sub",value:function(t){return this._v[0]-=t._v[0],this._v[1]-=t._v[1],this._v[2]-=t._v[2],this._v[3]-=t._v[3],this}},{key:"dot",value:function(t){return this._v[0]*t._v[0]+this._v[1]*t._v[1]+this._v[2]*t._v[2]+this._v[3]*t._v[3]}},{key:"scale",value:function(t){return this._v[0]*=t,this._v[1]*=t,this._v[2]*=t,this._v[3]*=t,this}},{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]&&this._v[2]==t._v[2]&&this._v[3]==t._v[3]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]||this._v[2]!=t._v[2]||this._v[3]!=t._v[3]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],t._v.length>=3&&(this._v[2]=t._v[2]),4==t._v.length&&(this._v[3]=t._v[3])}},{key:"set",value:function(t,e,n,i){this._v[0]=t,this._v[1]=void 0===e?t:e,this._v[2]=void 0===e?t:void 0===n?e:n,this._v[3]=void 0===e?t:void 0===n?e:void 0===i?n:i}},{key:"r",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"g",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"b",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"a",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"xy",get:function(){return new dt(this._v[0],this._v[1])}},{key:"yz",get:function(){return new dt(this._v[1],this._v[2])}},{key:"xz",get:function(){return new dt(this._v[0],this._v[2])}},{key:"xyz",get:function(){return new gt(this._v[0],this._v[1],this._v[2])}},{key:"width",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"height",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"aspectRatio",get:function(){return 0!=this._v[3]?this._v[2]/this._v[3]:1}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])||isNaN(this._v[2])||isNaN(this._v[3])}},{key:"toString",value:function(){return"["+this._v+"]"}}],[{key:"Add",value:function(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)}},{key:"Sub",value:function(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)}},{key:"Yellow",value:function(){return new n(1,1,0,1)}},{key:"Orange",value:function(){return new n(1,.5,0,1)}},{key:"Red",value:function(){return new n(1,0,0,1)}},{key:"Violet",value:function(){return new n(.5,0,1,1)}},{key:"Blue",value:function(){return new n(0,0,1,1)}},{key:"Green",value:function(){return new n(0,1,0,1)}},{key:"White",value:function(){return new n(1,1,1,1)}},{key:"LightGray",value:function(){return new n(.8,.8,.8,1)}},{key:"Gray",value:function(){return new n(.5,.5,.5,1)}},{key:"DarkGray",value:function(){return new n(.2,.2,.2,1)}},{key:"Black",value:function(){return new n(0,0,0,1)}},{key:"Brown",value:function(){return new n(.4,.2,0,1)}},{key:"Transparent",value:function(){return new n(0,0,0,0)}}]),n}(vt),yt=dt,kt=gt,Et=dt,wt=pt,Mt=pt,xt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;(0,r.Z)(this,t),this._m=new _t(9),Array.isArray(d(e))?(this._m[0]=e[0],this._m[1]=e[1],this._m[2]=e[0],this._m[3]=e[3],this._m[4]=e[4],this._m[5]=e[5],this._m[6]=e[6],this._m[7]=e[7],this._m[8]=e[8]):"number"==typeof e?(this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=s,this._m[4]=o,this._m[5]=a,this._m[6]=u,this._m[7]=h,this._m[8]=l):this.assign(e)}return(0,o.Z)(t,[{key:"m",get:function(){return this._m}},{key:"toArray",value:function(){return[this._m[0],this._m[1],this._m[2],this._m[3],this._m[4],this._m[5],this._m[6],this._m[7],this._m[8]]}},{key:"m00",get:function(){return this._m[0]},set:function(t){this._m[0]=t}},{key:"m01",get:function(){return this._m[1]},set:function(t){this._m[1]=t}},{key:"m02",get:function(){return this._m[2]},set:function(t){this._m[2]=t}},{key:"m10",get:function(){return this._m[3]},set:function(t){this._m[3]=t}},{key:"m11",get:function(){return this._m[4]},set:function(t){this._m[4]=t}},{key:"m12",get:function(){return this._m[5]},set:function(t){this._m[5]=t}},{key:"m20",get:function(){return this._m[6]},set:function(t){this._m[6]=t}},{key:"m21",get:function(){return this._m[7]},set:function(t){this._m[7]=t}},{key:"m22",get:function(){return this._m[8]},set:function(t){this._m[8]=t}},{key:"zero",value:function(){return this._m[0]=this._m[1]=this._m[2]=this._m[3]=this._m[4]=this._m[5]=this._m[6]=this._m[7]=this._m[8]=0,this}},{key:"identity",value:function(){return this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=0,this._m[4]=1,this._m[5]=0,this._m[6]=0,this._m[7]=0,this._m[8]=1,this}},{key:"isZero",value:function(){return 0==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&0==this._m[4]&&0==this._m[5]&&0==this._m[6]&&0==this._m[7]&&0==this._m[8]}},{key:"isIdentity",value:function(){return 1==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&1==this._m[4]&&0==this._m[5]&&0==this._m[6]&&0==this._m[7]&&1==this._m[8]}},{key:"row",value:function(t){return new gt(this._m[3*t],this._m[3*t+1],this._m[3*t+2])}},{key:"setRow",value:function(t,e){return this._m[3*t]=e._v[0],this._m[3*t+1]=e._v[1],this._m[3*t+2]=e._v[2],this}},{key:"setScale",value:function(t,e,n){var i=new gt(this._m[0],this._m[3],this._m[6]).normalize().scale(t),s=new gt(this._m[1],this._m[4],this._m[7]).normalize().scale(e),r=new gt(this._m[2],this._m[5],this._m[8]).normalize().scale(n);return this._m[0]=i.x,this._m[3]=i.y,this._m[6]=i.z,this._m[1]=s.x,this._m[4]=s.y,this._m[7]=s.z,this._m[2]=r.x,this._m[5]=r.y,this._m[8]=r.z,this}},{key:"getScale",value:function(){return new gt(new gt(this._m[0],this._m[3],this._m[6]).module,new gt(this._m[1],this._m[4],this._m[7]).module,new gt(this._m[2],this._m[5],this._m[8]).module)}},{key:"length",get:function(){return this._m.length}},{key:"traspose",value:function(){var t=new gt(this._m[0],this._m[3],this._m[6]),e=new gt(this._m[1],this._m[4],this._m[7]),n=new gt(this._m[2],this._m[5],this._m[8]);return this.setRow(0,t),this.setRow(1,e),this.setRow(2,n),this}},{key:"elemAtIndex",value:function(t){return this._m[t]}},{key:"assign",value:function(t){return 9==t.length?(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=t._m[3],this._m[4]=t._m[4],this._m[5]=t._m[5],this._m[6]=t._m[6],this._m[7]=t._m[7],this._m[8]=t._m[8]):16==t.length&&(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=t._m[4],this._m[4]=t._m[5],this._m[5]=t._m[6],this._m[6]=t._m[8],this._m[7]=t._m[9],this._m[8]=t._m[10]),this}},{key:"equals",value:function(t){return this._m[0]==t._m[0]&&this._m[1]==t._m[1]&&this._m[2]==t._m[2]&&this._m[3]==t._m[3]&&this._m[4]==t._m[4]&&this._m[5]==t._m[5]&&this._m[6]==t._m[6]&&this._m[7]==t._m[7]&&this._m[8]==t._m[8]}},{key:"notEquals",value:function(t){return this._m[0]!=t._m[0]||this._m[1]!=t._m[1]||this._m[2]!=t._m[2]&&this._m[3]!=t._m[3]||this._m[4]!=t._m[4]||this._m[5]!=t._m[5]&&this._m[6]!=t._m[6]||this._m[7]!=t._m[7]||this._m[8]!=t._m[8]}},{key:"mult",value:function(t){if("number"==typeof t)this._m[0]*=t,this._m[1]*=t,this._m[2]*=t,this._m[3]*=t,this._m[4]*=t,this._m[5]*=t,this._m[6]*=t,this._m[7]*=t,this._m[8]*=t;else{var e=this._m,n=t._m,i=new _t(9);i[0]=n[0]*e[0]+n[1]*e[1]+n[2]*e[2],i[1]=n[0]*e[1]+n[1]*e[4]+n[2]*e[7],i[2]=n[0]*e[2]+n[1]*e[5]+n[2]*e[8],i[3]=n[3]*e[0]+n[4]*e[3]+n[5]*e[6],i[4]=n[3]*e[1]+n[4]*e[4]+n[5]*e[7],i[5]=n[3]*e[2]+n[4]*e[5]+n[5]*e[8],i[6]=n[6]*e[0]+n[7]*e[3]+n[8]*e[6],i[7]=n[6]*e[1]+n[7]*e[4]+n[8]*e[7],i[8]=n[6]*e[2]+n[7]*e[5]+n[8]*e[8],this._m=i}return this}},{key:"multVector",value:function(t){"object"==d(t)&&t._v&&t._v.length>=2&&(t=t._v);var e=t[0],n=t[1];return new gt(this._m[0]*e+this._m[3]*n+1*this._m[6],this._m[1]*e+this._m[4]*n+1*this._m[7],this._m[2]*e+this._m[5]*n+1*this._m[8])}},{key:"isNan",value:function(){return!(isNaN(_m[0])||isNaN(_m[1])||isNaN(_m[2])||isNaN(_m[3])||isNaN(_m[4])||isNaN(_m[5])||isNaN(_m[6])||isNaN(_m[7])||isNaN(_m[8]))}},{key:"toString",value:function(){return"["+this._m[0]+", "+this._m[1]+", "+this._m[2]+"]\n ["+this._m[3]+", "+this._m[4]+", "+this._m[5]+"]\n ["+this._m[6]+", "+this._m[7]+", "+this._m[8]+"]"}}],[{key:"Identity",value:function(){return new t(1,0,0,0,1,0,0,0,1)}}]),t}(),bt=Date.now(),St=function(t){return"number"==typeof t&&t&&0==(t&t-1)},It=function(t){return t>-1e-7&&t<ct?0:t},At=function(t){return Math.fround(It(Math.sin(t)))},Tt=function(t){return Math.fround(It(Math.cos(t)))},Nt=function(t){return Math.fround(It(Math.tan(t)))},Ct=function(){return 0+(bt=(9301*bt+49297)%233280)/233280*1},Rt=function(t){return Math.fround(Math.sqrt(t))},Lt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,_=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,m=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,v=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,d=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:0;(0,r.Z)(this,t),this._m=new _t(16),Array.isArray(e)?(this._m[0]=e[0],this._m[1]=e[1],this._m[2]=e[2],this._m[3]=e[3],this._m[4]=e[4],this._m[5]=e[5],this._m[6]=e[6],this._m[7]=e[7],this._m[8]=e[8],this._m[9]=e[9],this._m[10]=e[10],this._m[11]=e[11],this._m[12]=e[12],this._m[13]=e[13],this._m[14]=e[14],this._m[15]=e[15]):"number"==typeof e?(this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=s,this._m[4]=o,this._m[5]=a,this._m[6]=u,this._m[7]=h,this._m[8]=l,this._m[9]=c,this._m[10]=_,this._m[11]=f,this._m[12]=m,this._m[13]=v,this._m[14]=d,this._m[15]=g):this.assign(e)}return(0,o.Z)(t,[{key:"m",get:function(){return this._m}},{key:"toArray",value:function(){return[this._m[0],this._m[1],this._m[2],this._m[3],this._m[4],this._m[5],this._m[6],this._m[7],this._m[8],this._m[9],this._m[10],this._m[11],this._m[12],this._m[13],this._m[14],this._m[15]]}},{key:"m00",get:function(){return this._m[0]},set:function(t){this._m[0]=t}},{key:"m01",get:function(){return this._m[1]},set:function(t){this._m[1]=t}},{key:"m02",get:function(){return this._m[2]},set:function(t){this._m[2]=t}},{key:"m03",get:function(){return this._m[3]},set:function(t){this._m[3]=t}},{key:"m10",get:function(){return this._m[4]},set:function(t){this._m[4]=t}},{key:"m11",get:function(){return this._m[5]},set:function(t){this._m[5]=t}},{key:"m12",get:function(){return this._m[6]},set:function(t){this._m[6]=t}},{key:"m13",get:function(){return this._m[7]},set:function(t){this._m[7]=t}},{key:"m20",get:function(){return this._m[8]},set:function(t){this._m[8]=t}},{key:"m21",get:function(){return this._m[9]},set:function(t){this._m[9]=t}},{key:"m22",get:function(){return this._m[10]},set:function(t){this._m[10]=t}},{key:"m23",get:function(){return this._m[11]},set:function(t){this._m[11]=t}},{key:"m30",get:function(){return this._m[12]},set:function(t){this._m[12]=t}},{key:"m31",get:function(){return this._m[13]},set:function(t){this._m[13]=t}},{key:"m32",get:function(){return this._m[14]},set:function(t){this._m[14]=t}},{key:"m33",get:function(){return this._m[15]},set:function(t){this._m[15]=t}},{key:"zero",value:function(){return this._m[0]=0,this._m[1]=0,this._m[2]=0,this._m[3]=0,this._m[4]=0,this._m[5]=0,this._m[6]=0,this._m[7]=0,this._m[8]=0,this._m[9]=0,this._m[10]=0,this._m[11]=0,this._m[12]=0,this._m[13]=0,this._m[14]=0,this._m[15]=0,this}},{key:"identity",value:function(){return this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=0,this._m[4]=0,this._m[5]=1,this._m[6]=0,this._m[7]=0,this._m[8]=0,this._m[9]=0,this._m[10]=1,this._m[11]=0,this._m[12]=0,this._m[13]=0,this._m[14]=0,this._m[15]=1,this}},{key:"isZero",value:function(){return 0==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&0==this._m[4]&&0==this._m[5]&&0==this._m[6]&&0==this._m[7]&&0==this._m[8]&&0==this._m[9]&&0==this._m[10]&&0==this._m[11]&&0==this._m[12]&&0==this._m[13]&&0==this._m[14]&&0==this._m[15]}},{key:"isIdentity",value:function(){return 1==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&0==this._m[4]&&1==this._m[5]&&0==this._m[6]&&0==this._m[7]&&0==this._m[8]&&0==this._m[9]&&1==this._m[10]&&0==this._m[11]&&0==this._m[12]&&0==this._m[13]&&0==this._m[14]&&1==this._m[15]}},{key:"row",value:function(t){return new pt(this._m[4*t],this._m[4*t+1],this._m[4*t+2],this._m[4*t+3])}},{key:"setRow",value:function(t,e){return this._m[4*t]=e._v[0],this._m[4*t+1]=e._v[1],this._m[4*t+2]=e._v[2],this._m[4*t+3]=e._v[3],this}},{key:"setScale",value:function(t,e,n){var i=new gt(this._m[0],this._m[4],this._m[8]).normalize().scale(t),s=new gt(this._m[1],this._m[5],this._m[9]).normalize().scale(e),r=new gt(this._m[2],this._m[6],this._m[10]).normalize().scale(n);return this._m[0]=i.x,this._m[4]=i.y,this._m[8]=i.z,this._m[1]=s.x,this._m[5]=s.y,this._m[9]=s.z,this._m[2]=r.x,this._m[6]=r.y,this._m[10]=r.z,this}},{key:"getScale",value:function(){return new gt(new gt(this._m[0],this._m[4],this._m[8]).module,new gt(this._m[1],this._m[5],this._m[9]).module,new gt(this._m[2],this._m[6],this._m[10]).module)}},{key:"setPosition",value:function(t,e,n){return"number"==typeof t?(this._m[12]=t,this._m[13]=e,this._m[14]=n):(this._m[12]=t.x,this._m[13]=t.y,this._m[14]=t.z),this}},{key:"rotation",get:function(){var e=this.getScale();return new t(this._m[0]/e.x,this._m[1]/e.y,this._m[2]/e.z,0,this._m[4]/e.x,this._m[5]/e.y,this._m[6]/e.z,0,this._m[8]/e.x,this._m[9]/e.y,this._m[10]/e.z,0,0,0,0,1)}},{key:"position",get:function(){return new gt(this._m[12],this._m[13],this._m[14])}},{key:"length",get:function(){return this._m.length}},{key:"getMatrix3",value:function(){return new Matrix3(this._m[0],this._m[1],this._m[2],this._m[4],this._m[5],this._m[6],this._m[8],this._m[9],this._m[10])}},{key:"perspective",value:function(e,n,i,s){return this.assign(t.Perspective(e,n,i,s)),this}},{key:"frustum",value:function(e,n,i,s,r,o){return this.assign(t.Frustum(e,n,i,s,r,o)),this}},{key:"ortho",value:function(e,n,i,s,r,o){return this.assign(t.Ortho(e,n,i,s,r,o)),this}},{key:"lookAt",value:function(e,n,i){return this.assign(t.LookAt(e,n,i)),this}},{key:"translate",value:function(e,n,i){return this.mult(t.Translation(e,n,i)),this}},{key:"rotate",value:function(e,n,i,s){return this.mult(t.Rotation(e,n,i,s)),this}},{key:"scale",value:function(e,n,i){return this.mult(t.Scale(e,n,i)),this}},{key:"elemAtIndex",value:function(t){return this._m[t]}},{key:"assign",value:function(t){return 9==t.length?(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=0,this._m[4]=t._m[3],this._m[5]=t._m[4],this._m[6]=t._m[5],this._m[7]=0,this._m[8]=t._m[6],this._m[9]=t._m[7],this._m[10]=t._m[8],this._m[11]=0,this._m[12]=0,this._m[13]=0,this._m[14]=0,this._m[15]=1):16==t.length&&(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=t._m[3],this._m[4]=t._m[4],this._m[5]=t._m[5],this._m[6]=t._m[6],this._m[7]=t._m[7],this._m[8]=t._m[8],this._m[9]=t._m[9],this._m[10]=t._m[10],this._m[11]=t._m[11],this._m[12]=t._m[12],this._m[13]=t._m[13],this._m[14]=t._m[14],this._m[15]=t._m[15]),this}},{key:"equals",value:function(t){return this._m[0]==t._m[0]&&this._m[1]==t._m[1]&&this._m[2]==t._m[2]&&this._m[3]==t._m[3]&&this._m[4]==t._m[4]&&this._m[5]==t._m[5]&&this._m[6]==t._m[6]&&this._m[7]==t._m[7]&&this._m[8]==t._m[8]&&this._m[9]==t._m[9]&&this._m[10]==t._m[10]&&this._m[11]==t._m[11]&&this._m[12]==t._m[12]&&this._m[13]==t._m[13]&&this._m[14]==t._m[14]&&this._m[15]==t._m[15]}},{key:"notEquals",value:function(t){return this._m[0]!=t._m[0]||this._m[1]!=t._m[1]||this._m[2]!=t._m[2]||this._m[3]!=t._m[3]||this._m[4]!=t._m[4]||this._m[5]!=t._m[5]||this._m[6]!=t._m[6]||this._m[7]!=t._m[7]||this._m[8]!=t._m[8]||this._m[9]!=t._m[9]||this._m[10]!=t._m[10]||this._m[11]!=t._m[11]||this._m[12]!=t._m[12]||this._m[13]!=t._m[13]||this._m[14]!=t._m[14]||this._m[15]!=t._m[15]}},{key:"mult",value:function(t){if("number"==typeof t)return this._m[0]*=t,this._m[1]*=t,this._m[2]*=t,this._m[3]*=t,this._m[4]*=t,this._m[5]*=t,this._m[6]*=t,this._m[7]*=t,this._m[8]*=t,this._m[9]*=t,this._m[10]*=t,this._m[11]*=t,this._m[12]*=t,this._m[13]*=t,this._m[14]*=t,this._m[15]*=t,this;var e=this._m,n=t._m,i=new _t(16);return i[0]=n[0]*e[0]+n[1]*e[4]+n[2]*e[8]+n[3]*e[12],i[1]=n[0]*e[1]+n[1]*e[5]+n[2]*e[9]+n[3]*e[13],i[2]=n[0]*e[2]+n[1]*e[6]+n[2]*e[10]+n[3]*e[14],i[3]=n[0]*e[3]+n[1]*e[7]+n[2]*e[11]+n[3]*e[15],i[4]=n[4]*e[0]+n[5]*e[4]+n[6]*e[8]+n[7]*e[12],i[5]=n[4]*e[1]+n[5]*e[5]+n[6]*e[9]+n[7]*e[13],i[6]=n[4]*e[2]+n[5]*e[6]+n[6]*e[10]+n[7]*e[14],i[7]=n[4]*e[3]+n[5]*e[7]+n[6]*e[11]+n[7]*e[15],i[8]=n[8]*e[0]+n[9]*e[4]+n[10]*e[8]+n[11]*e[12],i[9]=n[8]*e[1]+n[9]*e[5]+n[10]*e[9]+n[11]*e[13],i[10]=n[8]*e[2]+n[9]*e[6]+n[10]*e[10]+n[11]*e[14],i[11]=n[8]*e[3]+n[9]*e[7]+n[10]*e[11]+n[11]*e[15],i[12]=n[12]*e[0]+n[13]*e[4]+n[14]*e[8]+n[15]*e[12],i[13]=n[12]*e[1]+n[13]*e[5]+n[14]*e[9]+n[15]*e[13],i[14]=n[12]*e[2]+n[13]*e[6]+n[14]*e[10]+n[15]*e[14],i[15]=n[12]*e[3]+n[13]*e[7]+n[14]*e[11]+n[15]*e[15],this._m=i,this}},{key:"multVector",value:function(t){"object"==d(t)&&t._v&&t._v.length>=3&&(t=t._v);var e=t[0],n=t[1],i=t[2];return new pt(this._m[0]*e+this._m[4]*n+this._m[8]*i+1*this._m[12],this._m[1]*e+this._m[5]*n+this._m[9]*i+1*this._m[13],this._m[2]*e+this._m[6]*n+this._m[10]*i+1*this._m[14],this._m[3]*e+this._m[7]*n+this._m[11]*i+1*this._m[15])}},{key:"invert",value:function(){var t=this._m[0],e=this._m[1],n=this._m[2],i=this._m[3],s=this._m[4],r=this._m[5],o=this._m[6],a=this._m[7],u=this._m[8],h=this._m[9],l=this._m[10],c=this._m[11],_=this._m[12],f=this._m[13],m=this._m[14],v=this._m[15],d=t*r-e*s,g=t*o-n*s,p=t*a-i*s,y=e*o-n*r,k=e*a-i*r,E=n*a-i*o,w=u*f-h*_,M=u*m-l*_,x=u*v-c*_,b=h*m-l*f,S=h*v-c*f,I=l*v-c*m,A=d*I-g*S+p*b+y*x-k*M+E*w;return A?(A=1/A,this._m[0]=(r*I-o*S+a*b)*A,this._m[1]=(n*S-e*I-i*b)*A,this._m[2]=(f*E-m*k+v*y)*A,this._m[3]=(l*k-h*E-c*y)*A,this._m[4]=(o*x-s*I-a*M)*A,this._m[5]=(t*I-n*x+i*M)*A,this._m[6]=(m*p-_*E-v*g)*A,this._m[7]=(u*E-l*p+c*g)*A,this._m[8]=(s*S-r*x+a*w)*A,this._m[9]=(e*x-t*S-i*w)*A,this._m[10]=(_*k-f*p+v*d)*A,this._m[11]=(h*p-u*k-c*d)*A,this._m[12]=(r*M-s*b-o*w)*A,this._m[13]=(t*b-e*M+n*w)*A,this._m[14]=(f*g-_*y-m*d)*A,this._m[15]=(u*y-h*g+l*d)*A,this):(this.zero(),this)}},{key:"traspose",value:function(){var t=new pt(this._m[0],this._m[4],this._m[8],this._m[12]),e=new pt(this._m[1],this._m[5],this._m[9],this._m[13]),n=new pt(this._m[2],this._m[6],this._m[10],this._m[14]),i=new pt(this._m[3],this._m[7],this._m[11],this._m[15]);return this.setRow(0,t),this.setRow(1,e),this.setRow(2,n),this.setRow(3,i),this}},{key:"transformDirection",value:function(e){var n=new gt(e),i=new t(this);return i.setRow(3,new pt(0,0,0,1)),n.assign(i.multVector(n).xyz),n.normalize(),n}},{key:"forwardVector",get:function(){return this.transformDirection(new gt(0,0,1))}},{key:"rightVector",get:function(){return this.transformDirection(new gt(1,0,0))}},{key:"upVector",get:function(){return this.transformDirection(new gt(0,1,0))}},{key:"backwardVector",get:function(){return this.transformDirection(new gt(0,0,-1))}},{key:"leftVector",get:function(){return this.transformDirection(new gt(-1,0,0))}},{key:"downVector",get:function(){return this.transformDirection(new gt(0,-1,0))}},{key:"isNan",value:function(){return Number.isNaN(this._m[0])||Number.isNaN(this._m[1])||Number.isNaN(this._m[2])||Number.isNaN(this._m[3])||Number.isNaN(this._m[4])||Number.isNaN(this._m[5])||Number.isNaN(this._m[6])||Number.isNaN(this._m[7])||Number.isNaN(this._m[8])||Number.isNaN(this._m[9])||Number.isNaN(this._m[10])||Number.isNaN(this._m[11])||Number.isNaN(this._m[12])||Number.isNaN(this._m[13])||Number.isNaN(this._m[14])||Number.isNaN(this._m[15])}},{key:"getOrthoValues",value:function(){return[(1+get23())/get22(),-(1-get23())/get22(),(1-get13())/get11(),-(1+get13())/get11(),-(1+get03())/get00(),(1-get03())/get00()]}},{key:"getPerspectiveValues",value:function(){return[get23()/(get22()-1),get23()/(get22()+1),near*(get12()-1)/get11(),near*(get12()+1)/get11(),near*(get02()-1)/get00(),near*(get02()+1)/get00()]}},{key:"toString",value:function(){return"["+this._m[0]+", "+this._m[1]+", "+this._m[2]+", "+this._m[3]+"]\n ["+this._m[4]+", "+this._m[5]+", "+this._m[6]+", "+this._m[7]+"]\n ["+this._m[8]+", "+this._m[9]+", "+this._m[10]+", "+this._m[11]+"]\n ["+this._m[12]+", "+this._m[13]+", "+this._m[14]+", "+this._m[15]+"]"}}],[{key:"Unproject",value:function(e,n,i,s,r,o){var a=new t(r);a.mult(s),a.invert();var u=new pt((e-o.y)/o.width*2-1,(n-o.x)/o.height*2-1,2*i-1,1),h=new pt(a.multVector(u));return 0==h.z?h.set(0):h.set(h.x/h.w,h.y/h.w,h.z/h.w,h.w/h.w),h}},{key:"Identity",value:function(){return new t(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},{key:"Perspective",value:function(e,n,i,s){var r=Nt(e*ut/360)*i,o=r*n;return t.Frustum(-o,o,-r,r,i,s)}},{key:"Frustum",value:function(e,n,i,s,r,o){var a=new t,u=n-e,h=s-i,l=o-r;return a.setRow(0,new pt(2*r/u,0,0,0)),a.setRow(1,new pt(0,2*r/h,0,0)),a.setRow(2,new pt((n+e)/u,(s+i)/h,-(o+r)/l,-1)),a.setRow(3,new pt(0,0,-o*r*2/l,0)),a}},{key:"Ortho",value:function(e,n,i,s,r,o){var a=new t,u=n-e,h=s-i,l=o-r;return a._m[0]=2/u,a._m[1]=0,a._m[2]=0,a._m[3]=0,a._m[4]=0,a._m[5]=2/h,a._m[6]=0,a._m[7]=0,a._m[8]=0,a._m[9]=0,a._m[10]=-2/l,a._m[11]=0,a._m[12]=-(e+n)/u,a._m[13]=-(s+i)/h,a._m[14]=-(o+r)/l,a._m[15]=1,a}},{key:"LookAt",value:function(e,n,i){var s=t.Identity(),r=new gt(i),o=gt.Sub(e,n);o.normalize();var a=gt.Cross(r,o);return a.normalize(),r.normalize(),s.m00=a.x,s.m10=a.y,s.m20=a.z,s.m30=-a.dot(e),s.m01=r.x,s.m11=r.y,s.m21=r.z,s.m31=-r.dot(e),s.m02=o.x,s.m12=o.y,s.m22=o.z,s.m32=-o.dot(e),s.m03=0,s.m13=0,s.m23=0,s.m33=1,s}},{key:"Translation",value:function(e,n,i){return"object"==d(e)&&e._v&&e._v.length>=3&&(n=e._v[1],i=e._v[2],e=e._v[0]),new t(1,0,0,0,0,1,0,0,0,0,1,0,e,n,i,1)}},{key:"Rotation",value:function(e,n,i,s){var r=new gt(n,i,s);r.normalize(),new t(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);var o=Tt(e),a=1-o,u=At(e);return new t(r.x*r.x*a+o,r.x*r.y*a+r.z*u,r.x*r.z*a-r.y*u,0,r.y*r.x*a-r.z*u,r.y*r.y*a+o,r.y*r.z*a+r.x*u,0,r.z*r.x*a+r.y*u,r.z*r.y*a-r.x*u,r.z*r.z*a+o,0,0,0,0,1)}},{key:"Scale",value:function(e,n,i){return"object"==d(e)&&e._v&&e._v.length>=3&&(n=(e=e._v[0])._v[1],i=e._v[2]),new t(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1)}}]),t}();var Ot={VERTEX:1,NORMAL:2,TEX_COORD_0:4,TEX_COORD_1:8,TEX_COORD_2:16,COLOR:32,TANGENT:64,INDEX:128},Vt={TRIANGLES:null,TRIANGLE_FAN:null,TRIANGLE_STRIP:null,LINES:null,LINE_STRIP:null},Ft=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t){var e;return(0,r.Z)(this,s),(e=i.call(this,t))._plist=null,e._drawMode=Vt.TRIANGLES,e._name="",e._groupName="",e._visible=!0,e._visibleToShadows=!0,e._vertex=[],e._normal=[],e._texCoord0=[],e._texCoord1=[],e._texCoord2=[],e._color=[],e._tangent=[],e._index=[],e}return(0,o.Z)(s,[{key:"clone",value:function(){var t=new s(this.context),e=function(t,e){t.forEach((function(t){e.push(t)}))};return t.name=this.name+" clone",t.groupName=this.groupName,t.visible=this.visible,t.visibleToShadows=this.visibleToShadows,t.drawMode=this.drawMode,e(this.vertex,t.vertex),e(this.normal,t.normal),e(this.texCoord0,t.texCoord0),e(this.texCoord1,t.texCoord1),e(this.texCoord2,t.texCoord02),e(this.color,t.color),e(this.index,t.index),t.build(),t}},{key:"name",get:function(){return this._name},set:function(t){this._name=t}},{key:"groupName",get:function(){return this._groupName},set:function(t){this._groupName=t}},{key:"visible",get:function(){return this._visible},set:function(t){this._visible=t}},{key:"visibleToShadows",get:function(){return this._visibleToShadows},set:function(t){this._visibleToShadows=t}},{key:"drawMode",get:function(){return this._drawMode},set:function(t){this._drawMode=t}},{key:"vertex",get:function(){return this._vertex},set:function(t){this._vertex=t}},{key:"normal",get:function(){return this._normal},set:function(t){this._normal=t}},{key:"texCoord0",get:function(){return this._texCoord0},set:function(t){this._texCoord0=t}},{key:"texCoord1",get:function(){return this._texCoord1},set:function(t){this._texCoord1=t}},{key:"texCoord2",get:function(){return this._texCoord2},set:function(t){this._texCoord2=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"index",get:function(){return this._index},set:function(t){this._index=t}},{key:"tangent",get:function(){return this._tangent}},{key:"vertexBuffer",get:function(){return this._plist.vertexBuffer}},{key:"normalBuffer",get:function(){return this._plist.normalBuffer}},{key:"texCoord0Buffer",get:function(){return this._plist.tex0Buffer}},{key:"texCoord1Buffer",get:function(){return this._plist.tex1Buffer}},{key:"texCoord2Buffer",get:function(){return this._plist.tex2Buffer}},{key:"colorBuffer",get:function(){return this._plist.colorBuffer}},{key:"tangentBuffer",get:function(){return this._plist.tangentBuffer}},{key:"indexBuffer",get:function(){return this._plist.indexBuffer}},{key:"updateBuffer",value:function(t,e){var n=!1;switch(t){case Ot.VERTEX:n=this.vertex.length==e.length;break;case Ot.NORMAL:n=this.normal.length==e.length;break;case Ot.TEX_COORD_0:n=this.texCoord0.length==e.length;break;case Ot.TEX_COORD_1:n=this.texCoord1.length==e.length;break;case Ot.TEX_COORD_2:n=this.texCoord2.length==e.length;break;case Ot.COLOR:n=this.color.length==e.length;break;case Ot.TANGENT:n=this.tangent.length==e.length;break;case Ot.INDEX:n=this.index.length==e.length}if(!n)throw new Error("Error updating buffer: The new buffer have different size as the old one.");b.Get().polyList.update(this.context,this._plist,t,e)}},{key:"build",value:function(){if(0==this.color.length)for(var t=0;t<this.vertex.length;t+=3)this.color.push(1),this.color.push(1),this.color.push(1),this.color.push(1);var e=b.Get().polyList;return this._plist&&(e.destroy(this.context,this._plist),this._tangent=[]),this._tangent=function(t){if(t.texCoord0&&t.vertex){t._tangent=[];var e=[],n={},i=!1;if(t.index.length%3==0)for(var s=0;s<t.index.length-2;s+=3){var r=3*t.index[s],o=3*t.index[s+1],a=3*t.index[s+2],u=2*t.index[s],h=2*t.index[s+1],l=2*t.index[s+2],c=new gt(t.vertex[r],t.vertex[r+1],t.vertex[r+2]),_=new gt(t.vertex[o],t.vertex[o+1],t.vertex[o+2]),f=new gt(t.vertex[a],t.vertex[a+1],t.vertex[a+2]),m=new dt(t.texCoord0[u],t.texCoord0[u+1]),v=new dt(t.texCoord0[h],t.texCoord0[h+1]),d=new dt(t.texCoord0[l],t.texCoord0[l+1]),g=new gt(_).sub(c),p=new gt(f).sub(c),y=v.x-m.x,k=v.y-m.y,E=d.x-m.x,w=d.y-m.y,M=y*w-E*k,x=null;if(0==M){var b=new gt(t.normal[r],t.normal[r+1],t.normal[r+2]);i=!0,x=new gt(b.y,b.z,b.x)}else{var S=1/M;(x=new gt(S*(w*g.x-k*p.x),S*(w*g.y-k*p.y),S*(w*g.z-k*p.z))).normalize()}void 0===n[r]&&(e.push(x.x),e.push(x.y),e.push(x.z),n[r]=x),void 0===n[o]&&(e.push(x.x),e.push(x.y),e.push(x.z),n[o]=x),void 0===n[a]&&(e.push(x.x),e.push(x.y),e.push(x.z),n[a]=x)}else for(var I=0;I<t.vertex.length;I+=3)t._tangent.push(0,0,1);return i&&console.warn("Invalid UV texture coords found. Some objects may present artifacts in the lighting, and not display textures properly."),e}}(this),this._plist=e.create(this.context),e.build(this.context,this._plist,this._vertex,this._normal,this._texCoord0,this._texCoord1,this._texCoord2,this._color,this._tangent,this._index)}},{key:"draw",value:function(){b.Get().polyList.draw(this.context,this._plist,this.drawMode,this.index.length)}},{key:"destroy",value:function(){this._plist&&b.Get().polyList.destroy(this.context,this._plist),this._plist=null,this._name="",this._vertex=[],this._normal=[],this._texCoord0=[],this._texCoord1=[],this._texCoord2=[],this._color=[],this._tangent=[],this._index=[]}},{key:"applyTransform",value:function(t){var e=new Lt(t),n=new Lt(t.getMatrix3());if(this.normal.length>0&&this.normal.length!=this.vertex.length)throw new Error("Unexpected number of normal coordinates found in polyList");for(var i=0;i<this.vertex.length-2;i+=3){var s=new Vector4(this.vertex[i],this.vertex[i+1],this.vertex[i+2],1);if(s=e.multVector(s),this.vertex[i]=s.x,this.vertex[i+1]=s.y,this.vertex[i+2]=s.z,this.normal.length){var r=new Vector4(this.normal[i],this.normal[i+1],this.normal[i+2],1);r=n.multVector(r),this.normal[i]=r.x,this.normal[i+1]=r.y,this.normal[i+2]=r.z}}this.build()}}]),s}(L),Pt=null;function Gt(t){Reflect.defineProperty(t,"all",{get:function(){if(!this._all)for(var e in this._all=[],t)"object"==d(t[e])&&t[e].name&&this._all.push(t[e]);return this._all}})}var Bt=function(){function t(){(0,r.Z)(this,t);var e=b.Get().shaderLibrary;for(var n in e)this[n]=e[n];for(var i in Gt(this.inputs.matrix),Object.defineProperty(this.inputs.matrix,"modelViewProjection",{get:function(){return[this.model,this.view,this.projection]}}),Gt(this.inputs.material),Gt(this.inputs.lighting),Gt(this.inputs.lightingForward),Gt(this.inputs.shadows),Gt(this.inputs.colorCorrection),Gt(this.functions.materials),Gt(this.functions.colorCorrection),Gt(this.functions.lighting),Gt(this.functions.utils),this.inputs.pbr)Gt(this.inputs.pbr[i]);for(var s in this.functions.pbr)Gt(this.functions.pbr[s])}return(0,o.Z)(t,null,[{key:"Get",value:function(){return Pt||(Pt=new t),Pt}}]),t}();function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ut(t){return function(t){if(Array.isArray(t))return Dt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Dt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Xt=function(){function t(e){(0,r.Z)(this,t),this._type=e,this._params=[],this._functions=[],this._requiredExtensions=[],this._header="",this._preprocessor=""}return(0,o.Z)(t,[{key:"type",get:function(){return this._type}},{key:"params",get:function(){return this._params}},{key:"header",get:function(){return this._header}},{key:"functions",get:function(){return this._functions}},{key:"addParameter",value:function(t){t instanceof Array?this._params=[].concat(Ut(this._params),Ut(t)):this._params.push(t),this._params.push(null)}},{key:"addFunction",value:function(t){t instanceof Array?this._functions=[].concat(Ut(this._functions),Ut(t)):this._functions.push(t)}},{key:"setMainBody",value:function(t){this.addFunction({returnType:"void",name:"main",params:{},body:t})}},{key:"appendHeader",value:function(t){this._header+=t+"\n"}},{key:"appendPreprocessor",value:function(t){this._preprocessor+=t+"\n"}},{key:"toString",value:function(){var t=this,e=b.Get().shaderSource,n=this._preprocessor;return n+=e.header(this.type)+"\n"+this._header+"\n\n",this.params.forEach((function(i){n+=e.parameter(t.type,i)+"\n"})),this.functions.forEach((function(i){n+="\n"+e.func(t.type,i)+"\n"})),n}}],[{key:"FormatSource",value:function(t){var e="",n=t.replace(/^\n*/,"").replace(/\n*$/,"").split("\n"),i=100;return n.forEach((function(t){var e=/(\t*)/.exec(t)[0].length;i>e&&(i=e)})),n.forEach((function(t){var n=/(\t*)/.exec(t)[0].length,s=n-i;e+=t.slice(n-s,t.length)+"\n"})),e.replace(/^\n*/,"").replace(/\n*$/,"")}}]),t}();window.s_bg_base_textureCache={};var Ht=8,Zt="static-white-color-texture",zt="static-black-color-texture",jt="static-normal-color-texture",Wt="static-random-color-texture",Yt="static-white-cubemap-texture",Kt="static-white-cubemap-texture",$t=function(){function t(e){(0,r.Z)(this,t),this._context=e,this._textures={}}return(0,o.Z)(t,[{key:"find",value:function(t){return this._textures[t]}},{key:"register",value:function(t,e){e instanceof ne&&(this._textures[t]=e)}},{key:"unregister",value:function(t){this._textures[t]&&delete this._textures[t]}},{key:"clear",value:function(){this._textures={}}}],[{key:"SetColorTextureSize",value:function(t){Ht=t}},{key:"GetColorTextureSize",value:function(){return Ht}},{key:"WhiteCubemap",value:function(e){var n=t.Get(e),i=n.find(Yt);return i||(i=ne.WhiteCubemap(e),n.register(Yt,i)),i}},{key:"BlackCubemap",value:function(e){var n=t.Get(e),i=n.find(Kt);return i||(i=ne.BlackCubemap(e),n.register(Kt,i)),i}},{key:"WhiteTexture",value:function(e){var n=t.Get(e),i=n.find(Zt);return i||(i=ne.WhiteTexture(e,new dt(Ht)),n.register(Zt,i)),i}},{key:"BlackTexture",value:function(e){var n=t.Get(e),i=n.find(zt);return i||(i=ne.BlackTexture(e,new dt(Ht)),n.register(zt,i)),i}},{key:"NormalTexture",value:function(e){var n=t.Get(e),i=n.find(jt);return i||(i=ne.NormalTexture(e,new dt(Ht)),n.register(jt,i)),i}},{key:"RandomTexture",value:function(e){var n=t.Get(e),i=n.find(Wt);return i||(i=ne.RandomTexture(e,new dt(64)),n.register(Wt,i)),i}},{key:"Get",value:function(e){return window.s_bg_base_textureCache[e.uuid]||(window.s_bg_base_textureCache[e.uuid]=new t(e)),window.s_bg_base_textureCache[e.uuid]}},{key:"PrecomputedBRDFLookupTexture",value:function(t){return window.s_bg_base_textureCache._bg_base_brdfLutData_||(window.s_bg_base_textureCache._bg_base_brdfLutData_=ne.PrecomputedBRDFLookupTexture(t)),window.s_bg_base_textureCache._bg_base_brdfLutData_}}]),t}();window.s_bg_base_textureLoaderPlugin_wrapX=null,window.s_bg_base_textureLoaderPlugin_wrapY=null,window.s_bg_base_textureLoaderPlugin_minFilter=null,window.s_bg_base_textureLoaderPlugin_magFilter=null;var qt=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){return(0,r.Z)(this,s),i.apply(this,arguments)}return(0,o.Z)(s,[{key:"acceptType",value:function(t,e){return x.IsImage(t)}},{key:"load",value:function(t,e,n,i){return new Promise((function(r,o){if(n){var a=$t.Get(t).find(e);a||(console.log("Texture ".concat(e," not found. Loading texture")),(a=new ne(t)).create(),a.bind(),a.wrapX=i.wrapX||s.GetWrapX(),a.wrapY=i.wrapY||s.GetWrapY(),a.minFilter=i.minFilter||s.GetMinFilter(),a.magFilter=i.magFilter||s.GetMagFilter(),a.setImage(n),a.fileName=e,$t.Get(t).register(e,a)),r(a)}else o(new Error("Error loading texture image data"))}))}}],[{key:"GetWrapX",value:function(){return window.s_bg_base_textureLoaderPlugin_wrapX||Jt.REPEAT}},{key:"GetWrapY",value:function(){return window.s_bg_base_textureLoaderPlugin_wrapY||Jt.REPEAT}},{key:"GetMinFilter",value:function(){return window.s_bg_base_textureLoaderPlugin_minFilter||Qt.LINEAR_MIPMAP_NEAREST}},{key:"GetMagFilter",value:function(){return window.s_bg_base_textureLoaderPlugin_magFilter||Qt.LINEAR}},{key:"SetMinFilter",value:function(t){window.s_bg_base_textureLoaderPlugin_minFilter=t}},{key:"SetMagFilter",value:function(t){window.s_bg_base_textureLoaderPlugin_magFilter=t}},{key:"SetWrapX",value:function(t){window.s_bg_base_textureLoaderPlugin_wrapX=t}},{key:"SetWrapY",value:function(t){window.s_bg_base_textureLoaderPlugin_wrapY=t}}]),s}(nt);var Jt={REPEAT:null,CLAMP:null,MIRRORED_REPEAT:null},Qt={NEAREST_MIPMAP_NEAREST:null,LINEAR_MIPMAP_NEAREST:null,NEAREST_MIPMAP_LINEAR:null,LINEAR_MIPMAP_LINEAR:null,NEAREST:null,LINEAR:null},te={TEXTURE_2D:null,CUBE_MAP:null,POSITIVE_X_FACE:null,NEGATIVE_X_FACE:null,POSITIVE_Y_FACE:null,NEGATIVE_Y_FACE:null,POSITIVE_Z_FACE:null,NEGATIVE_Z_FACE:null},ee={NONE:0,IMAGE:1,IMAGE_DATA:2,CUBEMAP:3,CUBEMAP_DATA:4,VIDEO:5};window.s_bg_base_base64TexturePreventRemove=[];var ne=function(t){v(a,t);var e,i,s=(e=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=p(e);if(i){var s=p(this).constructor;t=Reflect.construct(n,arguments,s)}else t=n.apply(this,arguments);return g(this,t)});function a(t){var e;return(0,r.Z)(this,a),(e=s.call(this,t))._texture=null,e._fileName="",e._size=new dt(0),e._target=te.TEXTURE_2D,e._minFilter=Qt.LINEAR,e._magFilter=Qt.LINEAR,e._wrapX=Jt.REPEAT,e._wrapY=Jt.REPEAT,e._video=null,e}return(0,o.Z)(a,[{key:"texture",get:function(){return this._texture}},{key:"target",get:function(){return this._target},set:function(t){this._target=t}},{key:"fileName",get:function(){return this._fileName},set:function(t){this._fileName=t}},{key:"minFilter",get:function(){return this._minFilter},set:function(t){this._minFilter=t}},{key:"magFilter",get:function(){return this._magFilter},set:function(t){this._magFilter=t}},{key:"wrapX",get:function(){return this._wrapX},set:function(t){this._wrapX=t}},{key:"wrapY",get:function(){return this._wrapY},set:function(t){this._wrapY=t}},{key:"size",get:function(){return this._size}},{key:"image",get:function(){return this._image}},{key:"imageData",get:function(){return this._imageData}},{key:"cubeMapImages",get:function(){return this._cubeMapImages}},{key:"cubeMapData",get:function(){return this._cubeMapData}},{key:"video",get:function(){return this._video}},{key:"dataType",get:function(){return this._image?ee.IMAGE:this._imageData?ee.IMAGE_DATA:this._cubeMapImages?ee.CUBEMAP:this._cubeMapData?ee.CUBEMAP_DATA:this._video?ee.VIDEO:ee.NONE}},{key:"create",value:function(){null!==this._texture&&this.destroy(),this._texture=b.Get().texture.create(this.context)}},{key:"setActive",value:function(t){b.Get().texture.setActive(this.context,t)}},{key:"bind",value:function(){b.Get().texture.bind(this.context,this._target,this._texture)}},{key:"unbind",value:function(){a.Unbind(this.context,this._target)}},{key:"setImage",value:function(t,e){void 0===e&&(e=!0),this._size.width=t.width,this._size.height=t.height,b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),b.Get().texture.setTextureWrapY(this.context,this._target,this._texture,this._wrapY),b.Get().texture.setImage(this.context,this._target,this._minFilter,this._magFilter,this._texture,t,e),this._image=t,this._imageData=null,this._cubeMapImages=null,this._cubeMapData=null,this._video=null}},{key:"updateImage",value:function(t,e){void 0===e&&(e=!0),this._size.width=t.width,this._size.height=t.height,b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),b.Get().texture.setTextureWrapY(this.context,this._target,this._texture,this._wrapY),b.Get().texture.setImage(this.context,this._target,this._minFilter,this._magFilter,this._texture,t,e),this._image=t,this._imageData=null,this._cubeMapImages=null,this._cubeMapData=null,this._video=null}},{key:"setImageRaw",value:function(t,e,n,i,s){i||(i=this.context.RGBA),s||(s=this.context.UNSIGNED_BYTE),this._size.width=t,this._size.height=e,b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),b.Get().texture.setTextureWrapY(this.context,this._target,this._texture,this._wrapY),b.Get().texture.setImageRaw(this.context,this._target,this._minFilter,this._magFilter,this._texture,t,e,n,i,s),this._image=null,this._imageData=n,this._cubeMapImages=null,this._cubeMapData=null,this._video=null}},{key:"setCubemap",value:function(t,e,n,i,s,r){b.Get().texture.bind(this.context,this._target,this._texture),b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapY),b.Get().texture.setTextureFilter(this.context,this._target,this._minFilter,this._magFilter),b.Get().texture.setCubemapImage(this.context,te.POSITIVE_X_FACE,t),b.Get().texture.setCubemapImage(this.context,te.NEGATIVE_X_FACE,e),b.Get().texture.setCubemapImage(this.context,te.POSITIVE_Y_FACE,n),b.Get().texture.setCubemapImage(this.context,te.NEGATIVE_Y_FACE,i),b.Get().texture.setCubemapImage(this.context,te.POSITIVE_Z_FACE,s),b.Get().texture.setCubemapImage(this.context,te.NEGATIVE_Z_FACE,r),this._image=null,this._imageData=null,this._cubeMapImages={posX:t,negX:e,posY:n,negY:i,posZ:s,negZ:r},this._cubeMapData=null,this._video=null}},{key:"setCubemapRaw",value:function(t,e,n,i,s,r,o,a){b.Get().texture.bind(this.context,this._target,this._texture),b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),b.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapY),b.Get().texture.setTextureFilter(this.context,this._target,this._minFilter,this._magFilter),b.Get().texture.setCubemapRaw(this.context,te.POSITIVE_X_FACE,n,t,e),b.Get().texture.setCubemapRaw(this.context,te.NEGATIVE_X_FACE,i,t,e),b.Get().texture.setCubemapRaw(this.context,te.POSITIVE_Y_FACE,s,t,e),b.Get().texture.setCubemapRaw(this.context,te.NEGATIVE_Y_FACE,r,t,e),b.Get().texture.setCubemapRaw(this.context,te.POSITIVE_Z_FACE,o,t,e),b.Get().texture.setCubemapRaw(this.context,te.NEGATIVE_Z_FACE,a,t,e),this._image=null,this._imageData=null,this._cubeMapImages=null,this._cubeMapData={width:t,height:e,posX:n,negX:i,posY:s,negY:r,posZ:o,negZ:a},this._video=null}},{key:"setVideo",value:function(t,e){void 0===e&&(e=!0),this._size.width=t.videoWidth,this._size.height=t.videoHeight,b.Get().texture.setVideo(this.context,this._target,this._texture,t,e),this._video=t,this._image=null,this._imageData=null,this._cubeMapImages=null,this._cubeMapData=null}},{key:"destroy",value:function(){b.Get().texture.destroy(this.context,this._texture),this._texture=null,this._minFilter=null,this._magFilter=null,this._fileName=""}},{key:"valid",value:function(){return null!==this._texture}},{key:"update",value:function(){b.Get().texture.updateVideoData(this.context,this._target,this._texture,this._video)}}],[{key:"IsPowerOfTwoImage",value:function(t){return St(t.width)&&St(t.height)}},{key:"FromCanvas",value:function(t,e){return a.FromBase64Image(t,e.toDataURL("image/png"))}},{key:"UpdateCanvasImage",value:function(t,e){if(!t.valid)return!1;var n=e.toDataURL("image/png");return t.img.width==n.width&&(t.img.height,n.height),t.img=new Image,window.s_bg_base_base64TexturePreventRemove.push(t),setTimeout((function(){t.bind(),a.IsPowerOfTwoImage(t.img)?(t.minFilter=qt.GetMinFilter(),t.magFilter=qt.GetMagFilter()):(t.minFilter=Qt.NEAREST,t.magFilter=Qt.NEAREST,t.wrapX=Jt.CLAMP,t.wrapY=Jt.CLAMP),t.setImage(t.img,!0),t.unbind();var e=window.s_bg_base_base64TexturePreventRemove.indexOf(t);-1!=e&&window.s_bg_base_base64TexturePreventRemove.splice(e,1),w(t.img)}),10),t.img.src=n,t}},{key:"FromBase64Image",value:function(t,e){var n=new a(t);return n.img=new Image,window.s_bg_base_base64TexturePreventRemove.push(n),setTimeout((function(){n.create(),n.bind(),a.IsPowerOfTwoImage(n.img)?(n.minFilter=qt.GetMinFilter(),n.magFilter=qt.GetMagFilter()):(n.minFilter=Qt.NEAREST,n.magFilter=Qt.NEAREST,n.wrapX=Jt.CLAMP,n.wrapY=Jt.CLAMP),n.setImage(n.img,!1),n.unbind();var t=window.s_bg_base_base64TexturePreventRemove.indexOf(n);-1!=t&&window.s_bg_base_base64TexturePreventRemove.splice(t,1),w(n.img)}),10),n.img.src=e,n}},{key:"ColorTexture",value:function(t,e,n){var i=new a(t);i.create(),i.bind();for(var s=n.width*n.height*4,r=[],o=0;o<s;o+=4)r[o]=255*e.r,r[o+1]=255*e.g,r[o+2]=255*e.b,r[o+3]=255*e.a;return r=new Uint8Array(r),i.minFilter=Qt.NEAREST,i.magFilter=Qt.NEAREST,i.setImageRaw(n.width,n.height,r),i.unbind(),i}},{key:"WhiteTexture",value:function(t,e){return a.ColorTexture(t,Mt.White(),e)}},{key:"WhiteCubemap",value:function(t){return a.ColorCubemap(t,Mt.White())}},{key:"BlackCubemap",value:function(t){return a.ColorCubemap(t,Mt.Black())}},{key:"ColorCubemap",value:function(t,e){var n=new a(t);n.target=te.CUBE_MAP,n.create(),n.bind();for(var i=[],s=0;s<4096;s+=4)i[s]=255*e.r,i[s+1]=255*e.g,i[s+2]=255*e.b,i[s+3]=255*e.a;return i=new Uint8Array(i),n.setCubemapRaw(32,32,i,i,i,i,i,i),n.unbind(),n}},{key:"NormalTexture",value:function(t,e){return a.ColorTexture(t,new Mt(.5,.5,1,1),e)}},{key:"BlackTexture",value:function(t,e){return a.ColorTexture(t,Mt.Black(),e)}},{key:"RandomTexture",value:function(t,e){var n=new a(t);n.create(),n.bind();for(var i=e.width*e.height*4,s=[],r=0;r<i;r+=4){var o=new gt(2*Ct()-1,2*Ct()-1,0);o.normalize(),s[r]=255*o.x,s[r+1]=255*o.y,s[r+2]=255*o.z,s[r+3]=1}return s=new Uint8Array(s),n.minFilter=Qt.NEAREST,n.magFilter=Qt.NEAREST,n.setImageRaw(e.width,e.height,s),n.unbind(),n}},{key:"PrecomputedBRDFLookupTexture",value:function(t){return new Promise((function(e){n.e(101).then(n.bind(n,576)).then((function(e){return a.FromBase64Image(t,e)})).then((function(t){e(t)})).catch((function(t){console.error("Error loading BRDF lut data"),console.error(t)}))}))}},{key:"FromImage",value:function(t,e,n){var i=null;return e&&((i=$t.Get(t).find(n))||(console.debug("Texture ".concat(n," not found. Loading texture")),(i=new a(t)).create(),i.bind(),i.minFilter=qt.GetMinFilter(),i.magFilter=qt.GetMagFilter(),i.setImage(e),i.fileName=n,$t.Get(t).register(n,i))),i}},{key:"SetActive",value:function(t,e){b.Get().texture.setActive(t,e)}},{key:"Unbind",value:function(t,e){e||(e=te.TEXTURE_2D),b.Get().texture.unbind(t,e)}}]),a}(L);var ie=function(){return Bt.Get()},se=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t){var e;return(0,r.Z)(this,s),(e=i.call(this,t))._frame=new Ft(t),e._frame.vertex=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],e._frame.texCoord0=[1,1,0,1,0,0,1,0],e._frame.index=[0,1,2,2,3,0],e._frame.build(),e.rebuildShaders(),e}return(0,o.Z)(s,[{key:"rebuildShaders",value:function(){this.setupShaderSource([this.vertexShaderSource,this.fragmentShaderSource])}},{key:"vertexShaderSource",get:function(){return this._vertexShaderSource||(this._vertexShaderSource=new Xt($.VERTEX),this._vertexShaderSource.addParameter([ie().inputs.buffers.vertex,ie().inputs.buffers.tex0,{name:"fsTexCoord",dataType:"vec2",role:"out"}]),"webgl1"==b.Get().id&&this._vertexShaderSource.setMainBody("\n                gl_Position = vec4(inVertex,1.0);\n                fsTexCoord = inTex0;")),this._vertexShaderSource}},{key:"fragmentShaderSource",get:function(){return this._fragmentShaderSource||(this._fragmentShaderSource=new Xt($.FRAGMENT),this._fragmentShaderSource.addParameter({name:"fsTexCoord",dataType:"vec2",role:"in"}),"webgl1"==b.Get().id&&this._fragmentShaderSource.setMainBody("\n                gl_FragColor = vec4(0.0,0.0,0.0,1.0);")),this._fragmentShaderSource}},{key:"drawSurface",value:function(t){this.setActive(),this._surface=t,this.bindPolyList(this._frame),this._frame.draw(),this.unbind(),this.clearActive()}}]),s}(J);const re={DIFFUSE:1,SPECULAR:2,SHININESS:4,LIGHT_EMISSION:8,REFRACTION_AMOUNT:16,REFLECTION_AMOUNT:32,TEXTURE:64,LIGHT_MAP:128,NORMAL_MAP:256,TEXTURE_OFFSET:512,TEXTURE_SCALE:1024,LIGHT_MAP_OFFSET:2048,LIGHT_MAP_SCALE:4096,NORMAL_MAP_OFFSET:8192,NORMAL_MAP_SCALE:16384,CAST_SHADOWS:32768,RECEIVE_SHADOWS:65536,ALPHA_CUTOFF:1<<17,SHININESS_MASK:1<<18,SHININESS_MASK_CHANNEL:1<<19,SHININESS_MASK_INVERT:1<<20,LIGHT_EMISSION_MASK:1<<21,LIGHT_EMISSION_MASK_CHANNEL:1<<22,LIGHT_EMISSION_MASK_INVERT:1<<23,REFLECTION_MASK:1<<24,REFLECTION_MASK_CHANNEL:1<<25,REFLECTION_MASK_INVERT:1<<26,CULL_FACE:1<<27,ROUGHNESS:1<<28,UNLIT:1<<29};var oe=function(){function t(e){(0,r.Z)(this,t),this._modifierFlags=0,this._diffuse=Mt.White(),this._specular=Mt.White(),this._shininess=0,this._lightEmission=0,this._refractionAmount=0,this._reflectionAmount=0,this._texture=null,this._lightmap=null,this._normalMap=null,this._textureOffset=new dt,this._textureScale=new dt(1),this._lightmapOffset=new dt,this._lightmapScale=new dt(1),this._normalMapOffset=new dt,this._normalMapScale=new dt(1),this._castShadows=!0,this._receiveShadows=!0,this._alphaCutoff=.5,this._shininessMask=null,this._shininessMaskChannel=0,this._shininessMaskInvert=!1,this._lightEmissionMask=null,this._lightEmissionMaskChannel=0,this._lightEmissionMaskInvert=!1,this._reflectionMask=null,this._reflectionMaskChannel=0,this._reflectionMaskInvert=!1,this._cullFace=!0,this._roughness=!0,this._roughnessMask=null,this._roughnessMaskChannel=0,this._roughnessMaskInvert=!1,this._unlit=!1,e&&(void 0!==e.diffuseR&&void 0!==e.diffuseG&&void 0!==e.diffuseB&&(this.diffuse=new Mt(e.diffuseR,e.diffuseG,e.diffuseB,e.diffuseA?e.diffuseA:1)),void 0!==e.specularR&&void 0!==e.specularG&&void 0!==e.specularB&&(this.specular=new Mt(e.specularR,e.specularG,e.specularB,e.specularA?e.specularA:1)),void 0!==e.shininess&&(this.shininess=e.shininess),void 0!==e.lightEmission&&(this.lightEmission=e.lightEmission),void 0!==e.refractionAmount&&(this.refractionAmount=e.refractionAmount),void 0!==e.reflectionAmount&&(this.reflectionAmount=e.reflectionAmount),void 0!==e.texture&&(this.texture=e.texture),void 0!==e.lightmap&&(this.lightmap=e.lightmap),void 0!==e.normalMap&&(this.normalMap=e.normalMap),void 0!==e.textureOffsetX&&void 0!==e.textureOffsetY&&(this.textureOffset=new dt(e.textureOffsetX,e.textureOffsetY)),void 0!==e.textureScaleX&&void 0!==e.textureScaleY&&(this.textureScale=new dt(e.textureScaleX,e.textureScaleY)),void 0!==e.lightmapOffsetX&&void 0!==e.lightmapOffsetY&&(this.lightmapOffset=new dt(e.lightmapOffsetX,e.lightmapOffsetY)),void 0!==e.lightmapScaleX&&void 0!==e.lightmapScaleY&&(this.lightmapScale=new dt(e.lightmapScaleX,e.lightmapScaleY)),void 0!==e.normalMapScaleX&&void 0!==e.normalMapScaleY&&(this.normalMapScale=new dt(e.normalMapScaleX,e.normalMapScaleY)),void 0!==e.normalMapOffsetX&&void 0!==e.normalMapOffsetY&&(this.normalMapOffset=new dt(e.normalMapOffsetX,e.normalMapOffsetY)),void 0!==e.castShadows&&(this.castShadows=e.castShadows),void 0!==e.receiveShadows&&(this.receiveShadows=e.receiveShadows),void 0!==e.alphaCutoff&&(this.alphaCutoff=e.alphaCutoff),void 0!==e.shininessMask&&(this.shininessMask=e.shininessMask),void 0!==e.shininessMaskChannel&&(this.shininessMaskChannel=e.shininessMaskChannel),void 0!==e.invertShininessMask&&(this.shininessMaskInvert=e.invertShininessMask),void 0!==e.lightEmissionMask&&(this.lightEmissionMask=e.lightEmissionMask),void 0!==e.lightEmissionMaskChannel&&(this.lightEmissionMaskChannel=e.lightEmissionMaskChannel),void 0!==e.invertLightEmissionMask&&(this.lightEmissionMaskInvert=e.invertLightEmissionMask),void 0!==e.reflectionMask&&(this.reflectionMask=e.reflectionMask),void 0!==e.reflectionMaskChannel&&(this.reflectionMaskChannel=e.reflectionMaskChannel),void 0!==e.invertReflectionMask&&(this.reflectionMaskInvert=e.reflectionMaskInvert),void 0!==e.roughness&&(this.roughness=e.roughness),void 0!==e.roughnessMask&&(this.roughnessMask=e.roughnessMask),void 0!==e.roughnessMaskChannel&&(this.roughnessMaskChannel=e.roughnessMaskChannel),void 0!==e.invertRoughnessMask&&(this.roughnessMaskInvert=e.roughnessMaskInvert),void 0!==e.unlit&&(this.unlit=e.unlit))}return(0,o.Z)(t,[{key:"modifierFlags",get:function(){return this._modifierFlags},set:function(t){this._modifierFlags=t}},{key:"setEnabled",value:function(t){this._modifierFlags=this._modifierFlags|t}},{key:"isEnabled",value:function(t){return 0!=(this._modifierFlags&t)}},{key:"diffuse",get:function(){return this._diffuse},set:function(t){this._diffuse=t,this.setEnabled(re.DIFFUSE)}},{key:"specular",get:function(){return this._specular},set:function(t){this._specular=t,this.setEnabled(re.SPECULAR)}},{key:"shininess",get:function(){return this._shininess},set:function(t){isNaN(t)||(this._shininess=t,this.setEnabled(re.SHININESS))}},{key:"lightEmission",get:function(){return this._lightEmission},set:function(t){isNaN(t)||(this._lightEmission=t,this.setEnabled(re.LIGHT_EMISSION))}},{key:"refractionAmount",get:function(){return this._refractionAmount},set:function(t){isNaN(t)||(this._refractionAmount=t,this.setEnabled(re.REFRACTION_AMOUNT))}},{key:"reflectionAmount",get:function(){return this._reflectionAmount},set:function(t){isNaN(t)||(this._reflectionAmount=t,this.setEnabled(re.REFLECTION_AMOUNT))}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this.setEnabled(re.TEXTURE)}},{key:"lightmap",get:function(){return this._lightmap},set:function(t){this._lightmap=t,this.setEnabled(re.LIGHT_MAP)}},{key:"normalMap",get:function(){return this._normalMap},set:function(t){this._normalMap=t,this.setEnabled(re.NORMAL_MAP)}},{key:"textureOffset",get:function(){return this._textureOffset},set:function(t){this._textureOffset=t,this.setEnabled(re.TEXTURE_OFFSET)}},{key:"textureScale",get:function(){return this._textureScale},set:function(t){this._textureScale=t,this.setEnabled(re.TEXTURE_SCALE)}},{key:"lightmapOffset",get:function(){return this._lightmapOffset},set:function(t){this._lightmapOffset=t,this.setEnabled(re.LIGHT_MAP_OFFSET)}},{key:"lightmapScale",get:function(){return this._lightmapScale},set:function(t){this._lightmapScale=t,this.setEnabled(re.LIGHT_MAP_SCALE)}},{key:"normalMapOffset",get:function(){return this._normalMapOffset},set:function(t){this._normalMapOffset=t,this.setEnabled(re.NORMAL_MAP_OFFSET)}},{key:"normalMapScale",get:function(){return this._normalMapScale},set:function(t){this._normalMapScale=t,this.setEnabled(re.NORMAL_MAP_SCALE)}},{key:"castShadows",get:function(){return this._castShadows},set:function(t){this._castShadows=t,this.setEnabled(re.CAST_SHADOWS)}},{key:"receiveShadows",get:function(){return this._receiveShadows},set:function(t){this._receiveShadows=t,this.setEnabled(re.RECEIVE_SHADOWS)}},{key:"alphaCutoff",get:function(){return this._alphaCutoff},set:function(t){isNaN(t)||(this._alphaCutoff=t,this.setEnabled(re.ALPHA_CUTOFF))}},{key:"shininessMask",get:function(){return this._shininessMask},set:function(t){this._shininessMask=t,this.setEnabled(re.SHININESS_MASK)}},{key:"shininessMaskChannel",get:function(){return this._shininessMaskChannel},set:function(t){this._shininessMaskChannel=t,this.setEnabled(re.SHININESS_MASK_CHANNEL)}},{key:"shininessMaskInvert",get:function(){return this._shininessMaskInvert},set:function(t){this._shininessMaskInvert=t,this.setEnabled(re.SHININESS_MASK_INVERT)}},{key:"lightEmissionMask",get:function(){return this._lightEmissionMask},set:function(t){this._lightEmissionMask=t,this.setEnabled(re.LIGHT_EMISSION_MASK)}},{key:"lightEmissionMaskChannel",get:function(){return this._lightEmissionMaskChannel},set:function(t){this._lightEmissionMaskChannel=t,this.setEnabled(re.LIGHT_EMISSION_MASK_CHANNEL)}},{key:"lightEmissionMaskInvert",get:function(){return this._lightEmissionMaskInvert},set:function(t){this._lightEmissionMaskInvert=t,this.setEnabled(re.LIGHT_EMISSION_MASK_INVERT)}},{key:"reflectionMask",get:function(){return this._reflectionMask},set:function(t){this._reflectionMask=t,this.setEnabled(re.REFLECTION_MASK)}},{key:"reflectionMaskChannel",get:function(){return this._reflectionMaskChannel},set:function(t){this._reflectionMaskChannel=t,this.setEnabled(re.REFLECTION_MASK_CHANNEL)}},{key:"reflectionMaskInvert",get:function(){return this._reflectionMaskInvert},set:function(t){this._reflectionMaskInvert=t,this.setEnabled(re.REFLECTION_MASK_INVERT)}},{key:"cullFace",get:function(){return this._cullFace},set:function(t){this._cullFace=t,this.setEnabled(re.CULL_FACE)}},{key:"roughness",get:function(){return this._roughness},set:function(t){this._roughness=t,this.setEnabled(re.ROUGHNESS)}},{key:"roughnessMask",get:function(){return this._roughnessMask},set:function(t){this._roughnessMask=t,this.setEnabled(re.ROUGHNESS)}},{key:"roughnessMaskChannel",get:function(){return this._roughnessMaskChannel},set:function(t){this._roughnessMaskChannel=t,this.setEnabled(re.ROUGHNESS)}},{key:"roughnessMaskInvert",get:function(){return this._roughnessMaskInvert},set:function(t){this._roughnessMaskInvert=t,this.setEnabled(re.ROUGHNESS)}},{key:"unlit",get:function(){return this._unlit},set:function(t){this._unlit=t,this.setEnabled(re.UNLIT)}},{key:"clone",value:function(){var e=new t;return e.assign(this),e}},{key:"assign",value:function(t){this._modifierFlags=t._modifierFlags,this._diffuse=t._diffuse,this._specular=t._specular,this._shininess=t._shininess,this._lightEmission=t._lightEmission,this._refractionAmount=t._refractionAmount,this._reflectionAmount=t._reflectionAmount,this._texture=t._texture,this._lightmap=t._lightmap,this._normalMap=t._normalMap,this._textureOffset=t._textureOffset,this._textureScale=t._textureScale,this._lightmapOffset=t._lightmapOffset,this._lightmapScale=t._lightmapScale,this._normalMapOffset=t._normalMapOffset,this._normalMapScale=t._normalMapScale,this._castShadows=t._castShadows,this._receiveShadows=t._receiveShadows,this._alphaCutoff=t._alphaCutoff,this._shininessMask=t._shininessMask,this._shininessMaskChannel=t._shininessMaskChannel,this._shininessMaskInvert=t._shininessMaskInvert,this._lightEmissionMask=t._lightEmissionMask,this._lightEmissionMaskChannel=t._lightEmissionMaskChannel,this._lightEmissionMaskInvert=t._lightEmissionMaskInvert,this._reflectionMask=t._reflectionMask,this._reflectionMaskChannel=t._reflectionMaskChannel,this._reflectionMaskInvert=t._reflectionMaskInvert,this._cullFace=t._cullFace,this._roughness=t._roughness,this._roughnessMask=t._roughnessMask,this._roughnessMaskChannel=t._roughnessMaskChannel,this._roughnessMaskInvert=t._roughnessMaskInvert,this._unlit=t._unlit}},{key:"serialize",value:function(){var t={},e=this._modifierFlags;return e&re.DIFFUSE&&(t.diffuseR=this._diffuse.r,t.diffuseG=this._diffuse.g,t.diffuseB=this._diffuse.b,t.diffuseA=this._diffuse.a),e&re.SPECULAR&&(t.specularR=this._specular.r,t.specularG=this._specular.g,t.specularB=this._specular.b,t.specularA=this._specular.a),e&re.SHININESS&&(t.shininess=this._shininess),e&re.SHININESS_MASK&&(t.shininessMask=this._shininessMask),e&re.SHININESS_MASK_CHANNEL&&(t.shininessMaskChannel=this._shininessMaskChannel),e&re.SHININESS_MASK_INVERT&&(t.invertShininessMask=this._shininessMaskInvert),e&re.LIGHT_EMISSION&&(t.lightEmission=this._lightEmission),e&re.LIGHT_EMISSION_MASK&&(t.lightEmissionMask=this._lightEmissionMask),e&re.LIGHT_EMISSION_MASK_CHANNEL&&(t.lightEmissionMaskChannel=this._lightEmissionMaskChannel),e&re.LIGHT_EMISSION_MASK_INVERT&&(t.invertLightEmissionMask=this._lightEmissionMaskInvert),e&re.REFRACTION_AMOUNT&&(t.reflectionAmount=this._refractionAmount),e&re.REFLECTION_AMOUNT&&(t.refractionAmount=this._reflectionAmount),e&re.TEXTURE&&(t.texture=this._texture),e&re.LIGHT_MAP&&(t.lightmap=this._lightmap),e&re.NORMAL_MAP&&(t.normalMap=this._normalMap),e&re.TEXTURE_OFFSET&&(t.textureScaleX=this._textureScale.x,t.textureScaleY=this._textureScale.y),e&re.TEXTURE_SCALE&&(t.textureScaleX=this._textureScale.x,t.textureScaleY=this._textureScale.y),e&re.LIGHT_MAP_OFFSET&&(t.lightmapOffsetX=this._lightmapOffset.x,t.lightmapOffsetY=this._lightmapOffset.y),e&re.LIGHT_MAP_SCALE&&(t.lightmapScaleX=this._lightmapScale.x,t.lightmapScaleY=this._lightmapScale.y),e&re.NORMAL_MAP_OFFSET&&(t.normalMapOffsetX=this._normalMapOffset.x,t.normalMapOffsetY=this._normalMapOffset.y),e&re.NORMAL_MAP_SCALE&&(t.normalMapScaleX=this._normalMapScale.x,t.normalMapScaleY=this._normalMapScale.y),e&re.CAST_SHADOWS&&(t.castShadows=this._castShadows),e&re.RECEIVE_SHADOWS&&(t.receiveShadows=this._receiveShadows),e&re.ALPHA_CUTOFF&&(t.alphaCutoff=this._alphaCutoff),e&re.REFLECTION_MASK&&(t.reflectionMask=this._reflectionMask),e&re.REFLECTION_MASK_CHANNEL&&(t.reflectionMaskChannel=this._reflectionMaskChannel),e&re.REFLECTION_MASK_INVERT&&(t.invertReflectionMask=this._reflectionMaskInvert),e&re.CULL_FACE&&(t.cullFace=this._cullFace),e&re.ROUGHNESS&&(t.roughness=this._roughness,t.roughnessMask=this._roughnessMask,t.roughnessMaskChannel=this._roughnessMaskChannel,t.invertRoughnessMask=this._roughnessMaskInvert),e&re.UNLIT&&(t.unlit=this._unlit),t}}]),t}();function ae(t,e,n){return ne.FromImage(t,e,n)}function ue(t){return new pt(0==t?1:0,1==t?1:0,2==t?1:0,3==t?1:0)}function he(t){if(!t)return null;switch(t.length){case 2:return new dt(t[0],t[1]);case 3:return new gt(t[0],t[1],t[2]);case 4:return new pt(t[0],t[1],t[2],t[3])}return null}var le=function(){function t(){(0,r.Z)(this,t),this._diffuse=Mt.White(),this._specular=Mt.White(),this._shininess=0,this._lightEmission=0,this._refractionAmount=0,this._reflectionAmount=0,this._texture=null,this._lightmap=null,this._normalMap=null,this._textureOffset=new dt,this._textureScale=new dt(1),this._lightmapOffset=new dt,this._lightmapScale=new dt(1),this._normalMapOffset=new dt,this._normalMapScale=new dt(1),this._castShadows=!0,this._receiveShadows=!0,this._alphaCutoff=.5,this._shininessMask=null,this._shininessMaskChannel=0,this._shininessMaskInvert=!1,this._lightEmissionMask=null,this._lightEmissionMaskChannel=0,this._lightEmissionMaskInvert=!1,this._reflectionMask=null,this._reflectionMaskChannel=0,this._reflectionMaskInvert=!1,this._cullFace=!0,this._roughness=0,this._roughnessMask=null,this._roughnessMaskChannel=0,this._roughnessMaskInvert=!1,this._unlit=!1,this._selectMode=!1}return(0,o.Z)(t,[{key:"clone",value:function(){var e=new t;return e.assign(this),e}},{key:"assign",value:function(t){this._diffuse=new Mt(t.diffuse),this._specular=new Mt(t.specular),this._shininess=t.shininess,this._lightEmission=t.lightEmission,this._refractionAmount=t.refractionAmount,this._reflectionAmount=t.reflectionAmount,this._texture=t.texture,this._lightmap=t.lightmap,this._normalMap=t.normalMap,this._textureOffset=new dt(t.textureOffset),this._textureScale=new dt(t.textureScale),this._lightmapOffset=new dt(t.ligthmapOffset),this._lightmapScale=new dt(t.lightmapScale),this._normalMapOffset=new dt(t.normalMapOffset),this._normalMapScale=new dt(t.normalMapScale),this._castShadows=t.castShadows,this._receiveShadows=t.receiveShadows,this._alphaCutoff=t.alphaCutoff,this._shininessMask=t.shininessMask,this._shininessMaskChannel=t.shininessMaskChannel,this._shininessMaskInvert=t.shininessMaskInvert,this._lightEmissionMask=t.lightEmissionMask,this._lightEmissionMaskChannel=t.lightEmissionMaskChannel,this._lightEmissionMaskInvert=t.lightEmissionMaskInvert,this._reflectionMask=t.reflectionMask,this._reflectionMaskChannel=t.reflectionMaskChannel,this._reflectionMaskInvert=t.reflectionMaskInvert,this._cullFace=t.cullFace,this._roughness=t.roughness,this._roughnessMask=t.roughnessMask,this._roughnessMaskChannel=t.roughnessMaskChannel,this._roughnessMaskInvert=t.roughnessMaskInvert,this._unlit=t.unlit}},{key:"isTransparent",get:function(){return this._diffuse.a<1}},{key:"diffuse",get:function(){return this._diffuse},set:function(t){this._diffuse=t}},{key:"specular",get:function(){return this._specular},set:function(t){this._specular=t}},{key:"shininess",get:function(){return this._shininess},set:function(t){isNaN(t)||(this._shininess=t)}},{key:"lightEmission",get:function(){return this._lightEmission},set:function(t){isNaN(t)||(this._lightEmission=t)}},{key:"refractionAmount",get:function(){return this._refractionAmount},set:function(t){this._refractionAmount=t}},{key:"reflectionAmount",get:function(){return this._reflectionAmount},set:function(t){this._reflectionAmount=t}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t}},{key:"lightmap",get:function(){return this._lightmap},set:function(t){this._lightmap=t}},{key:"normalMap",get:function(){return this._normalMap},set:function(t){this._normalMap=t}},{key:"textureOffset",get:function(){return this._textureOffset},set:function(t){this._textureOffset=t}},{key:"textureScale",get:function(){return this._textureScale},set:function(t){this._textureScale=t}},{key:"lightmapOffset",get:function(){return this._lightmapOffset},set:function(t){this._lightmapOffset=t}},{key:"lightmapScale",get:function(){return this._lightmapScale},set:function(t){this._lightmapScale=t}},{key:"normalMapOffset",get:function(){return this._normalMapOffset},set:function(t){this._normalMapOffset=t}},{key:"normalMapScale",get:function(){return this._normalMapScale},set:function(t){this._normalMapScale=t}},{key:"castShadows",get:function(){return this._castShadows},set:function(t){this._castShadows=t}},{key:"receiveShadows",get:function(){return this._receiveShadows},set:function(t){this._receiveShadows=t}},{key:"alphaCutoff",get:function(){return this._alphaCutoff},set:function(t){isNaN(t)||(this._alphaCutoff=t)}},{key:"shininessMask",get:function(){return this._shininessMask},set:function(t){this._shininessMask=t}},{key:"shininessMaskChannel",get:function(){return this._shininessMaskChannel},set:function(t){this._shininessMaskChannel=t}},{key:"shininessMaskInvert",get:function(){return this._shininessMaskInvert},set:function(t){this._shininessMaskInvert=t}},{key:"lightEmissionMask",get:function(){return this._lightEmissionMask},set:function(t){this._lightEmissionMask=t}},{key:"lightEmissionMaskChannel",get:function(){return this._lightEmissionMaskChannel},set:function(t){this._lightEmissionMaskChannel=t}},{key:"lightEmissionMaskInvert",get:function(){return this._lightEmissionMaskInvert},set:function(t){this._lightEmissionMaskInvert=t}},{key:"reflectionMask",get:function(){return this._reflectionMask},set:function(t){this._reflectionMask=t}},{key:"reflectionMaskChannel",get:function(){return this._reflectionMaskChannel},set:function(t){this._reflectionMaskChannel=t}},{key:"reflectionMaskInvert",get:function(){return this._reflectionMaskInvert},set:function(t){this._reflectionMaskInvert=t}},{key:"cullFace",get:function(){return this._cullFace},set:function(t){this._cullFace=t}},{key:"roughness",get:function(){return this._roughness},set:function(t){this._roughness=t}},{key:"roughnessMask",get:function(){return this._roughnessMask},set:function(t){this._roughnessMask=t}},{key:"roughnessMaskChannel",get:function(){return this._roughnessMaskChannel},set:function(t){this._roughnessMaskChannel=t}},{key:"roughnessMaskInvert",get:function(){return this._roughnessMaskInvert},set:function(t){this._roughnessMaskInvert=t}},{key:"unlit",get:function(){return this._unlit},set:function(t){this._unlit=t}},{key:"selectMode",get:function(){return this._selectMode},set:function(t){this._selectMode=t}},{key:"lightEmissionMaskChannelVector",get:function(){return ue(this.lightEmissionMaskChannel)}},{key:"shininessMaskChannelVector",get:function(){return ue(this.shininessMaskChannel)}},{key:"reflectionMaskChannelVector",get:function(){return ue(this.reflectionMaskChannel)}},{key:"roughnessMaskChannelVector",get:function(){return ue(this.roughnessMaskChannel)}},{key:"getExternalResources",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];function e(e){e&&e.fileName&&""!=e.fileName&&-1==t.indexOf(e.fileName)&&t.push(e.fileName)}return e(this.texture),e(this.lightmap),e(this.normalMap),e(this.shininessMask),e(this.lightEmissionMask),e(this.reflectionMask),e(this.roughnessMask),t}},{key:"copyMaterialSettings",value:function(t,e){e&re.DIFFUSE&&(t.diffuse=this.diffuse),e&re.SPECULAR&&(t.specular=this.specular),e&re.SHININESS&&(t.shininess=this.shininess),e&re.LIGHT_EMISSION&&(t.lightEmission=this.lightEmission),e&re.REFRACTION_AMOUNT&&(t.refractionAmount=this.refractionAmount),e&re.REFLECTION_AMOUNT&&(t.reflectionAmount=this.reflectionAmount),e&re.TEXTURE&&(t.texture=this.texture),e&re.LIGHT_MAP&&(t.lightmap=this.lightmap),e&re.NORMAL_MAP&&(t.normalMap=this.normalMap),e&re.TEXTURE_OFFSET&&(t.textureOffset=this.textureOffset),e&re.TEXTURE_SCALE&&(t.textureScale=this.textureScale),e&re.LIGHT_MAP_OFFSET&&(t.lightmapOffset=this.lightmapOffset),e&re.LIGHT_MAP_SCALE&&(t.lightmapScale=this.lightmapScale),e&re.NORMAL_MAP_OFFSET&&(t.normalMapOffset=this.normalMapOffset),e&re.NORMAL_MAP_SCALE&&(t.normalMapScale=this.normalMapScale),e&re.CAST_SHADOWS&&(t.castShadows=this.castShadows),e&re.RECEIVE_SHADOWS&&(t.receiveShadows=this.receiveShadows),e&re.ALPHA_CUTOFF&&(t.alphaCutoff=this.alphaCutoff),e&re.SHININESS_MASK&&(t.shininessMask=this.shininessMask),e&re.SHININESS_MASK_CHANNEL&&(t.shininessMaskChannel=this.shininessMaskChannel),e&re.SHININESS_MASK_INVERT&&(t.shininessMaskInvert=this.shininessMaskInvert),e&re.LIGHT_EMISSION_MASK&&(t.lightEmissionMask=this.lightEmissionMask),e&re.LIGHT_EMISSION_MASK_CHANNEL&&(t.lightEmissionMaskChannel=this.lightEmissionMaskChannel),e&re.LIGHT_EMISSION_MASK_INVERT&&(t.lightEmissionMaskInvert=this.lightEmissionMaskInvert),e&re.REFLECTION_MASK&&(t.reflectionMask=this.reflectionMask),e&re.REFLECTION_MASK_CHANNEL&&(t.reflectionMaskChannel=this.reflectionMaskChannel),e&re.REFLECTION_MASK_INVERT&&(t.reflectionMaskInvert=this.reflectionMaskInvert),e&re.CULL_FACE&&(t.cullFace=this.cullFace),e&re.ROUGHNESS&&(t.reflectionAmount=this.reflectionAmount,t.reflectionMask=this.reflectionMask,t.reflectionMaskChannel=this.reflectionMaskChannel,t.reflectionMaskInvert=this.reflectionMaskInvert),e&re.UNLIT&&(t.unlit=this.unlit)}},{key:"applyModifier",value:function(t,e,n){e.isEnabled(re.DIFFUSE)&&(this.diffuse=e.diffuse),e.isEnabled(re.SPECULAR)&&(this.specular=e.specular),e.isEnabled(re.SHININESS)&&(this.shininess=e.shininess),e.isEnabled(re.LIGHT_EMISSION)&&(this.lightEmission=e.lightEmission),e.isEnabled(re.REFRACTION_AMOUNT)&&(this.refractionAmount=e.refractionAmount),e.isEnabled(re.REFLECTION_AMOUNT)&&(this.reflectionAmount=e.reflectionAmount),e.isEnabled(re.TEXTURE)&&(this.texture=getTexture(t,e.texture,n)),e.isEnabled(re.LIGHT_MAP)&&(this.lightmap=getTexture(t,e.lightmap,n)),e.isEnabled(re.NORMAL_MAP)&&(this.normalMap=getTexture(t,e.normalMap,n)),e.isEnabled(re.TEXTURE_OFFSET)&&(this.textureOffset=e.textureOffset),e.isEnabled(re.TEXTURE_SCALE)&&(this.textureScale=e.textureScale),e.isEnabled(re.LIGHT_MAP_OFFSET)&&(this.lightmapOffset=e.lightmapOffset),e.isEnabled(re.LIGHT_MAP_SCALE)&&(this.lightmapScale=e.lightmapScale),e.isEnabled(re.NORMAL_MAP_OFFSET)&&(this.normalMapOffset=e.normalMapOffset),e.isEnabled(re.NORMAL_MAP_SCALE)&&(this.normalMapScale=e.normalMapScale),e.isEnabled(re.CAST_SHADOWS)&&(this.castShadows=e.castShadows),e.isEnabled(re.RECEIVE_SHADOWS)&&(this.receiveShadows=e.receiveShadows),e.isEnabled(re.ALPHA_CUTOFF)&&(this.alphaCutoff=e.alphaCutoff),e.isEnabled(re.SHININESS_MASK)&&(this.shininessMask=getTexture(t,e.shininessMask,n)),e.isEnabled(re.SHININESS_MASK_CHANNEL)&&(this.shininessMaskChannel=e.shininessMaskChannel),e.isEnabled(re.SHININESS_MASK_INVERT)&&(this.shininessMaskInvert=e.shininessMaskInvert),e.isEnabled(re.LIGHT_EMISSION_MASK)&&(this.lightEmissionMask=getTexture(t,e.lightEmissionMask,n)),e.isEnabled(re.LIGHT_EMISSION_MASK_CHANNEL)&&(this.lightEmissionMaskChannel=e.lightEmissionMaskChannel),e.isEnabled(re.LIGHT_EMISSION_MASK_INVERT)&&(this.lightEmissionMaskInvert=e.lightEmissionMaskInvert),e.isEnabled(re.REFLECTION_MASK)&&(this.reflectionMask=getTexture(t,e.reflectionMask,n)),e.isEnabled(re.REFLECTION_MASK_CHANNEL)&&(this.reflectionMaskChannel=e.reflectionMaskChannel),e.isEnabled(re.REFLECTION_MASK_INVERT)&&(this.reflectionMaskInvert=e.reflectionMaskInvert),e.isEnabled(re.CULL_FACE)&&(this.cullFace=e.cullFace),e.isEnabled(re.ROUGHNESS)&&(this.roughness=e.roughness,this.roughnessMask=getTexture(t,e.roughnessMask,n),this.roughnessMaskChannel=e.roughnessMaskChannel,this.roughnessMaskInvert=e.roughnessMaskInvert),e.isEnabled(re.UNLIT)&&(this.unlit=e.unlit)}},{key:"getModifierWithMask",value:function(t){var e=new oe;return e.modifierFlags=t,e.isEnabled(re.DIFFUSE)&&(e.diffuse=this.diffuse),e.isEnabled(re.SPECULAR)&&(e.specular=this.specular),e.isEnabled(re.SHININESS)&&(e.shininess=this.shininess),e.isEnabled(re.LIGHT_EMISSION)&&(e.lightEmission=this.lightEmission),e.isEnabled(re.REFRACTION_AMOUNT)&&(e.refractionAmount=this.refractionAmount),e.isEnabled(re.REFLECTION_AMOUNT)&&(e.reflectionAmount=this.reflectionAmount),e.isEnabled(re.TEXTURE)&&(e.texture=getPath(this.texture)),e.isEnabled(re.LIGHT_MAP)&&(e.lightmap=getPath(this.lightmap)),e.isEnabled(re.NORMAL_MAP)&&(e.normalMap=getPath(this.normalMap)),e.isEnabled(re.TEXTURE_OFFSET)&&(e.textureOffset=this.textureOffset),e.isEnabled(re.TEXTURE_SCALE)&&(e.textureScale=this.textureScale),e.isEnabled(re.LIGHT_MAP_OFFSET)&&(e.lightmapOffset=this.lightmapOffset),e.isEnabled(re.LIGHT_MAP_SCALE)&&(e.lightmapScale=this.lightmapScale),e.isEnabled(re.NORMAL_MAP_OFFSET)&&(e.normalMapOffset=this.normalMapOffset),e.isEnabled(re.NORMAL_MAP_SCALE)&&(e.normalMapScale=this.normalMapScale),e.isEnabled(re.CAST_SHADOWS)&&(e.castShadows=this.castShadows),e.isEnabled(re.RECEIVE_SHADOWS)&&(e.receiveShadows=this.receiveShadows),e.isEnabled(re.ALPHA_CUTOFF)&&(e.alphaCutoff=this.alphaCutoff),e.isEnabled(re.SHININESS_MASK)&&(e.shininessMask=getPath(this.shininessMask)),e.isEnabled(re.SHININESS_MASK_CHANNEL)&&(e.shininessMaskChannel=this.shininessMaskChannel),e.isEnabled(re.SHININESS_MASK_INVERT)&&(e.shininessMaskInvert=this.shininessMaskInvert),e.isEnabled(re.LIGHT_EMISSION_MASK)&&(e.lightEmissionMask=getPath(this.lightEmissionMask)),e.isEnabled(re.LIGHT_EMISSION_MASK_CHANNEL)&&(e.lightEmissionMaskChannel=this.lightEmissionMaskChannel),e.isEnabled(re.LIGHT_EMISSION_MASK_INVERT)&&(e.lightEmissionMaskInver=this.lightEmissionMaskInver),e.isEnabled(re.REFLECTION_MASK)&&(e.reflectionMask=getPath(this.reflectionMask)),e.isEnabled(re.REFLECTION_MASK_CHANNEL)&&(e.reflectionMaskChannel=this.reflectionMaskChannel),e.isEnabled(re.REFLECTION_MASK_INVERT)&&(e.reflectionMaskInvert=this.reflectionMaskInvert),e.isEnabled(re.CULL_FACE)&&(e.cullFace=this.cullFace),e.isEnabled(re.ROUGHNESS)&&(e.roughness=this.roughness,e.roughnessMask=getPath(this.roughnessMask),e.roughnessMaskChannel=this.roughnessMaskChannel,e.roughnessMaskInvert=this.roughnessMaskInvert),e.isEnabled(re.UNLIT)&&(e.unlit=this.unlit),e}}],[{key:"FromMaterialDefinition",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new Promise((function(s,r){var o=new t;o.diffuse=he(n.diffuse)||Mt.White(),o.specular=he(n.specular)||Mt.White(),o.shininess=n.shininess||0,o.shininessMaskChannel=n.shininessMaskChannel||0,o.shininessMaskInvert=n.shininessMaskInvert||!1,o.lightEmission=n.lightEmission||0,o.lightEmissionMaskChannel=n.lightEmissionMaskChannel||0,o.lightEmissionMaskInvert=n.lightEmissionMaskInvert||!1,o.refractionAmount=n.refractionAmount||0,o.reflectionAmount=n.reflectionAmount||0,o.reflectionMaskChannel=n.reflectionMaskChannel||0,o.reflectionMaskInvert=n.reflectionMaskInvert||!1,o.textureOffset=he(n.textureOffset)||new dt(0,0),o.textureScale=he(n.textureScale)||new dt(1,1),o.normalMapOffset=he(n.normalMapOffset)||new dt(0,0),o.normalMapScale=he(n.normalMapScale)||new dt(1,1),o.cullFace=void 0===n.cullFace||n.cullFace,o.castShadows=void 0===n.castShadows||n.castShadows,o.receiveShadows=void 0===n.receiveShadows||n.receiveShadows,o.alphaCutoff=void 0===n.alphaCutoff?.5:n.alphaCutoff,o.name=n.name,o.description=n.description,o.roughness=n.roughness||0,o.roughnessMaskChannel=n.roughnessMaskChannel||0,o.roughnessMaskInvert=n.roughnessMaskInvert||!1,o.unlit=n.unlit||!1;var a=[];a.push(readTexture(e,i,n.shininessMask,o,"shininessMask")),a.push(readTexture(e,i,n.lightEmissionMask,o,"lightEmissionMask")),a.push(readTexture(e,i,n.reflectionMask,o,"reflectionMask")),a.push(readTexture(e,i,n.texture,o,"texture")),a.push(readTexture(e,i,n.normalMap,o,"normalMap")),a.push(readTexture(e,i,n.roughnessMask,o,"roughnessMask")),Promise.all(a).then((function(){s(o)}))}))}},{key:"GetMaterialWithJson",value:function(e,n,i){var s=new t;function r(t,e){return e?t?t+e:e:null}return void 0===n.cullFace&&(n.cullFace=!0),s.diffuse.set(n.diffuseR,n.diffuseG,n.diffuseB,n.diffuseA),s.specular.set(n.specularR,n.specularG,n.specularB,n.specularA),s.shininess=n.shininess,s.lightEmission=n.lightEmission,s.refractionAmount=n.refractionAmount,s.reflectionAmount=n.reflectionAmount,s.textureOffset.set(n.textureOffsetX,n.textureOffsetY),s.textureScale.set(n.textureScaleX,n.textureScaleY),s.lightmapOffset.set(n.lightmapOffsetX,n.lightmapOffsetY),s.lightmapScale.set(n.lightmapScaleX,n.lightmapScaleY),s.normalMapOffset.set(n.normalMapOffsetX,n.normalMapOffsetY),s.normalMapScale.set(n.normalMapScaleX,n.normalMapScaleY),s.alphaCutoff=n.alphaCutoff,s.castShadows=n.castShadows,s.receiveShadows=n.receiveShadows,s.shininessMaskChannel=n.shininessMaskChannel,s.shininessMaskInvert=n.invertShininessMask,s.lightEmissionMaskChannel=n.lightEmissionMaskChannel,s.lightEmissionMaskInvert=n.invertLightEmissionMask,s.reflectionMaskChannel=n.reflectionMaskChannel,s.reflectionMaskInvert=n.invertReflectionMask,s.roughness=n.roughness,s.roughnessMaskChannel=n.roughnessMaskChannel,s.roughnessMaskInvert=n.invertRoughnessMask,s.cullFace=n.cullFace,s.unlit=n.unlit,i&&"/"!=i[i.length-1]&&(i+="/"),n.texture=r(i,n.texture),n.lightmap=r(i,n.lightmap),n.normalMap=r(i,n.normalMap),n.shininessMask=r(i,n.shininessMask),n.lightEmissionMask=r(i,n.lightEmissionMask),n.reflectionMask=r(i,n.reflectionMask),n.roughnessMask=r(i,n.roughnessMask),new Promise((function(t,i){var r=[];n.texture&&r.push(n.texture),n.lightmap&&-1==r.indexOf(n.lightmap)&&r.push(n.lightmap),n.normalMap&&-1==r.indexOf(n.normalMap)&&r.push(n.normalMap),n.shininessMask&&-1==r.indexOf(n.shininessMask)&&r.push(n.shininessMask),n.lightEmissionMask&&-1==r.indexOf(n.lightEmissionMask)&&r.push(n.lightEmissionMask),n.reflectionMask&&-1==r.indexOf(n.reflectionMask)&&r.push(n.reflectionMask),n.roughnessMask&&-1==r.indexOf(n.roughnessMask)&&r.push(n.roughnessMask),x.Load(r).then((function(i){s.texture=ae(e,i[n.texture],n.texture),s.lightmap=ae(e,i[n.lightmap],n.lightmap),s.normalMap=ae(e,i[n.normalMap],n.normalMap),s.shininessMask=ae(e,i[n.shininessMask],n.shininessMask),s.lightEmissionMask=ae(e,i[n.lightEmissionMask],n.lightEmissionMask),s.reflectionMask=ae(e,i[n.reflectionMask],n.reflectionMask),s.roughnessMask=ae(e,i[n.roughnessMask],n.roughnessMask),t(s)}))}))}}]),t}();var ce=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){return(0,r.Z)(this,s),i.apply(this,arguments)}return(0,o.Z)(s,[{key:"acceptType",value:function(t,e){return"bg2mat"==x.GetExtension(t)}},{key:"load",value:function(t,e,n){return new Promise((function(i,s){if(n)try{"string"==typeof n&&(n=JSON.parse(n));var r=[],o=e.substring(0,e.lastIndexOf("/")+1);n.forEach((function(e){r.push(le.FromMaterialDefinition(t,e,o))})),Promise.all(r).then((function(t){i(t)}))}catch(t){s(t)}else s(new Error("Error loading material. Data is null."))}))}}]),s}(nt);var _e=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){return(0,r.Z)(this,s),i.apply(this,arguments)}return(0,o.Z)(s,[{key:"acceptType",value:function(t,e){return bg.utils.Resource.IsVideo(t)}},{key:"load",value:function(t,e,n){return new Promise((function(i,s){if(n){var r=new bg.base.Texture(t);r.create(),r.bind(),r.setVideo(n),r.fileName=e,i(r)}else s(new Error("Error loading video texture data"))}))}}]),s}(nt);window.s_bg_base_imageTools={base64Images:{}};const fe={Bg2matLoaderPlugin:ce,BufferType:Ot,Effect:J,DrawMode:Vt,imageTools:{isAbsolutePath:function(t){return/^(f|ht)tps?:\/\//i.test(t)},mergePaths:function(t,e){return"/"!=t.slice(-1)?t+"/"+e:t+e},getTexture:function(t,e,n){var i,s,r=null;return e&&(isAbsolutePath(e)||("/"!=n.slice(-1)&&(n+="/"),e="".concat(n).concat(e)),(r=$t.Get(t).find(e))||((r=new ne(t)).create(),r.fileName=e,$t.Get(t).register(e,r),i=e,s=r,x.Load(i).then((function(t){s.bind(),r.minFilter=qt.GetMinFilter(),r.magFilter=qt.GetMagFilter(),s.fileName=i,s.setImage(t)})))),r},getPath:function(t){return t?t.fileName:""},readTexture:function(t,e,n,i,s){return new Promise((function(r){if(n)if(/data\:image\/[a-z]+\;base64\,/.test(n)){var o=I(n);window.s_bg_base_imageTools.base64Images[o]?i[s]=window.s_bg_base_imageTools.base64Images[o]:(i[s]=ne.FromBase64Image(t,n),window.s_bg_base_imageTools.base64Images[o]=i[s]),r(i[s])}else{var a=e+n;ot.Load(t,a).then((function(t){i[s]=t,r(t)}))}else r()}))}},LoaderPlugin:nt,Loader:ot,PolyList:Ft,MaterialFlag:re,Material:le,MaterialModifier:oe,ShaderType:$,Shader:q,ShaderLibrary:Bt,ShaderSource:Xt,TextureUnit:{TEXTURE_0:0,TEXTURE_1:1,TEXTURE_2:2,TEXTURE_3:3,TEXTURE_4:4,TEXTURE_5:5,TEXTURE_6:6,TEXTURE_7:7,TEXTURE_8:8,TEXTURE_9:9,TEXTURE_10:10,TEXTURE_11:11,TEXTURE_12:12,TEXTURE_13:13,TEXTURE_14:14,TEXTURE_15:15,TEXTURE_16:16,TEXTURE_17:17,TEXTURE_18:18,TEXTURE_19:19,TEXTURE_20:20,TEXTURE_21:21,TEXTURE_22:22,TEXTURE_23:23,TEXTURE_24:24,TEXTURE_25:25,TEXTURE_26:26,TEXTURE_27:27,TEXTURE_28:28,TEXTURE_29:29,TEXTURE_30:30},TextureWrap:Jt,TextureFilter:Qt,TextureTarget:te,TextureDataType:ee,Texture:ne,TextureCache:$t,TextureEffect:se,TextureLoaderPlugin:qt,VideoTextureLoaderPlugin:_e};var me=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return(0,r.Z)(this,s),(t=i.call(this,new _t(6)))._v[0]=e,t._v[1]=n,t._v[2]=o,t._v[3]=a,t._v[4]=u,t._v[5]=h,t}return(0,o.Z)(s,[{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]&&this._v[2]==t._v[2]&&this._v[3]==t._v[3]&&this._v[4]==t._v[4]&&this._v[5]==t._v[5]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]||this._v[2]!=t._v[2]||this._v[3]!=t._v[3]||this._v[4]!=t._v[4]||this._v[5]!=t._v[5]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],this._v[2]=t._v[2],this._v[3]=t._v[3],this._v[4]=t._v[4],this._v[5]=t._v[5]}},{key:"set",value:function(t,e,n,i,s,r){this._v[0]=t,this._v[1]=void 0===e?t:e,this._v[2]=void 0===e?t:n,this._v[3]=void 0===e?t:i,this._v[4]=void 0===e?t:s,this._v[5]=void 0===e?t:r}},{key:"left",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"right",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"bottom",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"top",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"back",get:function(){return this._v[4]},set:function(t){this._v[4]=t}},{key:"front",get:function(){return this._v[5]},set:function(t){this._v[5]=t}},{key:"width",get:function(){return Math.abs(this._v[1]-this._v[0])}},{key:"height",get:function(){return Math.abs(this._v[3]-this._v[2])}},{key:"depth",get:function(){return Math.abs(this._v[5]-this._v[4])}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])||isNaN(this._v[2])||isNaN(this._v[3])||isNaN(this._v[4])||isNaN(this._v[5])}},{key:"toString",value:function(){return"["+this._v+"]"}},{key:"isInBounds",value:function(t){return t.x>=this._v[0]&&t.x<=this._v[1]&&t.y>=this._v[2]&&t.y<=this._v[3]&&t.z>=this._v[4]&&t.z<=this._v[5]}}]),s}(vt);var ve=function(t){v(s,t);var e,n,i=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=p(e);if(n){var s=p(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return g(this,t)});function s(t,e,n,o){var a;return(0,r.Z)(this,s),a=i.call(this),void 0===t?a.zero():void 0===e?t._v&&t._v.lenght>=4?a.clone(t):t._m&&9==t._m.length?a.initWithMatrix3(t):t._m&&16==t._m.length?a.initWithMatrix4(t):a.zero():void 0!==t&&void 0!==e&&void 0!==n&&void 0!==o?a.initWithValues(t,e,n,o):a.zero(),a}return(0,o.Z)(s,[{key:"initWithValues",value:function(t,e,n,i){return this._v[0]=e*At(t/2),this._v[1]=n*At(t/2),this._v[2]=i*At(t/2),this._v[3]=Tt(t/2),this}},{key:"clone",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],this._v[2]=t._v[2],this._v[3]=t._v[3]}},{key:"initWithMatrix3",value:function(t){var e=Rt(1+t._m[0]+t._m[4]+t._m[8])/2,n=4*e;this._v[0]=(t._m[7]-t._m[5])/e,this._v[1]=(t._m[2]-t._m[6])/n,this._v[2]=(t._m[3]-t._m[1])/n,this._v[3]=e}},{key:"initWithMatrix4",value:function(t){var e=Rt(1+t._m[0]+t._m[5]+t._m[10])/2,n=4*e;this._v[0]=(t._m[9]-t._m[6])/e,this._v[1]=(t._m[2]-t._m[8])/n,this._v[2]=(t._m[4]-t._m[1])/n,this._v[3]=e}},{key:"getMatrix4",value:function(){var t=Lt.Identity(),e=this._v;return t.setRow(0,new pt(1-2*e[1]*e[1]-2*e[2]*e[2],2*e[0]*e[1]-2*e[2]*e[3],2*e[0]*e[2]+2*e[1]*e[3],0)),t.setRow(1,new pt(2*e[0]*e[1]+2*e[2]*e[3],1-2*e[0]*e[0]-2*e[2]*e[2],2*e[1]*e[2]-2*e[0]*e[3],0)),t.setRow(2,new pt(2*e[0]*e[2]-2*e[1]*e[3],2*e[1]*e[2]+2*e[0]*e[3],1-2*e[0]*e[0]-2*e[1]*e[1],0)),t}},{key:"getMatrix3",value:function(){var t=xt.Identity(),e=this._v;return t.setRow(0,new Vector3(1-2*e[1]*e[1]-2*e[2]*e[2],2*e[0]*e[1]-2*e[2]*e[3],2*e[0]*e[2]+2*e[1]*e[3])),t.setRow(1,new Vector3(2*e[0]*e[1]+2*e[2]*e[3],1-2*e[0]*e[0]-2*e[2]*e[2],2*e[1]*e[2]-2*e[0]*e[3])),t.setRow(2,new Vector3(2*e[0]*e[2]-2*e[1]*e[3],2*e[1]*e[2]+2*e[0]*e[3],1-2*e[0]*e[0]-2*e[1]*e[1])),t}}],[{key:"MakeWithMatrix",value:function(t){return new s(t)}}]),s}(pt);const de={utils:N,app:K,base:fe,math:{Axis:at,PI:ut,DEG_TO_RAD:ht,RAD_TO_DEG:lt,PI_2:1.5707963267948966,PI_4:.785398163397448,PI_8:.392699081698724,TWO_PI:6.283185307179586,EPSILON:ct,NumericArray:_t,NumericArrayHighP:ft,FLOAT_MAX:3402823e32,checkPowerOfTwo:St,checkZero:It,equals:function(t,e){return Math.abs(t-e)<ct},degreesToRadians:function(t){return Math.fround(It(t*ht))},radiansToDegrees:function(t){return Math.fround(It(t*lt))},sin:At,cos:Tt,tan:Nt,cotan:function(t){return Math.fround(It(1/Nt(t)))},atan:function(t){return Math.fround(It(Math.atan(t)))},atan2:function(t,e){return Math.fround(It(Math.atan2f(t,e)))},random:function(){return Math.random()},seededRandom:Ct,max:function(t,e){return Math.fround(Math.max(t,e))},min:function(t,e){return Math.fround(Math.min(t,e))},abs:function(t){return Math.fround(Math.abs(t))},sqrt:Rt,lerp:function(t,e,n){return Math.fround((1-n)*t+n*e)},square:function(t){return Math.fround(t*t)},Vector:vt,Vector2:dt,Vector3:gt,Vector4:pt,Size2D:yt,Size3D:kt,Position2D:Et,Viewport:wt,Color:Mt,Bounds:me,Quaternion:ve,Matrix3:xt,Matrix4:Lt}}},9:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(671),s=n(144);t=n.hmd(t);var r=function(){function e(){(0,i.Z)(this,e)}return(0,s.Z)(e,[{key:"isElectronApp",get:function(){return!!t.exports}}]),e}()},666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var s=e&&e.prototype instanceof d?e:d,r=Object.create(s.prototype),o=new A(i||[]);return r._invoke=function(t,e,n){var i=c;return function(s,r){if(i===f)throw new Error("Generator is already running");if(i===m){if("throw"===s)throw r;return N()}for(n.method=s,n.arg=r;;){var o=n.delegate;if(o){var a=b(o,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===c)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var u=l(t,e,n);if("normal"===u.type){if(i=n.done?m:_,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}(t,n,o),r}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var c="suspendedStart",_="suspendedYield",f="executing",m="completed",v={};function d(){}function g(){}function p(){}var y={};u(y,r,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(T([])));E&&E!==n&&i.call(E,r)&&(y=E);var w=p.prototype=d.prototype=Object.create(y);function M(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(s,r,o,a){var u=l(t[s],t,r);if("throw"!==u.type){var h=u.arg,c=h.value;return c&&"object"==typeof c&&i.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(c).then((function(t){h.value=t,o(h)}),(function(t){return n("throw",t,o,a)}))}a(u.arg)}var s;this._invoke=function(t,i){function r(){return new e((function(e,s){n(t,i,e,s)}))}return s=s?s.then(r,r):r()}}function b(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,b(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var s=l(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,v;var r=s.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(t){if(t){var n=t[r];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,o=function n(){for(;++s<t.length;)if(i.call(t,s))return n.value=t[s],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:e,done:!0}}return g.prototype=p,u(w,"constructor",p),u(p,"constructor",g),g.displayName=u(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,a,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},M(x.prototype),u(x.prototype,o,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,i,s,r){void 0===r&&(r=Promise);var o=new x(h(e,n,i,s),r);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},M(w),u(w,a,"Generator"),u(w,r,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=T,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function s(i,s){return a.type="throw",a.arg=t,n.next=i,s&&(n.method="next",n.arg=e),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),h=i.call(o,"finallyLoc");if(u&&h){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var s=i.arg;I(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:T(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},671:(t,e,n)=>{"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:()=>i})},144:(t,e,n)=>{"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{Z:()=>s})}},i={};function s(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={id:t,loaded:!1,exports:{}};return n[t](r,r.exports,s),r.loaded=!0,r.exports}return s.m=n,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,n)=>(s.f[n](t,e),e)),[])),s.u=t=>t+".0f670139fc44daab623c.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="bg2e:",s.l=(n,i,r,o)=>{if(t[n])t[n].push(i);else{var a,u;if(void 0!==r)for(var h=document.getElementsByTagName("script"),l=0;l<h.length;l++){var c=h[l];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==e+r){a=c;break}}a||(u=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",e+r),a.src=n),t[n]=[i];var _=(e,i)=>{a.onerror=a.onload=null,clearTimeout(f);var s=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((t=>t(i))),e)return e(i)},f=setTimeout(_.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=_.bind(null,a.onerror),a.onload=_.bind(null,a.onload),u&&document.head.appendChild(a)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={179:0};s.f.j=(e,n)=>{var i=s.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,s)=>i=t[e]=[n,s]));n.push(i[2]=r);var o=s.p+s.u(e),a=new Error;s.l(o,(n=>{if(s.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,r,[o,a,u]=n,h=0;if(o.some((e=>0!==t[e]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);u&&u(s)}for(e&&e(n);h<o.length;h++)r=o[h],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=self.webpackChunkbg2e=self.webpackChunkbg2e||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),s(463)})()}));
//# sourceMappingURL=bg2e.js.map