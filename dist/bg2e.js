!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.bg2e=e():t.bg2e=e()}(self,(function(){return(()=>{"use strict";var t,e,n={2:(t,e,n)=>{n.r(e),n.d(e,{default:()=>mi});var i=function(){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}},r=function(t){var e={gl:null,supported:!1,experimental:!1};try{e.gl=t.getContext("webgl",{preserveDrawingBuffer:!0}),e.supported=null!=e.gl}catch(t){e.supported=!1}if(!e.supported)try{e.gl=t.getContext("experimental-webgl",{preserveDrawingBuffer:!0}),e.supported=null!=e.gl,e.experimental=!0}catch(t){}return e&&(e.gl.uuid=Symbol(e.gl)),e};function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.system={},this.browser={},e||(e=navigator.userAgent),this.parseOperatingSystem(e),this.parseBrowser(e)}var e,n;return e=t,(n=[{key:"parseOperatingSystem",value:function(t){this.system.OSX=/Macintosh/.test(t),this.system.Windows=/Windows/.test(t),this.system.iPhone=/iPhone/.test(t),this.system.iPodTouch=/iPod/.test(t),this.system.iPad=/iPad/.test(t),this.system.iOS=this.system.iPhone||this.system.iPad||this.system.iPodTouch,this.system.Android=/Android/.test(t),this.system.Linux=!this.system.Android&&/Linux/.test(t),this.system.OSX?(this.system.OSName="OS X",this.parseOSXVersion(t)):this.system.Windows?(this.system.OSName="Windows",this.parseWindowsVersion(t)):this.system.Linux?(this.system.OSName="Linux",this.parseLinuxVersion(t)):this.system.iOS?(this.system.OSName="iOS",this.parseIOSVersion(t)):this.system.Android&&(this.system.OSName="Android",this.parseAndroidVersion(t))}},{key:"parseBrowser",value:function(t){if(this.browser.Version={},this.browser.Safari=/Version\/([\d\.]+) Safari\//.test(t),this.browser.Safari&&(this.browser.Name="Safari",this.browser.Vendor="Apple",this.browser.Version.versionString=RegExp.$1),this.browser.Chrome=/Chrome\/([\d\.]+) Safari\//.test(t),this.browser.Chrome&&(this.browser.Name="Chrome",this.browser.Vendor="Google",this.browser.Version.versionString=RegExp.$1),this.browser.Opera=/Opera\/[\d\.]+/.test(t),this.browser.Opera&&(this.browser.Name="Opera",this.browser.Vendor="Opera Software",/Version\/([\d\.]+)/.test(t),this.browser.Version.versionString=RegExp.$1),this.browser.Firefox=/Gecko\/[\d\.]+ Firefox\/([\d\.]+)/.test(t),this.browser.Firefox&&(this.browser.Name="Firefox",this.browser.Vendor="Mozilla Foundation",this.browser.Version.versionString=RegExp.$1),this.browser.Edge=/Edge\/(.*)/.test(t),this.browser.Edge){var e=/Edge\/(.*)/.exec(t);this.browser.Name="Edge",this.browser.Chrome=!1,this.browser.Vendor="Microsoft",this.browser.Version.versionString=e[1]}if(this.browser.Explorer=/MSIE ([\d\.]+)/.test(t),this.browser.Explorer)this.browser.Name="Internet Explorer",this.browser.Vendor="Microsoft",this.browser.Version.versionString=RegExp.$1;else{var n=/\Mozilla\/5.0 \(([^)]+)\) like Gecko/,i=n.exec(t);if(i){var r=(n=/rv:(.*)/).exec(i[1]);this.browser.Explorer=!0,this.browser.Name="Internet Explorer",this.browser.Vendor="Microsoft",this.browser.Version.versionString=r?r[1]:"unknown"}}this.system.iOS?(this.browser.IsMobileVersion=!0,this.browser.MobileSafari=/Version\/([\d\.]+) Mobile/.test(t),this.browser.MobileSafari&&(this.browser.Name="Mobile Safari",this.browser.Vendor="Apple",this.browser.Version.versionString=RegExp.$1),this.browser.Android=!1):this.system.Android?(this.browser.IsMobileVersion=!0,this.browser.Android=/Version\/([\d\.]+) Mobile/.test(t),this.browser.MobileSafari?(this.browser.Name="Android Browser",this.browser.Vendor="Google",this.browser.Version.versionString=RegExp.$1):(this.browser.Chrome=/Chrome\/([\d\.]+)/.test(t),this.browser.Name="Chrome",this.browser.Vendor="Google",this.browser.Version.versionString=RegExp.$1),this.browser.Safari=!1):this.browser.IsMobileVersion=!1,this.parseBrowserVersion(t)}},{key:"parseBrowserVersion",value:function(t){/([\d]+)\.([\d]+)\.*([\d]*)/.test(this.browser.Version.versionString)&&(this.browser.Version.major=Number(RegExp.$1),this.browser.Version.minor=Number(RegExp.$2),this.browser.Version.revision=RegExp.$3?Number(RegExp.$3):0)}},{key:"parseOSXVersion",value:function(t){var e=/Mac OS X (\d+_\d+_*\d*)/.test(t)?RegExp.$1:"";switch(this.system.Version={},""!=e?/(\d+)_(\d+)_*(\d*)/.test(e)&&(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0):(e=/Mac OS X (\d+\.\d+\.*\d*)/.test(t)?RegExp.$1:"Unknown",/(\d+)\.(\d+)\.*(\d*)/.test(e)&&(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0)),this.system.Version.major||(this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.revision=0),this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision,this.system.Version.minor){case 0:this.system.Version.name="Cheetah";break;case 1:this.system.Version.name="Puma";break;case 2:this.system.Version.name="Jaguar";break;case 3:this.system.Version.name="Panther";break;case 4:this.system.Version.name="Tiger";break;case 5:this.system.Version.name="Leopard";break;case 6:this.system.Version.name="Snow Leopard";break;case 7:this.system.Version.name="Lion";break;case 8:this.system.Version.name="Mountain Lion"}}},{key:"parseWindowsVersion",value:function(t){if(this.system.Version={},/NT (\d+)\.(\d*)/.test(t)){this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=0,this.system.Version.stringValue="NT "+this.system.Version.major+"."+this.system.Version.minor;var e=this.system.Version.major,n=this.system.Version.minor;5==e?this.system.Version.name=0==n?"2000":"XP":6==e&&(0==n?this.system.Version.name="Vista":1==n?this.system.Version.name="7":2==n&&(this.system.Version.name="8"))}else this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.name="Unknown",this.system.Version.stringValue="Unknown"}},{key:"parseLinuxVersion",value:function(t){this.system.Version={},this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.revision=0,this.system.Version.name="",this.system.Version.stringValue="Unknown distribution"}},{key:"parseIOSVersion",value:function(t){this.system.Version={},/iPhone OS (\d+)_(\d+)_*(\d*)/i.test(t)?(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0,this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision,this.system.Version.name="iOS"):(this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.name="Unknown",this.system.Version.stringValue="Unknown")}},{key:"parseAndroidVersion",value:function(t){this.system.Version={},/Android (\d+)\.(\d+)\.*(\d*)/.test(t)?(this.system.Version.major=Number(RegExp.$1),this.system.Version.minor=Number(RegExp.$2),this.system.Version.revision=RegExp.$3?Number(RegExp.$3):0,this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision):(this.system.Version.major=0,this.system.Version.minor=0,this.system.Version.revision=0),/Build\/([a-zA-Z]+)/.test(t)?this.system.Version.name=RegExp.$1:this.system.Version.name="Unknown version",this.system.Version.stringValue=this.system.Version.major+"."+this.system.Version.minor+"."+this.system.Version.revision}},{key:"getInfoString",value:function(){return navigator.userAgent}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"sep",get:function(){return"/"}},{key:"join",value:function(t,e){return t.lastIndexOf(this.sep)!=t.length-1?t+this.sep+e:t+e}},{key:"extension",value:function(t){return t.split(".").pop()}},{key:"fileName",value:function(t){return t.split(this.sep).pop()}},{key:"removeFileName",value:function(t){var e=t.split(this.sep);return e.pop(),e.join(this.sep)}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}window.s_bg_utils_preventImageDump=window.s_bg_utils_preventImageDump||[],window.s_bg_utils_preventVideoDump=window.s_bg_utils_preventVideoDump||[];var l=function(t){window.s_bg_utils_preventImageDump.push(t)},c=function(t){var e=window.s_bg_utils_preventImageDump.indexOf(t);-1!==e&&window.s_bg_utils_preventImageDump.splice(e,1)},f=function(t){window.s_bg_utils_preventVideoDump.push(t)},_=function(t){var e=window.s_bg_utils_preventVideoDump.indexOf(t);-1!==e&&window.s_bg_utils_preventVideoDump.splice(e,1)},m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"getRequest",value:function(t,e,n,i){}},{key:"loadImage",value:function(t,e,n){}},{key:"loadVideo",value:function(t,e,n){}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e){return d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},d(t,e)}function g(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}window.s_bg_utils_videoLoaders=window.s_bg_utils_videoLoaders||{},window.s_bg_utils_videoLoaders.mp4=function(t,e,n){var i=document.createElement("video");f(i),i.crossOrigin="",i.autoplay=!0,i.setAttribute("playsinline",null),i.addEventListener("canplay",(function(t){_(t.target),e(t.target)})),i.addEventListener("error",(function(e){n(new Error("Error loading video: ".concat(t)))})),i.addEventListener("abort",(function(e){n(new Error("Error loading video: ".concat(t)))})),i.src=t},window.s_bg_utils_videoLoaders.m4v=window.s_bg_utils_videoLoaders.mp4;var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(a,t);var e,n,i,r,s,o=(r=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(r);if(s){var n=b(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return g(this,t)});function a(){return v(this,a),o.apply(this,arguments)}return e=a,i=[{key:"AddVideoLoader",value:function(t,e){window.s_bg_utils_videoLoaders[t]=e}},{key:"GetVideoLoaderForType",value:function(t){return window.s_bg_utils_videoLoaders[t]}},{key:"GetCompatibleVideoFormats",value:function(){return Object.keys(window.s_bg_utils_videoLoaders)}},{key:"IsVideoCompatible",value:function(t){var e=Resource.GetExtension(t);return-1!=bg.utils.HTTPResourceProvider.GetCompatibleVideoFormats().indexOf(e)}}],(n=[{key:"getRequest",value:function(t,e,n,i){var r=new XMLHttpRequest;return i||(i=function(t){console.log("Loading ".concat(t.file,": ").concat(t.loaded/t.total*100," %"))}),r.open("GET",t,!0),r.addEventListener("load",(function(){200===r.status?e(r):n(new Error("Error receiving data: ".concat(r.status,", url: ").concat(t)))}),!1),r.addEventListener("error",(function(){n(new Error("Cannot make AJAX request. Url: ".concat(t)))}),!1),r.addEventListener("progress",(function(e){i({file:t,loaded:e.loaded,total:e.total})}),!1),r}},{key:"loadImage",value:function(t,e,n){var i=new Image;l(i),i.crossOrigin="",i.addEventListener("load",(function(t){c(t.target),e(t.target)})),i.addEventListener("error",(function(e){n(new Error("Error loading image: ".concat(t)))})),i.addEventListener("abort",(function(e){n(new Error("Image load aborted: ".concat(t)))})),i.src=t+"?"+bg.utils.generateUUID()}},{key:"loadVideo",value:function(t,e,n){var i=Resource.GetExtension(t),r=bg.utils.HTTPResourceProvider.GetVideoLoaderForType(i);r?r.apply(this,[t,e,n]):n(new Error("Could not find video loader for resource: ".concat(t)))}}])&&y(e.prototype,n),i&&y(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}(m);function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var E=new w,M="bg2e:image-load",S=function(t){var e=new CustomEvent(M,{image:t});document.dispatchEvent(e)},x=function(t){return document.addEventListener(M,t)},O=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"SetResourceProvider",value:function(t){E=t}},{key:"GetResourceProvider",value:function(){return E}},{key:"GetExtension",value:function(t){var e=/\.([a-z0-9-_]*)(\?.*)?(\#.*)?$/i.exec(t);return e&&e[1].toLowerCase()||""}},{key:"JoinUrl",value:function(t,e){return 0==t.length?e:0==e.length?t:/\/$/.test(t)?t+e:t+"/"+e}},{key:"IsFormat",value:function(e,n){return null!=n.find((function(t){return t==this}),t.GetExtension(e))}},{key:"IsImage",value:function(e){return t.IsFormat(e,["jpg","jpeg","gif","png"])}},{key:"IsBinary",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["vwglb","bg2"];return t.IsFormat(e,n)}},{key:"IsVideo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["mp4","m4v","ogg","ogv","m3u8","webm"];return t.IsFormat(e,n)}},{key:"LoadMultiple",value:function(e,n){var i={},r=function(t){i[t.file]=t;var r=0,s=0;for(var o in i){var a=i[o];r+=a.total,s+=a.loaded}n?n({fileList:e,total:r,loaded:s}):console.log("Loading ".concat(Object.keys(i).length," files: ").concat(s/r*100,"% completed"))},s=[];e.forEach((function(e){s.push(t.Load(e,r))}));var o=s.map((function(t){return new Promise((function(e){var n=new Array(2);t.then((function(t){n[0]=t})).catch((function(t){n[1]=t})).then((function(){e(n)}))}))}));return Promise.all(o).then((function(t){var n={};return e.forEach((function(e,i){var r=t[i];n[e]=r[1]?null:r[0]})),n}))}},{key:"Load",value:function(e,n){var i=null;switch(!0){case e.constructor===Array:i=t.LoadMultiple;break;case t.IsImage(e):i=t.LoadImage;break;case t.IsBinary(e):i=t.LoadBinary;break;case t.IsVideo(e):i=t.LoadVideo;break;case"json"==t.GetExtension(e):i=t.LoadJson;break;default:i=t.LoadText}return i(e,n)}},{key:"LoadText",value:function(t,e){return new Promise((function(n,i){E.getRequest(t,(function(t){n(t.responseText)}),(function(t){i(t)}),e).send()}))}},{key:"LoadVideo",value:function(t,e){return new Promise((function(e,n){E.loadVideo(t,(function(t){e(t),S(t)}),(function(t){n(t)}))}))}},{key:"LoadBinary",value:function(t,e){return new Promise((function(n,i){var r=E.getRequest(t,(function(t){n(t.response)}),(function(t){i(t)}),e);r.responseType="arraybuffer",r.send()}))}},{key:"LoadImage",value:function(t){return new Promise((function(e,n){E.loadImage(t,(function(t){e(t),S(t)}),(function(t){n(t)}))}))}},{key:"LoadJson",value:function(t){return new Promise((function(e,n){E.getRequest(t,(function(t){try{e(JSON.parse(t.responseText))}catch(t){n(new Error("Error parsing JSON data"))}}),(function(t){n(t)})).send()}))}}],null&&k(e.prototype,null),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}window.s_bg_utils_Engine=null;var I=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._shaderLibrary={inputs:{},functions:{}}}var e,n,i;return e=t,i=[{key:"Set",value:function(t){window.s_bg_utils_Engine=t}},{key:"Get",value:function(){return window.s_bg_utils_Engine}}],(n=[{key:"id",get:function(){return this._engineId}},{key:"texture",get:function(){return this._texture}},{key:"pipeline",get:function(){return this._pipeline}},{key:"polyList",get:function(){return this._polyList}},{key:"shader",get:function(){return this._shader}},{key:"colorBuffer",get:function(){return this._colorBuffer}},{key:"textureBuffer",get:function(){return this._textureBuffer}},{key:"shaderSource",get:function(){return this._shaderSource}},{key:"cubemapCapture",get:function(){return this._cubemapCapture}},{key:"textureMerger",get:function(){return this._textureMerger}}])&&T(e.prototype,n),i&&T(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var C=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"init",value:function(){}},{key:"frame",value:function(t){}},{key:"displayGizmo",value:function(t,e){}},{key:"willDisplay",value:function(t,e){}},{key:"display",value:function(t,e){}},{key:"didDisplay",value:function(t,e){}},{key:"willUpdate",value:function(t,e,n){}},{key:"draw",value:function(t,e,n,i){}},{key:"didUpdate",value:function(t,e,n){}},{key:"reshape",value:function(t,e,n,i){}},{key:"keyDown",value:function(t){}},{key:"keyUp",value:function(t){}},{key:"mouseUp",value:function(t){}},{key:"mouseDown",value:function(t){}},{key:"mouseMove",value:function(t){}},{key:"mouseOut",value:function(t){}},{key:"mouseDrag",value:function(t){}},{key:"mouseWheel",value:function(t){}},{key:"touchStart",value:function(t){}},{key:"touchMove",value:function(t){}},{key:"touchEnd",value:function(t){}},{key:"postRedisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;bg.app.MainLoop.singleton.postRedisplay(t)}},{key:"postReshape",value:function(){bg.app.MainLoop.singleton.postReshape()}}],n&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();!function(t){function e(t){var e,i;if(m=!1,p=v=(t+="").length,v>63){for(n(t.substring(0,64)),r(h),m=!0,e=128;v>=e;e+=64)n(t.substring(e-64,e)),s(h);t=t.substring(e-64),v=t.length}for(u[0]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0,e=0;v>e;e++)0==(i=3&e)?u[e>>2]=t.charCodeAt(e):u[e>>2]|=t.charCodeAt(e)<<f[i];return u[e>>2]|=l[3&e],e>55?(m?s(u):(r(u),m=!0),s([0,0,0,0,0,0,0,0,0,0,0,0,0,0,p<<3,0])):(u[14]=p<<3,void(m?s(u):r(u)))}function n(t){for(var e=16;e--;){var n=e<<2;h[e]=t.charCodeAt(n)+(t.charCodeAt(n+1)<<8)+(t.charCodeAt(n+2)<<16)+(t.charCodeAt(n+3)<<24)}}function i(t,e,n,i,r,s,o){return((e+=t+i+o)<<r|e>>>s)+n<<0}function r(t){o(0,0,0,0,t),_[0]=y[0]+1732584193<<0,_[1]=y[1]-271733879<<0,_[2]=y[2]-1732584194<<0,_[3]=y[3]+271733878<<0}function s(t){o(_[0],_[1],_[2],_[3],t),_[0]=y[0]+_[0]<<0,_[1]=y[1]+_[1]<<0,_[2]=y[2]+_[2]<<0,_[3]=y[3]+_[3]<<0}function o(t,e,n,r,s){var o,a;m?(t=i((n^r)&e^r,t,e,s[0],7,25,-680876936),r=i((e^n)&t^n,r,t,s[1],12,20,-389564586),n=i((t^e)&r^e,n,r,s[2],17,15,606105819),e=i((r^t)&n^t,e,n,s[3],22,10,-1044525330)):(t=((t=s[0]-680876937)<<7|t>>>25)-271733879<<0,r=((r=s[1]-117830708+(2004318071&t^-1732584194))<<12|r>>>20)+t<<0,n=((n=s[2]-1126478375+((-271733879^t)&r^-271733879))<<17|n>>>15)+r<<0,e=((e=s[3]-1316259209+((r^t)&n^t))<<22|e>>>10)+n<<0),t=i((n^r)&e^r,t,e,s[4],7,25,-176418897),r=i((e^n)&t^n,r,t,s[5],12,20,1200080426),n=i((t^e)&r^e,n,r,s[6],17,15,-1473231341),e=i((r^t)&n^t,e,n,s[7],22,10,-45705983),t=i((n^r)&e^r,t,e,s[8],7,25,1770035416),r=i((e^n)&t^n,r,t,s[9],12,20,-1958414417),n=i((t^e)&r^e,n,r,s[10],17,15,-42063),e=i((r^t)&n^t,e,n,s[11],22,10,-1990404162),t=i((n^r)&e^r,t,e,s[12],7,25,1804603682),r=i((e^n)&t^n,r,t,s[13],12,20,-40341101),n=i((t^e)&r^e,n,r,s[14],17,15,-1502002290),e=i((r^t)&n^t,e,n,s[15],22,10,1236535329),t=i((e^n)&r^n,t,e,s[1],5,27,-165796510),r=i((t^e)&n^e,r,t,s[6],9,23,-1069501632),n=i((r^t)&e^t,n,r,s[11],14,18,643717713),e=i((n^r)&t^r,e,n,s[0],20,12,-373897302),t=i((e^n)&r^n,t,e,s[5],5,27,-701558691),r=i((t^e)&n^e,r,t,s[10],9,23,38016083),n=i((r^t)&e^t,n,r,s[15],14,18,-660478335),e=i((n^r)&t^r,e,n,s[4],20,12,-405537848),t=i((e^n)&r^n,t,e,s[9],5,27,568446438),r=i((t^e)&n^e,r,t,s[14],9,23,-1019803690),n=i((r^t)&e^t,n,r,s[3],14,18,-187363961),e=i((n^r)&t^r,e,n,s[8],20,12,1163531501),t=i((e^n)&r^n,t,e,s[13],5,27,-1444681467),r=i((t^e)&n^e,r,t,s[2],9,23,-51403784),n=i((r^t)&e^t,n,r,s[7],14,18,1735328473),e=i((n^r)&t^r,e,n,s[12],20,12,-1926607734),t=i((o=e^n)^r,t,e,s[5],4,28,-378558),r=i(o^t,r,t,s[8],11,21,-2022574463),n=i((a=r^t)^e,n,r,s[11],16,16,1839030562),e=i(a^n,e,n,s[14],23,9,-35309556),t=i((o=e^n)^r,t,e,s[1],4,28,-1530992060),r=i(o^t,r,t,s[4],11,21,1272893353),n=i((a=r^t)^e,n,r,s[7],16,16,-155497632),e=i(a^n,e,n,s[10],23,9,-1094730640),t=i((o=e^n)^r,t,e,s[13],4,28,681279174),r=i(o^t,r,t,s[0],11,21,-358537222),n=i((a=r^t)^e,n,r,s[3],16,16,-722521979),e=i(a^n,e,n,s[6],23,9,76029189),t=i((o=e^n)^r,t,e,s[9],4,28,-640364487),r=i(o^t,r,t,s[12],11,21,-421815835),n=i((a=r^t)^e,n,r,s[15],16,16,530742520),e=i(a^n,e,n,s[2],23,9,-995338651),t=i(n^(e|~r),t,e,s[0],6,26,-198630844),r=i(e^(t|~n),r,t,s[7],10,22,1126891415),n=i(t^(r|~e),n,r,s[14],15,17,-1416354905),e=i(r^(n|~t),e,n,s[5],21,11,-57434055),t=i(n^(e|~r),t,e,s[12],6,26,1700485571),r=i(e^(t|~n),r,t,s[3],10,22,-1894986606),n=i(t^(r|~e),n,r,s[10],15,17,-1051523),e=i(r^(n|~t),e,n,s[1],21,11,-2054922799),t=i(n^(e|~r),t,e,s[8],6,26,1873313359),r=i(e^(t|~n),r,t,s[15],10,22,-30611744),n=i(t^(r|~e),n,r,s[6],15,17,-1560198380),e=i(r^(n|~t),e,n,s[13],21,11,1309151649),t=i(n^(e|~r),t,e,s[4],6,26,-145523070),r=i(e^(t|~n),r,t,s[11],10,22,-1120210379),n=i(t^(r|~e),n,r,s[2],15,17,718787259),e=i(r^(n|~t),e,n,s[9],21,11,-343485551),y[0]=t,y[1]=e,y[2]=n,y[3]=r}var a=[],u=[],h=[],l=[],c="0123456789abcdef".split(""),f=[],_=[],m=!1,p=0,v=0,y=[];if(t.Int32Array)u=new Int32Array(16),h=new Int32Array(16),l=new Int32Array(4),f=new Int32Array(4),_=new Int32Array(4),y=new Int32Array(4);else{var d;for(d=0;16>d;d++)u[d]=h[d]=0;for(d=0;4>d;d++)l[d]=f[d]=_[d]=y[d]=0}l[0]=128,l[1]=32768,l[2]=8388608,l[3]=-2147483648,f[0]=0,f[1]=8,f[2]=16,f[3]=24,t.md5=t.md5||function(t,n,i){e(n?t:function(t){for(var e="",n="",i=0,r=0,s=0,o=t.length;o>s;s++){var a=t.charCodeAt(s);128>a?r++:(n=2048>a?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),r>i&&(e+=t.slice(i,r)),e+=n,i=r=s+1)}return r>i&&(e+=t.slice(i,o)),e}(t));var r=_[0];return a[1]=c[15&r],a[0]=c[15&(r>>=4)],a[3]=c[15&(r>>=4)],a[2]=c[15&(r>>=4)],a[5]=c[15&(r>>=4)],a[4]=c[15&(r>>=4)],a[7]=c[15&(r>>=4)],a[6]=c[15&(r>>=4)],r=_[1],a[9]=c[15&r],a[8]=c[15&(r>>=4)],a[11]=c[15&(r>>=4)],a[10]=c[15&(r>>=4)],a[13]=c[15&(r>>=4)],a[12]=c[15&(r>>=4)],a[15]=c[15&(r>>=4)],a[14]=c[15&(r>>=4)],r=_[2],a[17]=c[15&r],a[16]=c[15&(r>>=4)],a[19]=c[15&(r>>=4)],a[18]=c[15&(r>>=4)],a[21]=c[15&(r>>=4)],a[20]=c[15&(r>>=4)],a[23]=c[15&(r>>=4)],a[22]=c[15&(r>>=4)],r=_[3],a[25]=c[15&r],a[24]=c[15&(r>>=4)],a[27]=c[15&(r>>=4)],a[26]=c[15&(r>>=4)],a[29]=c[15&(r>>=4)],a[28]=c[15&(r>>=4)],a[31]=c[15&(r>>=4)],a[30]=c[15&(r>>=4)],i?a:a.join("")}}(void 0===n.g?window:n.g);const R=md5;var N=n(9),P={version:"2.0.0",setupRequestAnimFrame:i,initWebGLContext:r,isBigEndian:function(){var t=new Uint32Array(1);return new Uint8Array(t.buffer),t[0]=255,255==t[3]},isLittleEndian:function(){var t=new Uint32Array(1);return new Uint8Array(t.buffer),t[0]=255,255==t[0]},UserAgent:o,userAgent:new o,Path:u,path:new u,ResourceProvider:m,beginImageLoad:l,endImageLoad:c,beginVideoLoad:f,endVideoLoad:_,HTTPResourceProvider:w,Resource:O,IMG_LOAD_EVENT_NAME:M,emitImageLoadEvent:S,bindImageLoadEvent:x,requireGlobal:function(t){var e=document.createElement("script");e.src=t,e.type="text/javascript",e.async=!1,document.getElementsByTagName("head")[0].appendChild(e)},Engine:I,LifeCycle:C,md5:R,generateUUID:function(){var t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))},electron:new N.Z};const L=P;function V(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var F=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._domElem=e,this._domElem.style.MozUserSelect="none",this._domElem.style.WebkitUserSelect="none",this._domElem.setAttribute("onselectstart","return false"),this._multisample=1,this._context=r(e),!this._context.supported)throw new Error("Sorry, your browser does not support WebGL.")}var e,n;return e=t,(n=[{key:"multisample",get:function(){return this._multisample},set:function(t){this._multisample=t}},{key:"context",get:function(){return this._context}},{key:"domElement",get:function(){return this._domElem}},{key:"width",get:function(){return this._domElem.clientWidth}},{key:"height",get:function(){return this._domElem.clientHeight}},{key:"screenshot",value:function(t,e,n){var i="",r={};e&&(n=n||e,i=this.domElement.style.cssText,r.width=this.domElement.width,r.height=this.domElement.height,this.domElement.style.cssText="top:auto;left:auto;bottom:auto;right:auto;width:"+e+"px;height:"+n+"px;",this.domElement.width=e,this.domElement.height=n);var s=this.domElement.toDataURL(t);return e&&(this.domElement.style.cssText=i,this.domElement.width=r.width,this.domElement.height=r.height),s}}])&&V(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function j(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._context=e}var e,n;return e=t,(n=[{key:"context",get:function(){return this._context},set:function(t){this._context=t}}])&&j(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var D,U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._executeDefault=!1}var e,n;return e=t,(n=[{key:"executeDefault",get:function(){return this._executeDefault},set:function(t){this._executeDefault=t}}])&&B(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function z(t,e){return z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},z(t,e)}function W(t,e){if(e&&("object"===X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}function K(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $=(K(D={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",SHIFT:"Shift",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CTRL:"Control",CTRL_LEFT:"ControlLeft"},"CTRL_LEFT","ControlRight"),K(D,"ALT","Alt"),K(D,"ALT_LEFT","AltLeft"),K(D,"ALT_RIGHT","AltRight"),K(D,"PAUSE","Pause"),K(D,"CAPS_LOCK","CapsLock"),K(D,"ESCAPE","Escape"),K(D,"PAGE_UP","PageUp"),K(D,"PAGEDOWN","PageDown"),K(D,"END","End"),K(D,"HOME","Home"),K(D,"LEFT_ARROW","ArrowLeft"),K(D,"UP_ARROW","ArrowUp"),K(D,"RIGHT_ARROW","ArrowRight"),K(D,"DOWN_ARROW","ArrowDown"),K(D,"INSERT","Insert"),K(D,"DELETE","Delete"),D),q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z(t,e)}(a,t);var e,n,i,r,s,o=(r=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Y(r);if(s){var n=Y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return W(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this)).key=t,n.event=e,n}return e=a,i=[{key:"IsSpecialKey",value:function(t){return null!=$[t.code]}}],(n=[{key:"isSpecialKey",value:function(){return a.IsSpecialKey(this.event)}}])&&H(e.prototype,n),i&&H(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}(U);function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){return Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Q(t,e)}function tt(t,e){if(e&&("object"===Z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function et(t){return et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},et(t)}var nt={LEFT:0,MIDDLE:1,RIGHT:2,NONE:-1},it=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}(s,t);var e,n,i,r=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=et(n);if(i){var r=et(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return tt(this,t)});function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt.NONE,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return J(this,s),(t=r.call(this)).button=e,t.x=n,t.y=i,t.delta=o,t.event=a,t}return e=s,Object.defineProperty(e,"prototype",{writable:!1}),e}(U);function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function st(t,e){return st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},st(t,e)}function ot(t,e){if(e&&("object"===rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function at(t){return at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},at(t)}var ut=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&st(t,e)}(s,t);var e,n,i,r=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=at(n);if(i){var r=at(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ot(this,t)});function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(n=r.call(this)).touches=t,n.event=e,n}return e=s,Object.defineProperty(e,"prototype",{writable:!1}),e}(U);function ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}window.s_bg_app_mouseStatus={leftButton:!1,middleButton:!1,rightButton:!1,pos:{x:-1,y:-1}},Object.defineProperty(s_bg_app_mouseStatus,"anyButton",{get:function(){return this.leftButton||this.middleButton||this.rightButton}});var lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,n=[{key:"LeftButton",value:function(){return s_bg_app_mouseStatus.leftButton}},{key:"MiddleButton",value:function(){return s_bg_app_mouseStatus.middleButton}},{key:"RightButton",value:function(){return s_bg_app_mouseStatus.rightButton}},{key:"Position",value:function(){return s_bg_app_mouseStatus.pos}},{key:"AnyButton",value:function(){return s_bg_app_mouseStatus.anyButton}},{key:"SetLeftButton",value:function(t){return s_bg_app_mouseStatus.leftButton=t,s_bg_app_mouseStatus.leftButton}},{key:"SetMiddleButton",value:function(t){return s_bg_app_mouseStatus.middleButton=t,s_bg_app_mouseStatus.middleButton}},{key:"SetRightButton",value:function(t){return s_bg_app_mouseStatus.rightButton=t,s_bg_app_mouseStatus.rightButton}},{key:"SetPosition",value:function(t,e){return s_bg_app_mouseStatus.pos={x:t,y:e},s_bg_app_mouseStatus.pos}}],null&&ht(e.prototype,null),n&&ht(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}window.s_bg_app_mainLoop=null;var ft=0;function _t(t){t=t||0,window.requestAnimFrame||i(),requestAnimFrame(_t);var e,n=t-ft;ft=t,e=n,s_bg_app_mainLoop.redisplay&&(s_bg_app_mainLoop.windowController.frame(e),0==s_bg_app_mainLoop.updateMode?s_bg_app_mainLoop._redisplayFrames=1:s_bg_app_mainLoop._redisplayFrames--,s_bg_app_mainLoop.windowController.display())}function mt(){if(s_bg_app_mainLoop.canvas&&s_bg_app_mainLoop.windowController){var t=s_bg_app_mainLoop.canvas.multisample;s_bg_app_mainLoop.canvas.domElement.width=s_bg_app_mainLoop.canvas.width*t,s_bg_app_mainLoop.canvas.domElement.height=s_bg_app_mainLoop.canvas.height*t,s_bg_app_mainLoop.windowController.reshape(s_bg_app_mainLoop.canvas.width*t,s_bg_app_mainLoop.canvas.height*t)}}function pt(t){var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=s_bg_app_mainLoop.canvas.multisample,i=lt.SetPosition((t.clientX-e.left)*n,(t.clientY-e.top)*multisampl),r=new it(nt.NONE,i.x,i.y,0,t);return s_bg_app_mainLoop.windowController.mouseMove(r),lt.AnyButton()&&s_bg_app_mainLoop.windowController.mouseDrag(r),r}function vt(t){for(var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=[],i=0;i<t.touches.length;++i){var r=t.touches[i];n.push({identifier:r.identifier,x:r.clientX-e.left,y:r.clientY-e.top,force:r.force,rotationAngle:r.rotationAngle,radiusX:r.radiusX,radiusY:r.radiusY})}return new ut(n,t)}var yt=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._canvas=null,this._windowController=null,this._updateMode=0,this._redisplayFrames=1,x((function(){e.postRedisplay()}))}var e,n;return e=t,n=[{key:"canvas",get:function(){return this._canvas},set:function(t){this._canvas=new F(t)}},{key:"windowController",get:function(){return this._windowController}},{key:"updateMode",get:function(){return this._updateMode},set:function(t){this._updateMode=t,0==this._updateMode&&(this._redisplayFrames=1)}},{key:"redisplay",get:function(){return this._redisplayFrames>0}},{key:"mouseButtonStatus",get:function(){return s_mouseStatus}},{key:"run",value:function(t){this._windowController=t,this.postRedisplay(),this.windowController.init(),function(){if(mt(),window.addEventListener("resize",(function(){mt()})),!s_bg_app_mainLoop.canvas)throw new Error("Configuration error in MainLoop: no canvas defined");var t=s_bg_app_mainLoop.canvas.domElement;t.addEventListener("mousedown",(function(t){if(!function(t){var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=s_bg_app_mainLoop.canvas.multisample,i=lt.Position();switch(i.x=(t.clientX-e.left)*n,i.y=(t.clientY-e.top)*n,t.button){case nt.LEFT:lt.SetLeftButton(!0);break;case nt.MIDDLE:lt.SetMiddleButton(!0);break;case nt.RIGHT:lt.SetRightButton(!0)}var r=new it(t.button,i.x,i.y,0,t);return s_bg_app_mainLoop.windowController.mouseDown(r),r}(t).executeDefault)return t.preventDefault(),!1})),t.addEventListener("mousemove",(function(t){if(!pt(t).executeDefault)return t.preventDefault(),!1})),t.addEventListener("mouseout",(function(t){if(!(e=lt.Position(),n=new it(nt.NONE,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseOut(n),lt.LeftButton()&&(lt.SetLeftButton(!1),n=new it(nt.LEFT,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseUp(n)),lt.MiddleButton()&&(lt.SetMiddleButton(!1),n=new it(nt.MIDDLE,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseUp(n)),lt.RightButton()&&(lt.SetRightButton(!1),n=new it(nt.RIGHT,e.x,e.y,0,{}),s_bg_app_mainLoop.windowController.mouseUp(n)),n).executeDefault)return t.preventDefault(),!1;var e,n})),t.addEventListener("mouseover",(function(t){if(!(e=t,pt(e)).executeDefault)return t.preventDefault(),!1;var e})),t.addEventListener("mouseup",(function(t){if(!function(t){switch(t.button){case nt.LEFT:lt.SetLeftButton(!1);break;case nt.MIDDLE:lt.SetMiddleButton(!1);break;case nt.RIGHT:lt.SetRightButton(!1)}var e=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),n=s_bg_app_mainLoop.canvas.multisample,i=lt.SetPosition((t.clientX-e.left)*n,(t.clientY-e.top)*n),r=new it(t.button,i.x,i.y,0,t);return s_bg_app_mainLoop.windowController.mouseUp(r),r}(t).executeDefault)return t.preventDefault(),!1})),t.addEventListener("touchstart",(function(t){if(!(e=t,n=vt(e),s_bg_app_mainLoop.windowController.touchStart(n),n).executeDefault)return t.preventDefault(),!1;var e,n})),t.addEventListener("touchmove",(function(t){if(!(e=t,n=vt(e),s_bg_app_mainLoop.windowController.touchMove(n),n).executeDefault)return t.preventDefault(),!1;var e,n})),t.addEventListener("touchend",(function(t){if(!(e=t,n=vt(e),s_bg_app_mainLoop.windowController.touchEnd(n),n).executeDefault)return t.preventDefault(),!1;var e,n}));var e=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";t.addEventListener(e,(function(t){if(!(e=t,n=s_bg_app_mainLoop.canvas.domElement.getBoundingClientRect(),i=s_bg_app_mainLoop.canvas.multisample,r=lt.SetPosition((e.clientX-n.left)*i,(e.clientY-n.top)*i),s=e.wheelDelta?-1*e.wheelDelta:10*e.detail,o=new it(nt.NONE,r.x,r.y,s,e),s_bg_app_mainLoop.windowController.mouseWheel(o),o).executeDefault)return t.preventDefault(),!1;var e,n,i,r,s,o})),window.addEventListener("keydown",(function(t){var e,n;e=t,n=q.IsSpecialKey(e)?e.keyCode:e.code,s_bg_app_mainLoop.windowController.keyDown(new q(n,e))})),window.addEventListener("keyup",(function(t){var e,n;e=t,n=q.IsSpecialKey(e)?e.keyCode:e.code,s_bg_app_mainLoop.windowController.keyUp(new q(n,e))})),t.oncontextmenu=function(t){return!1}}(),_t()}},{key:"postRedisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this._redisplayFrames=t}},{key:"postReshape",value:function(){mt()}}],n&&ct(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function wt(t,e){return wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},wt(t,e)}function kt(t,e){if(e&&("object"===dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}Object.defineProperty(yt,"singleton",{get:function(){return s_bg_app_mainLoop||(s_bg_app_mainLoop=new yt),s_bg_app_mainLoop}});var Mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wt(t,e)}(o,t);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Et(i);if(r){var n=Et(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return kt(this,t)});function o(){return gt(this,o),s.apply(this,arguments)}return e=o,n=[{key:"postRedisplay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;yt.singleton.postRedisplay(t)}},{key:"postReshape",value:function(){yt.singleton.postReshape()}},{key:"canvas",get:function(){return yt.singleton.canvas}},{key:"context",get:function(){return yt.singleton.canvas.context}},{key:"gl",get:function(){return yt.singleton.canvas.context.gl}}],n&&bt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(C);const St={Canvas:F,ContextObject:G,EventBase:U,SpecialKey:$,KeyboardEvent:q,MouseEvent:it,MouseButton:nt,TouchEvent:ut,Mouse:lt,MainLoop:yt,WindowController:Mt};function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function Ot(t,e){return Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ot(t,e)}function Tt(t,e){if(e&&("object"===xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function It(t){return It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},It(t)}function At(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ct={VERTEX:null,FRAGMENT:null};window.s_bg_base_activeShader=null;var Rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}(a,t);var e,n,i,r,s,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=It(e);if(n){var r=It(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return Tt(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t))._shader=I.Get().shader.create(t),e._linked=!1,e._compileError=null,e._linkError=null,e}return i=a,r=[{key:"shader",get:function(){return this._shader}},{key:"compileError",get:function(){return this._compileError}},{key:"compileErrorSource",get:function(){return this._compileErrorSource}},{key:"linkError",get:function(){return this._linkError}},{key:"status",get:function(){return null==this._compileError&&null==this._linkError}},{key:"addShaderSource",value:function(t,e){var n;return this._linked?this._compileError="Tying to attach a shader to a linked program":this._compileError||(this._compileError=I.Get().shader.addShaderSource(this.context,this._shader,t,e),this._compileError&&(this._compileErrorSource=(n="",e.split("\n").forEach((function(t,e){++e,n+=(e<10?"00":e<100?"0":"")+e+" | "+t+"\n"})),n))),null==this._compileError}},{key:"link",value:function(){return this._linkError=null,this._linked?this._linkError="Shader already linked":(this._linkError=I.Get().shader.link(this.context,this._shader),this._linked=null==this._linkError),this._linked}},{key:"setActive",value:function(){I.Get().shader.setActive(this.context,this._shader),g_window.s_bg_base_activeShader=this}},{key:"clearActive",value:function(){a.ClearActive(this.context),g_window.s_bg_base_activeShader=null}},{key:"initVars",value:function(t,e){I.Get().shader.initVars(this.context,this._shader,t,e)}},{key:"setInputBuffer",value:function(t,e,n){I.Get().shader.setInputBuffer(this.context,this._shader,t,e,n)}},{key:"disableInputBuffer",value:function(t){I.Get().shader.disableInputBuffer(this.context,this._shader,t)}},{key:"setValueInt",value:function(t,e){I.Get().shader.setValueInt(this.context,this._shader,t,e)}},{key:"setValueIntPtr",value:function(t,e){I.Get().shader.setValueIntPtr(this.context,this._shader,t,e)}},{key:"setValueFloat",value:function(t,e){I.Get().shader.setValueFloat(this.context,this._shader,t,e)}},{key:"setValueFloatPtr",value:function(t,e){I.Get().shader.setValueFloatPtr(this.context,this._shader,t,e)}},{key:"setVector2",value:function(t,e){I.Get().shader.setValueVector2(this.context,this._shader,t,e)}},{key:"setVector3",value:function(t,e){I.Get().shader.setValueVector3(this.context,this._shader,t,e)}},{key:"setVector4",value:function(t,e){I.Get().shader.setValueVector4(this.context,this._shader,t,e)}},{key:"setVector2Ptr",value:function(t,e){I.Get().shader.setValueVector2v(this.context,this._shader,t,e)}},{key:"setVector3Ptr",value:function(t,e){I.Get().shader.setValueVector3v(this.context,this._shader,t,e)}},{key:"setVector4Ptr",value:function(t,e){I.Get().shader.setValueVector4v(this.context,this._shader,t,e)}},{key:"setMatrix3",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];I.Get().shader.setValueMatrix3(this.context,this._shader,t,n,e)}},{key:"setMatrix4",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];I.Get().shader.setValueMatrix4(this.context,this._shader,t,n,e)}},{key:"setTexture",value:function(t,e,n){I.Get().shader.setTexture(this.context,this._shader,t,e,n)}},{key:"destroy",value:function(){console.warn("TODO: Shader.destroy(): not implemented.")}}],s=[{key:"ClearActive",value:function(t){I.Get().shader.setActive(t,null)}},{key:"GetActiveShader",value:function(){return window.s_bg_base_activeShader}}],r&&At(i.prototype,r),s&&At(i,s),Object.defineProperty(i,"prototype",{writable:!1}),a}(G);function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Lt(t,e){return Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Lt(t,e)}function Vt(t,e){if(e&&("object"===Nt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}var jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}(o,t);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ft(i);if(r){var n=Ft(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Vt(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=s.call(this,t))._shader=null,e._inputVars=[],e._shaders=[],e}return e=o,n=[{key:"inputVars",get:function(){return this._inputVars}},{key:"numberOfShaders",get:function(){return this._shaders.length}},{key:"setCurrentShader",value:function(t){this._shader=this._shaders[t]}},{key:"shader",get:function(){return this._shader}},{key:"setupShaderSource",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n?this._shaders.length:0,r=new Rt(this.context);this._inputVars=[];var s=[],o=[];return t.forEach((function(t){t.params.forEach((function(t){t&&("buffer"==t.role?(e._inputVars[t.target]=t.name,s.push(t.name)):"value"==t.role&&o.push(t.name))})),r.addShaderSource(t.type,t.toString())})),r.link(),r.status?r.initVars(s,o):(console.error(r.compileError),r.compileErrorSource&&(console.error("Shader source:"),console.error(r.compileErrorSource)),console.error(r.linkError)),n?(this._shaders.push(r),this._shader||(this._shader=r)):(this._shaders=[r],this._shader=r),i}},{key:"beginDraw",value:function(){}},{key:"setupVars",value:function(){}},{key:"setActive",value:function(){this.shader.setActive(),this.beginDraw()}},{key:"clearActive",value:function(){this.shader.clearActive()}},{key:"bindPolyList",value:function(t){var e=this.shader;this.inputVars.vertex&&e.setInputBuffer(this.inputVars.vertex,t.vertexBuffer,3),this.inputVars.normal&&e.setInputBuffer(this.inputVars.normal,t.normalBuffer,3),this.inputVars.tex0&&e.setInputBuffer(this.inputVars.tex0,t.texCoord0Buffer,2),this.inputVars.tex1&&e.setInputBuffer(this.inputVars.tex1,t.texCoord1Buffer,2),this.inputVars.tex2&&e.setInputBuffer(this.inputVars.tex2,t.texCoord2Buffer,2),this.inputVars.color&&e.setInputBuffer(this.inputVars.color,t.colorBuffer,4),this.inputVars.tangent&&e.setInputBuffer(this.inputVars.tangent,t.tangentBuffer,3),this.setupVars()}},{key:"unbind",value:function(){var t=this.shader;this.inputVars.vertex&&t.disableInputBuffer(this.inputVars.vertex),this.inputVars.normal&&t.disableInputBuffer(this.inputVars.normal),this.inputVars.tex0&&t.disableInputBuffer(this.inputVars.tex0),this.inputVars.tex1&&t.disableInputBuffer(this.inputVars.tex1),this.inputVars.tex2&&t.disableInputBuffer(this.inputVars.tex2),this.inputVars.color&&t.disableInputBuffer(this.inputVars.color),this.inputVars.tangent&&t.disableInputBuffer(this.inputVars.tangent)}}],n&&Pt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(G);function Gt(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function Bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ut(t,e,n){return e&&Dt(t.prototype,e),n&&Dt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Xt=function(){function t(){Bt(this,t)}var e,n;return Ut(t,[{key:"acceptType",value:function(t,e){return!1}},{key:"load",value:(e=regeneratorRuntime.mark((function t(e,n,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Error("Not implemented"));case 1:case"end":return t.stop()}}),t)})),n=function(){var t=this,n=arguments;return new Promise((function(i,r){var s=e.apply(t,n);function o(t){Gt(s,i,r,o,a,"next",t)}function a(t){Gt(s,i,r,o,a,"throw",t)}o(void 0)}))},function(t,e,i){return n.apply(this,arguments)})}]),t}();function Ht(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(r,s){O.Load(e,n).then((function(n){return Yt.LoadData(t,e,n,i)})).then((function(t,e){r(t,e)})).catch((function(t){s(t)}))}))}function zt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(r,s){O.LoadMultiple(e,n).then((function(e){var n=[];for(var r in e){var s=e[r];n.push(Wt(t,r,s,i))}return Promise.all(n)})).then((function(t){var n={};e.forEach((function(e,i){n[e]=t[i]})),r(n)})).catch((function(t){s(t)}))}))}function Wt(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(r,s){var o=null;if(s_loaderPlugins.some((function(t){if(t.acceptType(e,n))return o=t,!0})),!o)return s(new Error("No suitable plugin found for load "+e));i||(i={}),r(o.load(t,e,n,i))}))}window.s_bg_base_loaderPlugins=window.s_bg_base_loaderPlugins||[];var Yt=function(){function t(){Bt(this,t)}return Ut(t,null,[{key:"RegisterPlugin",value:function(t){window.s_bg_base_loaderPlugins.push(t)}},{key:"Load",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Array.isArray(e)?zt(t,e,n,i):Ht(t,e,n,i)}},{key:"LoadData",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Wt(t,e,n,i)}}]),t}(),Kt={NONE:0,X:1,Y:2,Z:3,name:function(t){switch(t){case Kt.NONE:return"NONE";case Kt.X:return"X";case Kt.Y:return"Y";case Kt.Z:return"Z";case Kt.W:return"W";default:return"UNKNOWN"}}},$t=3.141592653589793,qt=.01745329251994,Zt=57.29577951308233,Jt=1e-7,Qt=Float32Array,te=Array;function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function ne(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ie(t,e)}function ie(t,e){return ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ie(t,e)}function re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=oe(t);if(e){var r=oe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return se(this,n)}}function se(t,e){if(e&&("object"===ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oe(t){return oe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},oe(t)}function ae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ue(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function he(t,e,n){return e&&ue(t.prototype,e),n&&ue(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var le=function(){function t(e){ae(this,t),this._v=e}return he(t,[{key:"v",get:function(){return this._v}},{key:"length",get:function(){return this._v.length}},{key:"x",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"y",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"module",get:function(){return this.magnitude()}},{key:"toArray",value:function(){for(var t=[],e=0;e<this.v.length;++e)t.push(this.v[e]);return t}}],[{key:"MinComponents",value:function(t,e){var n=Math.min(t.length,e.length),i=null;switch(n){case 2:i=new ce;break;case 3:i=new fe;break;case 4:i=new _e}for(var r=0;r<n;++r)i._v[r]=t._v[r]<e._v[r]?t._v[r]:e._v[r];return i}},{key:"MaxComponents",value:function(t,e){var n=Math.min(t.length,e.length),i=null;switch(n){case 2:i=new ce;break;case 3:i=new fe;break;case 4:i=new _e}for(var r=0;r<n;++r)i._v[r]=t._v[r]>e._v[r]?t._v[r]:e._v[r];return i}}]),t}(),ce=function(t){ne(n,t);var e=re(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return ae(this,n),t=e.call(this,new te(2)),i instanceof n?(t._v[0]=i._v[0],t._v[1]=i._v[1]):Array.isArray(i)&&i.length>=2?(t._v[0]=i[0],t._v[1]=i[1]):(void 0===r&&(r=i),t._v[0]=i,t._v[1]=r),t}return he(n,[{key:"distance",value:function(t){return new n(this._v[0]-t._v[0],this._v[1]-t._v[1]).magnitude()}},{key:"normalize",value:function(){var t=this.magnitude();return this._v[0]=this._v[0]/t,this._v[1]=this._v[1]/t,this}},{key:"add",value:function(t){return this._v[0]+=t._v[0],this._v[1]+=t._v[1],this}},{key:"sub",value:function(t){return this._v[0]-=t._v[0],this._v[1]-=t._v[1],this}},{key:"dot",value:function(t){return this._v[0]*t._v[0]+this._v[1]*t._v[1]}},{key:"scale",value:function(t){return this._v[0]*=t,this._v[1]*=t,this}},{key:"magnitude",value:function(){return Math.sqrt(this._v[0]*this._v[0]+this._v[1]*this._v[1])}},{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1]}},{key:"set",value:function(t,e){void 0===e&&(e=t),this._v[0]=t,this._v[1]=e}},{key:"width",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"height",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"aspectRatio",get:function(){return this._v[0]/this._v[1]}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])}},{key:"toString",value:function(){return"["+this._v+"]"}}],[{key:"Add",value:function(t,e){return new n(t.x+e.x,t.y+e.y)}},{key:"Sub",value:function(t,e){return new n(t.x-e.x,t.y-e.y)}},{key:"Distance",value:function(t,e){return new n(t._v[0]-e._v[0],t._v[1]-e._v[1]).magnitude()}},{key:"Dot",value:function(t,e){return t._v[0]*e._v[0]+t._v[1]*e._v[1]}},{key:"Cross",value:function(t,e){var n=t._v[1]*e._v[2]-t._v[2]*e._v[1],i=t._v[2]*e._v[0]-t._v[0]*e._v[2],r=t._v[0]*e._v[1]-t._v[1]*e._v[0];return new fe(n,i,r)}}]),n}(le),fe=function(t){ne(n,t);var e=re(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ae(this,n),t=e.call(this,new te(3)),i instanceof ce?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=r):i instanceof n?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=i._v[2]):Array.isArray(i)&&i.length>=3?(t._v[0]=i[0],t._v[1]=i[1],t._v[2]=i[2]):(void 0===r&&(r=i),void 0===s&&(s=r),t._v[0]=i,t._v[1]=r,t._v[2]=s),t}return he(n,[{key:"z",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"magnitude",value:function(){return Math.sqrt(this._v[0]*this._v[0]+this._v[1]*this._v[1]+this._v[2]*this._v[2])}},{key:"normalize",value:function(){var t=this.magnitude();return this._v[0]=this._v[0]/t,this._v[1]=this._v[1]/t,this._v[2]=this._v[2]/t,this}},{key:"distance",value:function(t){return new n(this._v[0]-t._v[0],this._v[1]-t._v[1],this._v[2]-t._v[2]).magnitude()}},{key:"add",value:function(t){return this._v[0]+=t._v[0],this._v[1]+=t._v[1],this._v[2]+=t._v[2],this}},{key:"sub",value:function(t){return this._v[0]-=t._v[0],this._v[1]-=t._v[1],this._v[2]-=t._v[2],this}},{key:"dot",value:function(t){return this._v[0]*t._v[0]+this._v[1]*t._v[1]+this._v[2]*t._v[2]}},{key:"scale",value:function(t){return this._v[0]*=t,this._v[1]*=t,this._v[2]*=t,this}},{key:"cross",value:function(t){var e=this._v[1]*t._v[2]-this._v[2]*t._v[1],n=this._v[2]*t._v[0]-this._v[0]*t._v[2],i=this._v[0]*t._v[1]-this._v[1]*t._v[0];return this._v[0]=e,this._v[1]=n,this._v[2]=i,this}},{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]&&this._v[2]==t._v[2]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]||this._v[2]!=t._v[2]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],t._v.length>=3&&(this._v[2]=t._v[2])}},{key:"set",value:function(t,e,n){this._v[0]=t,this._v[1]=void 0===e?t:e,this._v[2]=void 0===e?t:void 0===n?e:n}},{key:"width",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"height",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"depth",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"xy",get:function(){return new ce(this._v[0],this._v[1])}},{key:"yz",get:function(){return new ce(this._v[1],this._v[2])}},{key:"xz",get:function(){return new ce(this._v[0],this._v[2])}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])||isNaN(this._v[2])}},{key:"toString",value:function(){return"["+this._v+"]"}}],[{key:"Add",value:function(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z)}},{key:"Sub",value:function(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z)}},{key:"Distance",value:function(t,e){return new n(t._v[0]-e._v[0],t._v[1]-e._v[1],t._v[2]-e._v[2]).magnitude()}},{key:"Dot",value:function(t,e){return t._v[0]*e._v[0]+t._v[1]*e._v[1]+t._v[2]*e._v[2]}},{key:"Cross",value:function(t,e){return new n(t._v[1]*e._v[2]-t._v[2]*e._v[1],t._v[2]*e._v[0]-t._v[0]*e._v[2],t._v[0]*e._v[1]-t._v[1]*e._v[0])}}]),n}(le),_e=function(t){ne(n,t);var e=re(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return ae(this,n),t=e.call(this,new te(4)),i instanceof ce?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=r,t._v[3]=s):i instanceof fe?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=i._v[2],t._v[3]=r):i instanceof n?(t._v[0]=i._v[0],t._v[1]=i._v[1],t._v[2]=i._v[2],t._v[3]=i._v[3]):Array.isArray(i)&&i.length>=4?(t._v[0]=i[0],t._v[1]=i[1],t._v[2]=i[2],t._v[3]=i[3]):(void 0===r&&(r=i),void 0===s&&(s=r),void 0===o&&(o=s),t._v[0]=i,t._v[1]=r,t._v[2]=s,t._v[3]=o),t}return he(n,[{key:"z",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"w",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"magnitude",value:function(){return Math.sqrt(this._v[0]*this._v[0]+this._v[1]*this._v[1]+this._v[2]*this._v[2]+this._v[3]*this._v[3])}},{key:"normalize",value:function(){var t=this.magnitude();return this._v[0]=this._v[0]/t,this._v[1]=this._v[1]/t,this._v[2]=this._v[2]/t,this._v[3]=this._v[3]/t,this}},{key:"distance",value:function(t){return new n(this._v[0]-t._v[0],this._v[1]-t._v[1],this._v[2]-t._v[2],this._v[3]-t._v[3]).magnitude()}},{key:"add",value:function(t){return this._v[0]+=t._v[0],this._v[1]+=t._v[1],this._v[2]+=t._v[2],this._v[3]+=t._v[3],this}},{key:"sub",value:function(t){return this._v[0]-=t._v[0],this._v[1]-=t._v[1],this._v[2]-=t._v[2],this._v[3]-=t._v[3],this}},{key:"dot",value:function(t){return this._v[0]*t._v[0]+this._v[1]*t._v[1]+this._v[2]*t._v[2]+this._v[3]*t._v[3]}},{key:"scale",value:function(t){return this._v[0]*=t,this._v[1]*=t,this._v[2]*=t,this._v[3]*=t,this}},{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]&&this._v[2]==t._v[2]&&this._v[3]==t._v[3]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]||this._v[2]!=t._v[2]||this._v[3]!=t._v[3]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],t._v.length>=3&&(this._v[2]=t._v[2]),4==t._v.length&&(this._v[3]=t._v[3])}},{key:"set",value:function(t,e,n,i){this._v[0]=t,this._v[1]=void 0===e?t:e,this._v[2]=void 0===e?t:void 0===n?e:n,this._v[3]=void 0===e?t:void 0===n?e:void 0===i?n:i}},{key:"r",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"g",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"b",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"a",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"xy",get:function(){return new ce(this._v[0],this._v[1])}},{key:"yz",get:function(){return new ce(this._v[1],this._v[2])}},{key:"xz",get:function(){return new ce(this._v[0],this._v[2])}},{key:"xyz",get:function(){return new fe(this._v[0],this._v[1],this._v[2])}},{key:"width",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"height",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"aspectRatio",get:function(){return 0!=this._v[3]?this._v[2]/this._v[3]:1}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])||isNaN(this._v[2])||isNaN(this._v[3])}},{key:"toString",value:function(){return"["+this._v+"]"}}],[{key:"Add",value:function(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)}},{key:"Sub",value:function(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)}},{key:"Yellow",value:function(){return new n(1,1,0,1)}},{key:"Orange",value:function(){return new n(1,.5,0,1)}},{key:"Red",value:function(){return new n(1,0,0,1)}},{key:"Violet",value:function(){return new n(.5,0,1,1)}},{key:"Blue",value:function(){return new n(0,0,1,1)}},{key:"Green",value:function(){return new n(0,1,0,1)}},{key:"White",value:function(){return new n(1,1,1,1)}},{key:"LightGray",value:function(){return new n(.8,.8,.8,1)}},{key:"Gray",value:function(){return new n(.5,.5,.5,1)}},{key:"DarkGray",value:function(){return new n(.2,.2,.2,1)}},{key:"Black",value:function(){return new n(0,0,0,1)}},{key:"Brown",value:function(){return new n(.4,.2,0,1)}},{key:"Transparent",value:function(){return new n(0,0,0,0)}}]),n}(le),me=ce,pe=fe,ve=ce,ye=_e,de=_e;function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function we(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ke=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;be(this,t),this._m=new Qt(9),Array.isArray(ge(e))?(this._m[0]=e[0],this._m[1]=e[1],this._m[2]=e[0],this._m[3]=e[3],this._m[4]=e[4],this._m[5]=e[5],this._m[6]=e[6],this._m[7]=e[7],this._m[8]=e[8]):"number"==typeof e?(this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=r,this._m[4]=s,this._m[5]=o,this._m[6]=a,this._m[7]=u,this._m[8]=h):this.assign(e)}var e,n,i;return e=t,i=[{key:"Identity",value:function(){return new t(1,0,0,0,1,0,0,0,1)}}],(n=[{key:"m",get:function(){return this._m}},{key:"toArray",value:function(){return[this._m[0],this._m[1],this._m[2],this._m[3],this._m[4],this._m[5],this._m[6],this._m[7],this._m[8]]}},{key:"m00",get:function(){return this._m[0]},set:function(t){this._m[0]=t}},{key:"m01",get:function(){return this._m[1]},set:function(t){this._m[1]=t}},{key:"m02",get:function(){return this._m[2]},set:function(t){this._m[2]=t}},{key:"m10",get:function(){return this._m[3]},set:function(t){this._m[3]=t}},{key:"m11",get:function(){return this._m[4]},set:function(t){this._m[4]=t}},{key:"m12",get:function(){return this._m[5]},set:function(t){this._m[5]=t}},{key:"m20",get:function(){return this._m[6]},set:function(t){this._m[6]=t}},{key:"m21",get:function(){return this._m[7]},set:function(t){this._m[7]=t}},{key:"m22",get:function(){return this._m[8]},set:function(t){this._m[8]=t}},{key:"zero",value:function(){return this._m[0]=this._m[1]=this._m[2]=this._m[3]=this._m[4]=this._m[5]=this._m[6]=this._m[7]=this._m[8]=0,this}},{key:"identity",value:function(){return this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=0,this._m[4]=1,this._m[5]=0,this._m[6]=0,this._m[7]=0,this._m[8]=1,this}},{key:"isZero",value:function(){return 0==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&0==this._m[4]&&0==this._m[5]&&0==this._m[6]&&0==this._m[7]&&0==this._m[8]}},{key:"isIdentity",value:function(){return 1==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&1==this._m[4]&&0==this._m[5]&&0==this._m[6]&&0==this._m[7]&&1==this._m[8]}},{key:"row",value:function(t){return new fe(this._m[3*t],this._m[3*t+1],this._m[3*t+2])}},{key:"setRow",value:function(t,e){return this._m[3*t]=e._v[0],this._m[3*t+1]=e._v[1],this._m[3*t+2]=e._v[2],this}},{key:"setScale",value:function(t,e,n){var i=new fe(this._m[0],this._m[3],this._m[6]).normalize().scale(t),r=new fe(this._m[1],this._m[4],this._m[7]).normalize().scale(e),s=new fe(this._m[2],this._m[5],this._m[8]).normalize().scale(n);return this._m[0]=i.x,this._m[3]=i.y,this._m[6]=i.z,this._m[1]=r.x,this._m[4]=r.y,this._m[7]=r.z,this._m[2]=s.x,this._m[5]=s.y,this._m[8]=s.z,this}},{key:"getScale",value:function(){return new fe(new fe(this._m[0],this._m[3],this._m[6]).module,new fe(this._m[1],this._m[4],this._m[7]).module,new fe(this._m[2],this._m[5],this._m[8]).module)}},{key:"length",get:function(){return this._m.length}},{key:"traspose",value:function(){var t=new fe(this._m[0],this._m[3],this._m[6]),e=new fe(this._m[1],this._m[4],this._m[7]),n=new fe(this._m[2],this._m[5],this._m[8]);return this.setRow(0,t),this.setRow(1,e),this.setRow(2,n),this}},{key:"elemAtIndex",value:function(t){return this._m[t]}},{key:"assign",value:function(t){return 9==t.length?(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=t._m[3],this._m[4]=t._m[4],this._m[5]=t._m[5],this._m[6]=t._m[6],this._m[7]=t._m[7],this._m[8]=t._m[8]):16==t.length&&(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=t._m[4],this._m[4]=t._m[5],this._m[5]=t._m[6],this._m[6]=t._m[8],this._m[7]=t._m[9],this._m[8]=t._m[10]),this}},{key:"equals",value:function(t){return this._m[0]==t._m[0]&&this._m[1]==t._m[1]&&this._m[2]==t._m[2]&&this._m[3]==t._m[3]&&this._m[4]==t._m[4]&&this._m[5]==t._m[5]&&this._m[6]==t._m[6]&&this._m[7]==t._m[7]&&this._m[8]==t._m[8]}},{key:"notEquals",value:function(t){return this._m[0]!=t._m[0]||this._m[1]!=t._m[1]||this._m[2]!=t._m[2]&&this._m[3]!=t._m[3]||this._m[4]!=t._m[4]||this._m[5]!=t._m[5]&&this._m[6]!=t._m[6]||this._m[7]!=t._m[7]||this._m[8]!=t._m[8]}},{key:"mult",value:function(t){if("number"==typeof t)this._m[0]*=t,this._m[1]*=t,this._m[2]*=t,this._m[3]*=t,this._m[4]*=t,this._m[5]*=t,this._m[6]*=t,this._m[7]*=t,this._m[8]*=t;else{var e=this._m,n=t._m,i=new Qt(9);i[0]=n[0]*e[0]+n[1]*e[1]+n[2]*e[2],i[1]=n[0]*e[1]+n[1]*e[4]+n[2]*e[7],i[2]=n[0]*e[2]+n[1]*e[5]+n[2]*e[8],i[3]=n[3]*e[0]+n[4]*e[3]+n[5]*e[6],i[4]=n[3]*e[1]+n[4]*e[4]+n[5]*e[7],i[5]=n[3]*e[2]+n[4]*e[5]+n[5]*e[8],i[6]=n[6]*e[0]+n[7]*e[3]+n[8]*e[6],i[7]=n[6]*e[1]+n[7]*e[4]+n[8]*e[7],i[8]=n[6]*e[2]+n[7]*e[5]+n[8]*e[8],this._m=i}return this}},{key:"multVector",value:function(t){"object"==ge(t)&&t._v&&t._v.length>=2&&(t=t._v);var e=t[0],n=t[1];return new fe(this._m[0]*e+this._m[3]*n+1*this._m[6],this._m[1]*e+this._m[4]*n+1*this._m[7],this._m[2]*e+this._m[5]*n+1*this._m[8])}},{key:"isNan",value:function(){return!(isNaN(_m[0])||isNaN(_m[1])||isNaN(_m[2])||isNaN(_m[3])||isNaN(_m[4])||isNaN(_m[5])||isNaN(_m[6])||isNaN(_m[7])||isNaN(_m[8]))}},{key:"toString",value:function(){return"["+this._m[0]+", "+this._m[1]+", "+this._m[2]+"]\n ["+this._m[3]+", "+this._m[4]+", "+this._m[5]+"]\n ["+this._m[6]+", "+this._m[7]+", "+this._m[8]+"]"}}])&&we(e.prototype,n),i&&we(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ee=Date.now(),Me=function(t){return"number"==typeof t&&t&&0==(t&t-1)},Se=function(t){return t>-1e-7&&t<Jt?0:t},xe=function(t){return Math.fround(Se(Math.sin(t)))},Oe=function(t){return Math.fround(Se(Math.cos(t)))},Te=function(t){return Math.fround(Se(Math.tan(t)))},Ie=function(){return 0+(Ee=(9301*Ee+49297)%233280)/233280*1},Ae=function(t){return Math.fround(Math.sqrt(t))};function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function Re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ne(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Pe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,_=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,m=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:0;Re(this,t),this._m=new Qt(16),Array.isArray(e)?(this._m[0]=e[0],this._m[1]=e[1],this._m[2]=e[2],this._m[3]=e[3],this._m[4]=e[4],this._m[5]=e[5],this._m[6]=e[6],this._m[7]=e[7],this._m[8]=e[8],this._m[9]=e[9],this._m[10]=e[10],this._m[11]=e[11],this._m[12]=e[12],this._m[13]=e[13],this._m[14]=e[14],this._m[15]=e[15]):"number"==typeof e?(this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=r,this._m[4]=s,this._m[5]=o,this._m[6]=a,this._m[7]=u,this._m[8]=h,this._m[9]=l,this._m[10]=c,this._m[11]=f,this._m[12]=_,this._m[13]=m,this._m[14]=p,this._m[15]=v):this.assign(e)}var e,n,i;return e=t,i=[{key:"Unproject",value:function(e,n,i,r,s,o){var a=new t(s);a.mult(r),a.invert();var u=new _e((e-o.y)/o.width*2-1,(n-o.x)/o.height*2-1,2*i-1,1),h=new _e(a.multVector(u));return 0==h.z?h.set(0):h.set(h.x/h.w,h.y/h.w,h.z/h.w,h.w/h.w),h}},{key:"Identity",value:function(){return new t(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},{key:"Perspective",value:function(e,n,i,r){var s=Te(e*$t/360)*i,o=s*n;return t.Frustum(-o,o,-s,s,i,r)}},{key:"Frustum",value:function(e,n,i,r,s,o){var a=new t,u=n-e,h=r-i,l=o-s;return a.setRow(0,new _e(2*s/u,0,0,0)),a.setRow(1,new _e(0,2*s/h,0,0)),a.setRow(2,new _e((n+e)/u,(r+i)/h,-(o+s)/l,-1)),a.setRow(3,new _e(0,0,-o*s*2/l,0)),a}},{key:"Ortho",value:function(e,n,i,r,s,o){var a=new t,u=n-e,h=r-i,l=o-s;return a._m[0]=2/u,a._m[1]=0,a._m[2]=0,a._m[3]=0,a._m[4]=0,a._m[5]=2/h,a._m[6]=0,a._m[7]=0,a._m[8]=0,a._m[9]=0,a._m[10]=-2/l,a._m[11]=0,a._m[12]=-(e+n)/u,a._m[13]=-(r+i)/h,a._m[14]=-(o+s)/l,a._m[15]=1,a}},{key:"LookAt",value:function(e,n,i){var r=t.Identity(),s=new fe(i),o=fe.Sub(e,n);o.normalize();var a=fe.Cross(s,o);return a.normalize(),s.normalize(),r.m00=a.x,r.m10=a.y,r.m20=a.z,r.m30=-a.dot(e),r.m01=s.x,r.m11=s.y,r.m21=s.z,r.m31=-s.dot(e),r.m02=o.x,r.m12=o.y,r.m22=o.z,r.m32=-o.dot(e),r.m03=0,r.m13=0,r.m23=0,r.m33=1,r}},{key:"Translation",value:function(e,n,i){return"object"==Ce(e)&&e._v&&e._v.length>=3&&(n=e._v[1],i=e._v[2],e=e._v[0]),new t(1,0,0,0,0,1,0,0,0,0,1,0,e,n,i,1)}},{key:"Rotation",value:function(e,n,i,r){var s=new fe(n,i,r);s.normalize(),new t(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);var o=Oe(e),a=1-o,u=xe(e);return new t(s.x*s.x*a+o,s.x*s.y*a+s.z*u,s.x*s.z*a-s.y*u,0,s.y*s.x*a-s.z*u,s.y*s.y*a+o,s.y*s.z*a+s.x*u,0,s.z*s.x*a+s.y*u,s.z*s.y*a-s.x*u,s.z*s.z*a+o,0,0,0,0,1)}},{key:"Scale",value:function(e,n,i){return"object"==Ce(e)&&e._v&&e._v.length>=3&&(n=(e=e._v[0])._v[1],i=e._v[2]),new t(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1)}}],(n=[{key:"m",get:function(){return this._m}},{key:"toArray",value:function(){return[this._m[0],this._m[1],this._m[2],this._m[3],this._m[4],this._m[5],this._m[6],this._m[7],this._m[8],this._m[9],this._m[10],this._m[11],this._m[12],this._m[13],this._m[14],this._m[15]]}},{key:"m00",get:function(){return this._m[0]},set:function(t){this._m[0]=t}},{key:"m01",get:function(){return this._m[1]},set:function(t){this._m[1]=t}},{key:"m02",get:function(){return this._m[2]},set:function(t){this._m[2]=t}},{key:"m03",get:function(){return this._m[3]},set:function(t){this._m[3]=t}},{key:"m10",get:function(){return this._m[4]},set:function(t){this._m[4]=t}},{key:"m11",get:function(){return this._m[5]},set:function(t){this._m[5]=t}},{key:"m12",get:function(){return this._m[6]},set:function(t){this._m[6]=t}},{key:"m13",get:function(){return this._m[7]},set:function(t){this._m[7]=t}},{key:"m20",get:function(){return this._m[8]},set:function(t){this._m[8]=t}},{key:"m21",get:function(){return this._m[9]},set:function(t){this._m[9]=t}},{key:"m22",get:function(){return this._m[10]},set:function(t){this._m[10]=t}},{key:"m23",get:function(){return this._m[11]},set:function(t){this._m[11]=t}},{key:"m30",get:function(){return this._m[12]},set:function(t){this._m[12]=t}},{key:"m31",get:function(){return this._m[13]},set:function(t){this._m[13]=t}},{key:"m32",get:function(){return this._m[14]},set:function(t){this._m[14]=t}},{key:"m33",get:function(){return this._m[15]},set:function(t){this._m[15]=t}},{key:"zero",value:function(){return this._m[0]=0,this._m[1]=0,this._m[2]=0,this._m[3]=0,this._m[4]=0,this._m[5]=0,this._m[6]=0,this._m[7]=0,this._m[8]=0,this._m[9]=0,this._m[10]=0,this._m[11]=0,this._m[12]=0,this._m[13]=0,this._m[14]=0,this._m[15]=0,this}},{key:"identity",value:function(){return this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=0,this._m[4]=0,this._m[5]=1,this._m[6]=0,this._m[7]=0,this._m[8]=0,this._m[9]=0,this._m[10]=1,this._m[11]=0,this._m[12]=0,this._m[13]=0,this._m[14]=0,this._m[15]=1,this}},{key:"isZero",value:function(){return 0==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&0==this._m[4]&&0==this._m[5]&&0==this._m[6]&&0==this._m[7]&&0==this._m[8]&&0==this._m[9]&&0==this._m[10]&&0==this._m[11]&&0==this._m[12]&&0==this._m[13]&&0==this._m[14]&&0==this._m[15]}},{key:"isIdentity",value:function(){return 1==this._m[0]&&0==this._m[1]&&0==this._m[2]&&0==this._m[3]&&0==this._m[4]&&1==this._m[5]&&0==this._m[6]&&0==this._m[7]&&0==this._m[8]&&0==this._m[9]&&1==this._m[10]&&0==this._m[11]&&0==this._m[12]&&0==this._m[13]&&0==this._m[14]&&1==this._m[15]}},{key:"row",value:function(t){return new _e(this._m[4*t],this._m[4*t+1],this._m[4*t+2],this._m[4*t+3])}},{key:"setRow",value:function(t,e){return this._m[4*t]=e._v[0],this._m[4*t+1]=e._v[1],this._m[4*t+2]=e._v[2],this._m[4*t+3]=e._v[3],this}},{key:"setScale",value:function(t,e,n){var i=new fe(this._m[0],this._m[4],this._m[8]).normalize().scale(t),r=new fe(this._m[1],this._m[5],this._m[9]).normalize().scale(e),s=new fe(this._m[2],this._m[6],this._m[10]).normalize().scale(n);return this._m[0]=i.x,this._m[4]=i.y,this._m[8]=i.z,this._m[1]=r.x,this._m[5]=r.y,this._m[9]=r.z,this._m[2]=s.x,this._m[6]=s.y,this._m[10]=s.z,this}},{key:"getScale",value:function(){return new fe(new fe(this._m[0],this._m[4],this._m[8]).module,new fe(this._m[1],this._m[5],this._m[9]).module,new fe(this._m[2],this._m[6],this._m[10]).module)}},{key:"setPosition",value:function(t,e,n){return"number"==typeof t?(this._m[12]=t,this._m[13]=e,this._m[14]=n):(this._m[12]=t.x,this._m[13]=t.y,this._m[14]=t.z),this}},{key:"rotation",get:function(){var e=this.getScale();return new t(this._m[0]/e.x,this._m[1]/e.y,this._m[2]/e.z,0,this._m[4]/e.x,this._m[5]/e.y,this._m[6]/e.z,0,this._m[8]/e.x,this._m[9]/e.y,this._m[10]/e.z,0,0,0,0,1)}},{key:"position",get:function(){return new fe(this._m[12],this._m[13],this._m[14])}},{key:"length",get:function(){return this._m.length}},{key:"getMatrix3",value:function(){return new Matrix3(this._m[0],this._m[1],this._m[2],this._m[4],this._m[5],this._m[6],this._m[8],this._m[9],this._m[10])}},{key:"perspective",value:function(e,n,i,r){return this.assign(t.Perspective(e,n,i,r)),this}},{key:"frustum",value:function(e,n,i,r,s,o){return this.assign(t.Frustum(e,n,i,r,s,o)),this}},{key:"ortho",value:function(e,n,i,r,s,o){return this.assign(t.Ortho(e,n,i,r,s,o)),this}},{key:"lookAt",value:function(e,n,i){return this.assign(t.LookAt(e,n,i)),this}},{key:"translate",value:function(e,n,i){return this.mult(t.Translation(e,n,i)),this}},{key:"rotate",value:function(e,n,i,r){return this.mult(t.Rotation(e,n,i,r)),this}},{key:"scale",value:function(e,n,i){return this.mult(t.Scale(e,n,i)),this}},{key:"elemAtIndex",value:function(t){return this._m[t]}},{key:"assign",value:function(t){return 9==t.length?(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=0,this._m[4]=t._m[3],this._m[5]=t._m[4],this._m[6]=t._m[5],this._m[7]=0,this._m[8]=t._m[6],this._m[9]=t._m[7],this._m[10]=t._m[8],this._m[11]=0,this._m[12]=0,this._m[13]=0,this._m[14]=0,this._m[15]=1):16==t.length&&(this._m[0]=t._m[0],this._m[1]=t._m[1],this._m[2]=t._m[2],this._m[3]=t._m[3],this._m[4]=t._m[4],this._m[5]=t._m[5],this._m[6]=t._m[6],this._m[7]=t._m[7],this._m[8]=t._m[8],this._m[9]=t._m[9],this._m[10]=t._m[10],this._m[11]=t._m[11],this._m[12]=t._m[12],this._m[13]=t._m[13],this._m[14]=t._m[14],this._m[15]=t._m[15]),this}},{key:"equals",value:function(t){return this._m[0]==t._m[0]&&this._m[1]==t._m[1]&&this._m[2]==t._m[2]&&this._m[3]==t._m[3]&&this._m[4]==t._m[4]&&this._m[5]==t._m[5]&&this._m[6]==t._m[6]&&this._m[7]==t._m[7]&&this._m[8]==t._m[8]&&this._m[9]==t._m[9]&&this._m[10]==t._m[10]&&this._m[11]==t._m[11]&&this._m[12]==t._m[12]&&this._m[13]==t._m[13]&&this._m[14]==t._m[14]&&this._m[15]==t._m[15]}},{key:"notEquals",value:function(t){return this._m[0]!=t._m[0]||this._m[1]!=t._m[1]||this._m[2]!=t._m[2]||this._m[3]!=t._m[3]||this._m[4]!=t._m[4]||this._m[5]!=t._m[5]||this._m[6]!=t._m[6]||this._m[7]!=t._m[7]||this._m[8]!=t._m[8]||this._m[9]!=t._m[9]||this._m[10]!=t._m[10]||this._m[11]!=t._m[11]||this._m[12]!=t._m[12]||this._m[13]!=t._m[13]||this._m[14]!=t._m[14]||this._m[15]!=t._m[15]}},{key:"mult",value:function(t){if("number"==typeof t)return this._m[0]*=t,this._m[1]*=t,this._m[2]*=t,this._m[3]*=t,this._m[4]*=t,this._m[5]*=t,this._m[6]*=t,this._m[7]*=t,this._m[8]*=t,this._m[9]*=t,this._m[10]*=t,this._m[11]*=t,this._m[12]*=t,this._m[13]*=t,this._m[14]*=t,this._m[15]*=t,this;var e=this._m,n=t._m,i=new Qt(16);return i[0]=n[0]*e[0]+n[1]*e[4]+n[2]*e[8]+n[3]*e[12],i[1]=n[0]*e[1]+n[1]*e[5]+n[2]*e[9]+n[3]*e[13],i[2]=n[0]*e[2]+n[1]*e[6]+n[2]*e[10]+n[3]*e[14],i[3]=n[0]*e[3]+n[1]*e[7]+n[2]*e[11]+n[3]*e[15],i[4]=n[4]*e[0]+n[5]*e[4]+n[6]*e[8]+n[7]*e[12],i[5]=n[4]*e[1]+n[5]*e[5]+n[6]*e[9]+n[7]*e[13],i[6]=n[4]*e[2]+n[5]*e[6]+n[6]*e[10]+n[7]*e[14],i[7]=n[4]*e[3]+n[5]*e[7]+n[6]*e[11]+n[7]*e[15],i[8]=n[8]*e[0]+n[9]*e[4]+n[10]*e[8]+n[11]*e[12],i[9]=n[8]*e[1]+n[9]*e[5]+n[10]*e[9]+n[11]*e[13],i[10]=n[8]*e[2]+n[9]*e[6]+n[10]*e[10]+n[11]*e[14],i[11]=n[8]*e[3]+n[9]*e[7]+n[10]*e[11]+n[11]*e[15],i[12]=n[12]*e[0]+n[13]*e[4]+n[14]*e[8]+n[15]*e[12],i[13]=n[12]*e[1]+n[13]*e[5]+n[14]*e[9]+n[15]*e[13],i[14]=n[12]*e[2]+n[13]*e[6]+n[14]*e[10]+n[15]*e[14],i[15]=n[12]*e[3]+n[13]*e[7]+n[14]*e[11]+n[15]*e[15],this._m=i,this}},{key:"multVector",value:function(t){"object"==Ce(t)&&t._v&&t._v.length>=3&&(t=t._v);var e=t[0],n=t[1],i=t[2];return new _e(this._m[0]*e+this._m[4]*n+this._m[8]*i+1*this._m[12],this._m[1]*e+this._m[5]*n+this._m[9]*i+1*this._m[13],this._m[2]*e+this._m[6]*n+this._m[10]*i+1*this._m[14],this._m[3]*e+this._m[7]*n+this._m[11]*i+1*this._m[15])}},{key:"invert",value:function(){var t=this._m[0],e=this._m[1],n=this._m[2],i=this._m[3],r=this._m[4],s=this._m[5],o=this._m[6],a=this._m[7],u=this._m[8],h=this._m[9],l=this._m[10],c=this._m[11],f=this._m[12],_=this._m[13],m=this._m[14],p=this._m[15],v=t*s-e*r,y=t*o-n*r,d=t*a-i*r,g=e*o-n*s,b=e*a-i*s,w=n*a-i*o,k=u*_-h*f,E=u*m-l*f,M=u*p-c*f,S=h*m-l*_,x=h*p-c*_,O=l*p-c*m,T=v*O-y*x+d*S+g*M-b*E+w*k;return T?(T=1/T,this._m[0]=(s*O-o*x+a*S)*T,this._m[1]=(n*x-e*O-i*S)*T,this._m[2]=(_*w-m*b+p*g)*T,this._m[3]=(l*b-h*w-c*g)*T,this._m[4]=(o*M-r*O-a*E)*T,this._m[5]=(t*O-n*M+i*E)*T,this._m[6]=(m*d-f*w-p*y)*T,this._m[7]=(u*w-l*d+c*y)*T,this._m[8]=(r*x-s*M+a*k)*T,this._m[9]=(e*M-t*x-i*k)*T,this._m[10]=(f*b-_*d+p*v)*T,this._m[11]=(h*d-u*b-c*v)*T,this._m[12]=(s*E-r*S-o*k)*T,this._m[13]=(t*S-e*E+n*k)*T,this._m[14]=(_*y-f*g-m*v)*T,this._m[15]=(u*g-h*y+l*v)*T,this):(this.zero(),this)}},{key:"traspose",value:function(){var t=new _e(this._m[0],this._m[4],this._m[8],this._m[12]),e=new _e(this._m[1],this._m[5],this._m[9],this._m[13]),n=new _e(this._m[2],this._m[6],this._m[10],this._m[14]),i=new _e(this._m[3],this._m[7],this._m[11],this._m[15]);return this.setRow(0,t),this.setRow(1,e),this.setRow(2,n),this.setRow(3,i),this}},{key:"transformDirection",value:function(e){var n=new fe(e),i=new t(this);return i.setRow(3,new _e(0,0,0,1)),n.assign(i.multVector(n).xyz),n.normalize(),n}},{key:"forwardVector",get:function(){return this.transformDirection(new fe(0,0,1))}},{key:"rightVector",get:function(){return this.transformDirection(new fe(1,0,0))}},{key:"upVector",get:function(){return this.transformDirection(new fe(0,1,0))}},{key:"backwardVector",get:function(){return this.transformDirection(new fe(0,0,-1))}},{key:"leftVector",get:function(){return this.transformDirection(new fe(-1,0,0))}},{key:"downVector",get:function(){return this.transformDirection(new fe(0,-1,0))}},{key:"isNan",value:function(){return Number.isNaN(this._m[0])||Number.isNaN(this._m[1])||Number.isNaN(this._m[2])||Number.isNaN(this._m[3])||Number.isNaN(this._m[4])||Number.isNaN(this._m[5])||Number.isNaN(this._m[6])||Number.isNaN(this._m[7])||Number.isNaN(this._m[8])||Number.isNaN(this._m[9])||Number.isNaN(this._m[10])||Number.isNaN(this._m[11])||Number.isNaN(this._m[12])||Number.isNaN(this._m[13])||Number.isNaN(this._m[14])||Number.isNaN(this._m[15])}},{key:"getOrthoValues",value:function(){return[(1+get23())/get22(),-(1-get23())/get22(),(1-get13())/get11(),-(1+get13())/get11(),-(1+get03())/get00(),(1-get03())/get00()]}},{key:"getPerspectiveValues",value:function(){return[get23()/(get22()-1),get23()/(get22()+1),near*(get12()-1)/get11(),near*(get12()+1)/get11(),near*(get02()-1)/get00(),near*(get02()+1)/get00()]}},{key:"toString",value:function(){return"["+this._m[0]+", "+this._m[1]+", "+this._m[2]+", "+this._m[3]+"]\n ["+this._m[4]+", "+this._m[5]+", "+this._m[6]+", "+this._m[7]+"]\n ["+this._m[8]+", "+this._m[9]+", "+this._m[10]+", "+this._m[11]+"]\n ["+this._m[12]+", "+this._m[13]+", "+this._m[14]+", "+this._m[15]+"]"}}])&&Ne(e.prototype,n),i&&Ne(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Le(t){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(t)}function Ve(t,e){return Ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ve(t,e)}function Fe(t,e){if(e&&("object"===Le(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function je(t){return je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},je(t)}function Ge(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Be={VERTEX:1,NORMAL:2,TEX_COORD_0:4,TEX_COORD_1:8,TEX_COORD_2:16,COLOR:32,TANGENT:64,INDEX:128},De={TRIANGLES:null,TRIANGLE_FAN:null,TRIANGLE_STRIP:null,LINES:null,LINE_STRIP:null},Ue=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ve(t,e)}(a,t);var e,n,i,r,s,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=je(e);if(n){var r=je(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return Fe(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t))._plist=null,e._drawMode=De.TRIANGLES,e._name="",e._groupName="",e._visible=!0,e._visibleToShadows=!0,e._vertex=[],e._normal=[],e._texCoord0=[],e._texCoord1=[],e._texCoord2=[],e._color=[],e._tangent=[],e._index=[],e}return i=a,r=[{key:"clone",value:function(){var t=new a(this.context),e=function(t,e){t.forEach((function(t){e.push(t)}))};return t.name=this.name+" clone",t.groupName=this.groupName,t.visible=this.visible,t.visibleToShadows=this.visibleToShadows,t.drawMode=this.drawMode,e(this.vertex,t.vertex),e(this.normal,t.normal),e(this.texCoord0,t.texCoord0),e(this.texCoord1,t.texCoord1),e(this.texCoord2,t.texCoord02),e(this.color,t.color),e(this.index,t.index),t.build(),t}},{key:"name",get:function(){return this._name},set:function(t){this._name=t}},{key:"groupName",get:function(){return this._groupName},set:function(t){this._groupName=t}},{key:"visible",get:function(){return this._visible},set:function(t){this._visible=t}},{key:"visibleToShadows",get:function(){return this._visibleToShadows},set:function(t){this._visibleToShadows=t}},{key:"drawMode",get:function(){return this._drawMode},set:function(t){this._drawMode=t}},{key:"vertex",get:function(){return this._vertex},set:function(t){this._vertex=t}},{key:"normal",get:function(){return this._normal},set:function(t){this._normal=t}},{key:"texCoord0",get:function(){return this._texCoord0},set:function(t){this._texCoord0=t}},{key:"texCoord1",get:function(){return this._texCoord1},set:function(t){this._texCoord1=t}},{key:"texCoord2",get:function(){return this._texCoord2},set:function(t){this._texCoord2=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"index",get:function(){return this._index},set:function(t){this._index=t}},{key:"tangent",get:function(){return this._tangent}},{key:"vertexBuffer",get:function(){return this._plist.vertexBuffer}},{key:"normalBuffer",get:function(){return this._plist.normalBuffer}},{key:"texCoord0Buffer",get:function(){return this._plist.tex0Buffer}},{key:"texCoord1Buffer",get:function(){return this._plist.tex1Buffer}},{key:"texCoord2Buffer",get:function(){return this._plist.tex2Buffer}},{key:"colorBuffer",get:function(){return this._plist.colorBuffer}},{key:"tangentBuffer",get:function(){return this._plist.tangentBuffer}},{key:"indexBuffer",get:function(){return this._plist.indexBuffer}},{key:"updateBuffer",value:function(t,e){var n=!1;switch(t){case Be.VERTEX:n=this.vertex.length==e.length;break;case Be.NORMAL:n=this.normal.length==e.length;break;case Be.TEX_COORD_0:n=this.texCoord0.length==e.length;break;case Be.TEX_COORD_1:n=this.texCoord1.length==e.length;break;case Be.TEX_COORD_2:n=this.texCoord2.length==e.length;break;case Be.COLOR:n=this.color.length==e.length;break;case Be.TANGENT:n=this.tangent.length==e.length;break;case Be.INDEX:n=this.index.length==e.length}if(!n)throw new Error("Error updating buffer: The new buffer have different size as the old one.");I.Get().polyList.update(this.context,this._plist,t,e)}},{key:"build",value:function(){if(0==this.color.length)for(var t=0;t<this.vertex.length;t+=3)this.color.push(1),this.color.push(1),this.color.push(1),this.color.push(1);var e=I.Get().polyList;return this._plist&&(e.destroy(this.context,this._plist),this._tangent=[]),this._tangent=function(t){if(t.texCoord0&&t.vertex){t._tangent=[];var e=[],n={},i=!1;if(t.index.length%3==0)for(var r=0;r<t.index.length-2;r+=3){var s=3*t.index[r],o=3*t.index[r+1],a=3*t.index[r+2],u=2*t.index[r],h=2*t.index[r+1],l=2*t.index[r+2],c=new fe(t.vertex[s],t.vertex[s+1],t.vertex[s+2]),f=new fe(t.vertex[o],t.vertex[o+1],t.vertex[o+2]),_=new fe(t.vertex[a],t.vertex[a+1],t.vertex[a+2]),m=new ce(t.texCoord0[u],t.texCoord0[u+1]),p=new ce(t.texCoord0[h],t.texCoord0[h+1]),v=new ce(t.texCoord0[l],t.texCoord0[l+1]),y=new fe(f).sub(c),d=new fe(_).sub(c),g=p.x-m.x,b=p.y-m.y,w=v.x-m.x,k=v.y-m.y,E=g*k-w*b,M=null;if(0==E){var S=new fe(t.normal[s],t.normal[s+1],t.normal[s+2]);i=!0,M=new fe(S.y,S.z,S.x)}else{var x=1/E;(M=new fe(x*(k*y.x-b*d.x),x*(k*y.y-b*d.y),x*(k*y.z-b*d.z))).normalize()}void 0===n[s]&&(e.push(M.x),e.push(M.y),e.push(M.z),n[s]=M),void 0===n[o]&&(e.push(M.x),e.push(M.y),e.push(M.z),n[o]=M),void 0===n[a]&&(e.push(M.x),e.push(M.y),e.push(M.z),n[a]=M)}else for(var O=0;O<t.vertex.length;O+=3)t._tangent.push(0,0,1);return i&&console.warn("Invalid UV texture coords found. Some objects may present artifacts in the lighting, and not display textures properly."),e}}(this),this._plist=e.create(this.context),e.build(this.context,this._plist,this._vertex,this._normal,this._texCoord0,this._texCoord1,this._texCoord2,this._color,this._tangent,this._index)}},{key:"draw",value:function(){I.Get().polyList.draw(this.context,this._plist,this.drawMode,this.index.length)}},{key:"destroy",value:function(){this._plist&&I.Get().polyList.destroy(this.context,this._plist),this._plist=null,this._name="",this._vertex=[],this._normal=[],this._texCoord0=[],this._texCoord1=[],this._texCoord2=[],this._color=[],this._tangent=[],this._index=[]}},{key:"applyTransform",value:function(t){var e=new Pe(t),n=new Pe(t.getMatrix3());if(this.normal.length>0&&this.normal.length!=this.vertex.length)throw new Error("Unexpected number of normal coordinates found in polyList");for(var i=0;i<this.vertex.length-2;i+=3){var r=new Vector4(this.vertex[i],this.vertex[i+1],this.vertex[i+2],1);if(r=e.multVector(r),this.vertex[i]=r.x,this.vertex[i+1]=r.y,this.vertex[i+2]=r.z,this.normal.length){var s=new Vector4(this.normal[i],this.normal[i+1],this.normal[i+2],1);s=n.multVector(s),this.normal[i]=s.x,this.normal[i+1]=s.y,this.normal[i+2]=s.z}}this.build()}}],r&&Ge(i.prototype,r),s&&Ge(i,s),Object.defineProperty(i,"prototype",{writable:!1}),a}(G);function Xe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}var ze=null;function We(t){Reflect.defineProperty(t,"all",{get:function(){if(!this._all)for(var e in this._all=[],t)"object"==He(t[e])&&t[e].name&&this._all.push(t[e]);return this._all}})}var Ye=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=I.Get().shaderLibrary;for(var n in e)this[n]=e[n];for(var i in We(this.inputs.matrix),Object.defineProperty(this.inputs.matrix,"modelViewProjection",{get:function(){return[this.model,this.view,this.projection]}}),We(this.inputs.material),We(this.inputs.lighting),We(this.inputs.lightingForward),We(this.inputs.shadows),We(this.inputs.colorCorrection),We(this.functions.materials),We(this.functions.colorCorrection),We(this.functions.lighting),We(this.functions.utils),this.inputs.pbr)We(this.inputs.pbr[i]);for(var r in this.functions.pbr)We(this.functions.pbr[r])}var e,n;return e=t,n=[{key:"Get",value:function(){return ze||(ze=new t),ze}}],null&&Xe(e.prototype,null),n&&Xe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ke(t){return function(t){if(Array.isArray(t))return $e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function qe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ze=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._type=e,this._params=[],this._functions=[],this._requiredExtensions=[],this._header="",this._preprocessor=""}return e=t,n=[{key:"type",get:function(){return this._type}},{key:"params",get:function(){return this._params}},{key:"header",get:function(){return this._header}},{key:"functions",get:function(){return this._functions}},{key:"addParameter",value:function(t){t instanceof Array?this._params=[].concat(Ke(this._params),Ke(t)):this._params.push(t),this._params.push(null)}},{key:"addFunction",value:function(t){t instanceof Array?this._functions=[].concat(Ke(this._functions),Ke(t)):this._functions.push(t)}},{key:"setMainBody",value:function(t){this.addFunction({returnType:"void",name:"main",params:{},body:t})}},{key:"appendHeader",value:function(t){this._header+=t+"\n"}},{key:"appendPreprocessor",value:function(t){this._preprocessor+=t+"\n"}},{key:"toString",value:function(){var t=this,e=I.Get().shaderSource,n=this._preprocessor;return n+=e.header(this.type)+"\n"+this._header+"\n\n",this.params.forEach((function(i){n+=e.parameter(t.type,i)+"\n"})),this.functions.forEach((function(i){n+="\n"+e.func(t.type,i)+"\n"})),n}}],i=[{key:"FormatSource",value:function(t){var e="",n=t.replace(/^\n*/,"").replace(/\n*$/,"").split("\n"),i=100;return n.forEach((function(t){var e=/(\t*)/.exec(t)[0].length;i>e&&(i=e)})),n.forEach((function(t){var n=/(\t*)/.exec(t)[0].length,r=n-i;e+=t.slice(n-r,t.length)+"\n"})),e.replace(/^\n*/,"").replace(/\n*$/,"")}}],n&&qe(e.prototype,n),i&&qe(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t;var e,n,i}();function Je(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}window.s_bg_base_textureCache={};var Qe=8,tn="static-white-color-texture",en="static-black-color-texture",nn="static-normal-color-texture",rn="static-random-color-texture",sn="static-white-cubemap-texture",on="static-white-cubemap-texture",an=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._context=e,this._textures={}}var e,n,i;return e=t,i=[{key:"SetColorTextureSize",value:function(t){Qe=t}},{key:"GetColorTextureSize",value:function(){return Qe}},{key:"WhiteCubemap",value:function(e){var n=t.Get(e),i=n.find(sn);return i||(i=Mn.WhiteCubemap(e),n.register(sn,i)),i}},{key:"BlackCubemap",value:function(e){var n=t.Get(e),i=n.find(on);return i||(i=Mn.BlackCubemap(e),n.register(on,i)),i}},{key:"WhiteTexture",value:function(e){var n=t.Get(e),i=n.find(tn);return i||(i=Mn.WhiteTexture(e,new ce(Qe)),n.register(tn,i)),i}},{key:"BlackTexture",value:function(e){var n=t.Get(e),i=n.find(en);return i||(i=Mn.BlackTexture(e,new ce(Qe)),n.register(en,i)),i}},{key:"NormalTexture",value:function(e){var n=t.Get(e),i=n.find(nn);return i||(i=Mn.NormalTexture(e,new ce(Qe)),n.register(nn,i)),i}},{key:"RandomTexture",value:function(e){var n=t.Get(e),i=n.find(rn);return i||(i=Mn.RandomTexture(e,new ce(64)),n.register(rn,i)),i}},{key:"Get",value:function(e){return window.s_bg_base_textureCache[e.uuid]||(window.s_bg_base_textureCache[e.uuid]=new t(e)),window.s_bg_base_textureCache[e.uuid]}},{key:"PrecomputedBRDFLookupTexture",value:function(t){return window.s_bg_base_textureCache._bg_base_brdfLutData_||(window.s_bg_base_textureCache._bg_base_brdfLutData_=Mn.PrecomputedBRDFLookupTexture(t)),window.s_bg_base_textureCache._bg_base_brdfLutData_}}],(n=[{key:"find",value:function(t){return this._textures[t]}},{key:"register",value:function(t,e){e instanceof Mn&&(this._textures[t]=e)}},{key:"unregister",value:function(t){this._textures[t]&&delete this._textures[t]}},{key:"clear",value:function(){this._textures={}}}])&&Je(e.prototype,n),i&&Je(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function un(t){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},un(t)}function hn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cn(t,e){return cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},cn(t,e)}function fn(t,e){if(e&&("object"===un(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _n(t){return _n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_n(t)}window.s_bg_base_textureLoaderPlugin_wrapX=null,window.s_bg_base_textureLoaderPlugin_wrapY=null,window.s_bg_base_textureLoaderPlugin_minFilter=null,window.s_bg_base_textureLoaderPlugin_magFilter=null;var mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cn(t,e)}(a,bg.base.LoaderPlugin);var e,n,i,r,s,o=(r=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_n(r);if(s){var n=_n(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return fn(this,t)});function a(){return hn(this,a),o.apply(this,arguments)}return e=a,i=[{key:"GetWrapX",value:function(){return window.s_bg_base_textureLoaderPlugin_wrapX||bn.REPEAT}},{key:"GetWrapY",value:function(){return window.s_bg_base_textureLoaderPlugin_wrapY||bn.REPEAT}},{key:"GetMinFilter",value:function(){return window.s_bg_base_textureLoaderPlugin_minFilter||wn.LINEAR_MIPMAP_NEAREST}},{key:"GetMagFilter",value:function(){return window.s_bg_base_textureLoaderPlugin_magFilter||wn.LINEAR}},{key:"SetMinFilter",value:function(t){window.s_bg_base_textureLoaderPlugin_minFilter=t}},{key:"SetMagFilter",value:function(t){window.s_bg_base_textureLoaderPlugin_magFilter=t}},{key:"SetWrapX",value:function(t){window.s_bg_base_textureLoaderPlugin_wrapX=t}},{key:"SetWrapY",value:function(t){window.s_bg_base_textureLoaderPlugin_wrapY=t}}],(n=[{key:"acceptType",value:function(t,e){return O.IsImage(t)}},{key:"load",value:function(t,e,n,i){return new Promise((function(r,s){if(n){var o=an.Get(t).find(e);o||(console.log("Texture ".concat(e," not found. Loading texture")),(o=new Mn(t)).create(),o.bind(),o.wrapX=i.wrapX||a.GetWrapX(),o.wrapY=i.wrapY||a.GetWrapY(),o.minFilter=i.minFilter||a.GetMinFilter(),o.magFilter=i.magFilter||a.GetMagFilter(),o.setImage(n),o.fileName=e,an.Get(t).register(e,o)),r(o)}else s(new Error("Error loading texture image data"))}))}}])&&ln(e.prototype,n),i&&ln(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}();function pn(t){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pn(t)}function vn(t,e){return vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vn(t,e)}function yn(t,e){if(e&&("object"===pn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dn(t){return dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},dn(t)}function gn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var bn={REPEAT:null,CLAMP:null,MIRRORED_REPEAT:null},wn={NEAREST_MIPMAP_NEAREST:null,LINEAR_MIPMAP_NEAREST:null,NEAREST_MIPMAP_LINEAR:null,LINEAR_MIPMAP_LINEAR:null,NEAREST:null,LINEAR:null},kn={TEXTURE_2D:null,CUBE_MAP:null,POSITIVE_X_FACE:null,NEGATIVE_X_FACE:null,POSITIVE_Y_FACE:null,NEGATIVE_Y_FACE:null,POSITIVE_Z_FACE:null,NEGATIVE_Z_FACE:null},En={NONE:0,IMAGE:1,IMAGE_DATA:2,CUBEMAP:3,CUBEMAP_DATA:4,VIDEO:5};window.s_bg_base_window.s_bg_base_base64TexturePreventRemove=[];var Mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vn(t,e)}(u,t);var e,i,r,s,o,a=(e=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=dn(e);if(i){var r=dn(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return yn(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this,t))._texture=null,e._fileName="",e._size=new ce(0),e._target=kn.TEXTURE_2D,e._minFilter=wn.LINEAR,e._magFilter=wn.LINEAR,e._wrapX=bn.REPEAT,e._wrapY=bn.REPEAT,e._video=null,e}return r=u,o=[{key:"IsPowerOfTwoImage",value:function(t){return Me(t.width)&&Me(t.height)}},{key:"FromCanvas",value:function(t,e){return u.FromBase64Image(t,e.toDataURL("image/png"))}},{key:"UpdateCanvasImage",value:function(t,e){if(!t.valid)return!1;var n=e.toDataURL("image/png");return t.img.width==n.width&&(t.img.height,n.height),t.img=new Image,g_window.s_bg_base_base64TexturePreventRemove.push(t),setTimeout((function(){t.bind(),u.IsPowerOfTwoImage(t.img)?(t.minFilter=mn.GetMinFilter(),t.magFilter=mn.GetMagFilter()):(t.minFilter=wn.NEAREST,t.magFilter=wn.NEAREST,t.wrapX=bn.CLAMP,t.wrapY=bn.CLAMP),t.setImage(t.img,!0),t.unbind();var e=g_window.s_bg_base_base64TexturePreventRemove.indexOf(t);-1!=e&&g_window.s_bg_base_base64TexturePreventRemove.splice(e,1),S(t.img)}),10),t.img.src=n,t}},{key:"FromBase64Image",value:function(t,e){var n=new u(t);return n.img=new Image,g_window.s_bg_base_base64TexturePreventRemove.push(n),setTimeout((function(){n.create(),n.bind(),u.IsPowerOfTwoImage(n.img)?(n.minFilter=mn.GetMinFilter(),n.magFilter=mn.GetMagFilter()):(n.minFilter=wn.NEAREST,n.magFilter=wn.NEAREST,n.wrapX=bn.CLAMP,n.wrapY=bn.CLAMP),n.setImage(n.img,!1),n.unbind();var t=g_window.s_bg_base_base64TexturePreventRemove.indexOf(n);-1!=t&&g_window.s_bg_base_base64TexturePreventRemove.splice(t,1),S(n.img)}),10),n.img.src=e,n}},{key:"ColorTexture",value:function(t,e,n){var i=new u(t);i.create(),i.bind();for(var r=n.width*n.height*4,s=[],o=0;o<r;o+=4)s[o]=255*e.r,s[o+1]=255*e.g,s[o+2]=255*e.b,s[o+3]=255*e.a;return s=new Uint8Array(s),i.minFilter=wn.NEAREST,i.magFilter=wn.NEAREST,i.setImageRaw(n.width,n.height,s),i.unbind(),i}},{key:"WhiteTexture",value:function(t,e){return u.ColorTexture(t,de.White(),e)}},{key:"WhiteCubemap",value:function(t){return u.ColorCubemap(t,de.White())}},{key:"BlackCubemap",value:function(t){return u.ColorCubemap(t,de.Black())}},{key:"ColorCubemap",value:function(t,e){var n=new u(t);n.target=kn.CUBE_MAP,n.create(),n.bind();for(var i=[],r=0;r<4096;r+=4)i[r]=255*e.r,i[r+1]=255*e.g,i[r+2]=255*e.b,i[r+3]=255*e.a;return i=new Uint8Array(i),n.setCubemapRaw(32,32,i,i,i,i,i,i),n.unbind(),n}},{key:"NormalTexture",value:function(t,e){return u.ColorTexture(t,new de(.5,.5,1,1),e)}},{key:"BlackTexture",value:function(t,e){return u.ColorTexture(t,de.Black(),e)}},{key:"RandomTexture",value:function(t,e){var n=new u(t);n.create(),n.bind();for(var i=e.width*e.height*4,r=[],s=0;s<i;s+=4){var o=new fe(2*Ie()-1,2*Ie()-1,0);o.normalize(),r[s]=255*o.x,r[s+1]=255*o.y,r[s+2]=255*o.z,r[s+3]=1}return r=new Uint8Array(r),n.minFilter=wn.NEAREST,n.magFilter=wn.NEAREST,n.setImageRaw(e.width,e.height,r),n.unbind(),n}},{key:"PrecomputedBRDFLookupTexture",value:function(t){return new Promise((function(e){n.e(101).then(n.bind(n,576)).then((function(e){return u.FromBase64Image(t,e)})).then((function(t){e(t)})).catch((function(t){console.error("Error loading BRDF lut data"),console.error(t)}))}))}},{key:"FromImage",value:function(t,e,n){var i=null;return e&&((i=an.Get(t).find(n))||(console.debug("Texture ".concat(n," not found. Loading texture")),(i=new u(t)).create(),i.bind(),i.minFilter=mn.GetMinFilter(),i.magFilter=mn.GetMagFilter(),i.setImage(e),i.fileName=n,an.Get(t).register(n,i))),i}},{key:"SetActive",value:function(t,e){I.Get().texture.setActive(t,e)}},{key:"Unbind",value:function(t,e){e||(e=kn.TEXTURE_2D),I.Get().texture.unbind(t,e)}}],(s=[{key:"texture",get:function(){return this._texture}},{key:"target",get:function(){return this._target},set:function(t){this._target=t}},{key:"fileName",get:function(){return this._fileName},set:function(t){this._fileName=t}},{key:"minFilter",get:function(){return this._minFilter},set:function(t){this._minFilter=t}},{key:"magFilter",get:function(){return this._magFilter},set:function(t){this._magFilter=t}},{key:"wrapX",get:function(){return this._wrapX},set:function(t){this._wrapX=t}},{key:"wrapY",get:function(){return this._wrapY},set:function(t){this._wrapY=t}},{key:"size",get:function(){return this._size}},{key:"image",get:function(){return this._image}},{key:"imageData",get:function(){return this._imageData}},{key:"cubeMapImages",get:function(){return this._cubeMapImages}},{key:"cubeMapData",get:function(){return this._cubeMapData}},{key:"video",get:function(){return this._video}},{key:"dataType",get:function(){return this._image?En.IMAGE:this._imageData?En.IMAGE_DATA:this._cubeMapImages?En.CUBEMAP:this._cubeMapData?En.CUBEMAP_DATA:this._video?En.VIDEO:En.NONE}},{key:"create",value:function(){null!==this._texture&&this.destroy(),this._texture=I.Get().texture.create(this.context)}},{key:"setActive",value:function(t){I.Get().texture.setActive(this.context,t)}},{key:"bind",value:function(){I.Get().texture.bind(this.context,this._target,this._texture)}},{key:"unbind",value:function(){u.Unbind(this.context,this._target)}},{key:"setImage",value:function(t,e){void 0===e&&(e=!0),this._size.width=t.width,this._size.height=t.height,I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),I.Get().texture.setTextureWrapY(this.context,this._target,this._texture,this._wrapY),I.Get().texture.setImage(this.context,this._target,this._minFilter,this._magFilter,this._texture,t,e),this._image=t,this._imageData=null,this._cubeMapImages=null,this._cubeMapData=null,this._video=null}},{key:"updateImage",value:function(t,e){void 0===e&&(e=!0),this._size.width=t.width,this._size.height=t.height,I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),I.Get().texture.setTextureWrapY(this.context,this._target,this._texture,this._wrapY),I.Get().texture.setImage(this.context,this._target,this._minFilter,this._magFilter,this._texture,t,e),this._image=t,this._imageData=null,this._cubeMapImages=null,this._cubeMapData=null,this._video=null}},{key:"setImageRaw",value:function(t,e,n,i,r){i||(i=this.context.RGBA),r||(r=this.context.UNSIGNED_BYTE),this._size.width=t,this._size.height=e,I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),I.Get().texture.setTextureWrapY(this.context,this._target,this._texture,this._wrapY),I.Get().texture.setImageRaw(this.context,this._target,this._minFilter,this._magFilter,this._texture,t,e,n,i,r),this._image=null,this._imageData=n,this._cubeMapImages=null,this._cubeMapData=null,this._video=null}},{key:"setCubemap",value:function(t,e,n,i,r,s){I.Get().texture.bind(this.context,this._target,this._texture),I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapY),I.Get().texture.setTextureFilter(this.context,this._target,this._minFilter,this._magFilter),I.Get().texture.setCubemapImage(this.context,kn.POSITIVE_X_FACE,t),I.Get().texture.setCubemapImage(this.context,kn.NEGATIVE_X_FACE,e),I.Get().texture.setCubemapImage(this.context,kn.POSITIVE_Y_FACE,n),I.Get().texture.setCubemapImage(this.context,kn.NEGATIVE_Y_FACE,i),I.Get().texture.setCubemapImage(this.context,kn.POSITIVE_Z_FACE,r),I.Get().texture.setCubemapImage(this.context,kn.NEGATIVE_Z_FACE,s),this._image=null,this._imageData=null,this._cubeMapImages={posX:t,negX:e,posY:n,negY:i,posZ:r,negZ:s},this._cubeMapData=null,this._video=null}},{key:"setCubemapRaw",value:function(t,e,n,i,r,s,o,a){I.Get().texture.bind(this.context,this._target,this._texture),I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapX),I.Get().texture.setTextureWrapX(this.context,this._target,this._texture,this._wrapY),I.Get().texture.setTextureFilter(this.context,this._target,this._minFilter,this._magFilter),I.Get().texture.setCubemapRaw(this.context,kn.POSITIVE_X_FACE,n,t,e),I.Get().texture.setCubemapRaw(this.context,kn.NEGATIVE_X_FACE,i,t,e),I.Get().texture.setCubemapRaw(this.context,kn.POSITIVE_Y_FACE,r,t,e),I.Get().texture.setCubemapRaw(this.context,kn.NEGATIVE_Y_FACE,s,t,e),I.Get().texture.setCubemapRaw(this.context,kn.POSITIVE_Z_FACE,o,t,e),I.Get().texture.setCubemapRaw(this.context,kn.NEGATIVE_Z_FACE,a,t,e),this._image=null,this._imageData=null,this._cubeMapImages=null,this._cubeMapData={width:t,height:e,posX:n,negX:i,posY:r,negY:s,posZ:o,negZ:a},this._video=null}},{key:"setVideo",value:function(t,e){void 0===e&&(e=!0),this._size.width=t.videoWidth,this._size.height=t.videoHeight,I.Get().texture.setVideo(this.context,this._target,this._texture,t,e),this._video=t,this._image=null,this._imageData=null,this._cubeMapImages=null,this._cubeMapData=null}},{key:"destroy",value:function(){I.Get().texture.destroy(this.context,this._texture),this._texture=null,this._minFilter=null,this._magFilter=null,this._fileName=""}},{key:"valid",value:function(){return null!==this._texture}},{key:"update",value:function(){I.Get().texture.updateVideoData(this.context,this._target,this._texture,this._video)}}])&&gn(r.prototype,s),o&&gn(r,o),Object.defineProperty(r,"prototype",{writable:!1}),u}(G);function Sn(t){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sn(t)}function xn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function On(t,e){return On=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},On(t,e)}function Tn(t,e){if(e&&("object"===Sn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function In(t){return In=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},In(t)}var An=function(){return Ye.Get()},Cn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&On(t,e)}(o,t);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=In(i);if(r){var n=In(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Tn(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=s.call(this,t))._frame=new Ue(t),e._frame.vertex=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],e._frame.texCoord0=[1,1,0,1,0,0,1,0],e._frame.index=[0,1,2,2,3,0],e._frame.build(),e.rebuildShaders(),e}return e=o,(n=[{key:"rebuildShaders",value:function(){this.setupShaderSource([this.vertexShaderSource,this.fragmentShaderSource])}},{key:"vertexShaderSource",get:function(){return this._vertexShaderSource||(this._vertexShaderSource=new Ze(Ct.VERTEX),this._vertexShaderSource.addParameter([An().inputs.buffers.vertex,An().inputs.buffers.tex0,{name:"fsTexCoord",dataType:"vec2",role:"out"}]),"webgl1"==I.Get().id&&this._vertexShaderSource.setMainBody("\n                gl_Position = vec4(inVertex,1.0);\n                fsTexCoord = inTex0;")),this._vertexShaderSource}},{key:"fragmentShaderSource",get:function(){return this._fragmentShaderSource||(this._fragmentShaderSource=new Ze(Ct.FRAGMENT),this._fragmentShaderSource.addParameter({name:"fsTexCoord",dataType:"vec2",role:"in"}),"webgl1"==I.Get().id&&this._fragmentShaderSource.setMainBody("\n                gl_FragColor = vec4(0.0,0.0,0.0,1.0);")),this._fragmentShaderSource}},{key:"drawSurface",value:function(t){this.setActive(),this._surface=t,this.bindPolyList(this._frame),this._frame.draw(),this.unbind(),this.clearActive()}}])&&xn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(jt);const Rn={DIFFUSE:1,SPECULAR:2,SHININESS:4,LIGHT_EMISSION:8,REFRACTION_AMOUNT:16,REFLECTION_AMOUNT:32,TEXTURE:64,LIGHT_MAP:128,NORMAL_MAP:256,TEXTURE_OFFSET:512,TEXTURE_SCALE:1024,LIGHT_MAP_OFFSET:2048,LIGHT_MAP_SCALE:4096,NORMAL_MAP_OFFSET:8192,NORMAL_MAP_SCALE:16384,CAST_SHADOWS:32768,RECEIVE_SHADOWS:65536,ALPHA_CUTOFF:1<<17,SHININESS_MASK:1<<18,SHININESS_MASK_CHANNEL:1<<19,SHININESS_MASK_INVERT:1<<20,LIGHT_EMISSION_MASK:1<<21,LIGHT_EMISSION_MASK_CHANNEL:1<<22,LIGHT_EMISSION_MASK_INVERT:1<<23,REFLECTION_MASK:1<<24,REFLECTION_MASK_CHANNEL:1<<25,REFLECTION_MASK_INVERT:1<<26,CULL_FACE:1<<27,ROUGHNESS:1<<28,UNLIT:1<<29};function Nn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Pn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._modifierFlags=0,this._diffuse=de.White(),this._specular=de.White(),this._shininess=0,this._lightEmission=0,this._refractionAmount=0,this._reflectionAmount=0,this._texture=null,this._lightmap=null,this._normalMap=null,this._textureOffset=new ce,this._textureScale=new ce(1),this._lightmapOffset=new ce,this._lightmapScale=new ce(1),this._normalMapOffset=new ce,this._normalMapScale=new ce(1),this._castShadows=!0,this._receiveShadows=!0,this._alphaCutoff=.5,this._shininessMask=null,this._shininessMaskChannel=0,this._shininessMaskInvert=!1,this._lightEmissionMask=null,this._lightEmissionMaskChannel=0,this._lightEmissionMaskInvert=!1,this._reflectionMask=null,this._reflectionMaskChannel=0,this._reflectionMaskInvert=!1,this._cullFace=!0,this._roughness=!0,this._roughnessMask=null,this._roughnessMaskChannel=0,this._roughnessMaskInvert=!1,this._unlit=!1,e&&(void 0!==e.diffuseR&&void 0!==e.diffuseG&&void 0!==e.diffuseB&&(this.diffuse=new de(e.diffuseR,e.diffuseG,e.diffuseB,e.diffuseA?e.diffuseA:1)),void 0!==e.specularR&&void 0!==e.specularG&&void 0!==e.specularB&&(this.specular=new de(e.specularR,e.specularG,e.specularB,e.specularA?e.specularA:1)),void 0!==e.shininess&&(this.shininess=e.shininess),void 0!==e.lightEmission&&(this.lightEmission=e.lightEmission),void 0!==e.refractionAmount&&(this.refractionAmount=e.refractionAmount),void 0!==e.reflectionAmount&&(this.reflectionAmount=e.reflectionAmount),void 0!==e.texture&&(this.texture=e.texture),void 0!==e.lightmap&&(this.lightmap=e.lightmap),void 0!==e.normalMap&&(this.normalMap=e.normalMap),void 0!==e.textureOffsetX&&void 0!==e.textureOffsetY&&(this.textureOffset=new ce(e.textureOffsetX,e.textureOffsetY)),void 0!==e.textureScaleX&&void 0!==e.textureScaleY&&(this.textureScale=new ce(e.textureScaleX,e.textureScaleY)),void 0!==e.lightmapOffsetX&&void 0!==e.lightmapOffsetY&&(this.lightmapOffset=new ce(e.lightmapOffsetX,e.lightmapOffsetY)),void 0!==e.lightmapScaleX&&void 0!==e.lightmapScaleY&&(this.lightmapScale=new ce(e.lightmapScaleX,e.lightmapScaleY)),void 0!==e.normalMapScaleX&&void 0!==e.normalMapScaleY&&(this.normalMapScale=new ce(e.normalMapScaleX,e.normalMapScaleY)),void 0!==e.normalMapOffsetX&&void 0!==e.normalMapOffsetY&&(this.normalMapOffset=new ce(e.normalMapOffsetX,e.normalMapOffsetY)),void 0!==e.castShadows&&(this.castShadows=e.castShadows),void 0!==e.receiveShadows&&(this.receiveShadows=e.receiveShadows),void 0!==e.alphaCutoff&&(this.alphaCutoff=e.alphaCutoff),void 0!==e.shininessMask&&(this.shininessMask=e.shininessMask),void 0!==e.shininessMaskChannel&&(this.shininessMaskChannel=e.shininessMaskChannel),void 0!==e.invertShininessMask&&(this.shininessMaskInvert=e.invertShininessMask),void 0!==e.lightEmissionMask&&(this.lightEmissionMask=e.lightEmissionMask),void 0!==e.lightEmissionMaskChannel&&(this.lightEmissionMaskChannel=e.lightEmissionMaskChannel),void 0!==e.invertLightEmissionMask&&(this.lightEmissionMaskInvert=e.invertLightEmissionMask),void 0!==e.reflectionMask&&(this.reflectionMask=e.reflectionMask),void 0!==e.reflectionMaskChannel&&(this.reflectionMaskChannel=e.reflectionMaskChannel),void 0!==e.invertReflectionMask&&(this.reflectionMaskInvert=e.reflectionMaskInvert),void 0!==e.roughness&&(this.roughness=e.roughness),void 0!==e.roughnessMask&&(this.roughnessMask=e.roughnessMask),void 0!==e.roughnessMaskChannel&&(this.roughnessMaskChannel=e.roughnessMaskChannel),void 0!==e.invertRoughnessMask&&(this.roughnessMaskInvert=e.roughnessMaskInvert),void 0!==e.unlit&&(this.unlit=e.unlit))}var e,n;return e=t,(n=[{key:"modifierFlags",get:function(){return this._modifierFlags},set:function(t){this._modifierFlags=t}},{key:"setEnabled",value:function(t){this._modifierFlags=this._modifierFlags|t}},{key:"isEnabled",value:function(t){return 0!=(this._modifierFlags&t)}},{key:"diffuse",get:function(){return this._diffuse},set:function(t){this._diffuse=t,this.setEnabled(Rn.DIFFUSE)}},{key:"specular",get:function(){return this._specular},set:function(t){this._specular=t,this.setEnabled(Rn.SPECULAR)}},{key:"shininess",get:function(){return this._shininess},set:function(t){isNaN(t)||(this._shininess=t,this.setEnabled(Rn.SHININESS))}},{key:"lightEmission",get:function(){return this._lightEmission},set:function(t){isNaN(t)||(this._lightEmission=t,this.setEnabled(Rn.LIGHT_EMISSION))}},{key:"refractionAmount",get:function(){return this._refractionAmount},set:function(t){isNaN(t)||(this._refractionAmount=t,this.setEnabled(Rn.REFRACTION_AMOUNT))}},{key:"reflectionAmount",get:function(){return this._reflectionAmount},set:function(t){isNaN(t)||(this._reflectionAmount=t,this.setEnabled(Rn.REFLECTION_AMOUNT))}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this.setEnabled(Rn.TEXTURE)}},{key:"lightmap",get:function(){return this._lightmap},set:function(t){this._lightmap=t,this.setEnabled(Rn.LIGHT_MAP)}},{key:"normalMap",get:function(){return this._normalMap},set:function(t){this._normalMap=t,this.setEnabled(Rn.NORMAL_MAP)}},{key:"textureOffset",get:function(){return this._textureOffset},set:function(t){this._textureOffset=t,this.setEnabled(Rn.TEXTURE_OFFSET)}},{key:"textureScale",get:function(){return this._textureScale},set:function(t){this._textureScale=t,this.setEnabled(Rn.TEXTURE_SCALE)}},{key:"lightmapOffset",get:function(){return this._lightmapOffset},set:function(t){this._lightmapOffset=t,this.setEnabled(Rn.LIGHT_MAP_OFFSET)}},{key:"lightmapScale",get:function(){return this._lightmapScale},set:function(t){this._lightmapScale=t,this.setEnabled(Rn.LIGHT_MAP_SCALE)}},{key:"normalMapOffset",get:function(){return this._normalMapOffset},set:function(t){this._normalMapOffset=t,this.setEnabled(Rn.NORMAL_MAP_OFFSET)}},{key:"normalMapScale",get:function(){return this._normalMapScale},set:function(t){this._normalMapScale=t,this.setEnabled(Rn.NORMAL_MAP_SCALE)}},{key:"castShadows",get:function(){return this._castShadows},set:function(t){this._castShadows=t,this.setEnabled(Rn.CAST_SHADOWS)}},{key:"receiveShadows",get:function(){return this._receiveShadows},set:function(t){this._receiveShadows=t,this.setEnabled(Rn.RECEIVE_SHADOWS)}},{key:"alphaCutoff",get:function(){return this._alphaCutoff},set:function(t){isNaN(t)||(this._alphaCutoff=t,this.setEnabled(Rn.ALPHA_CUTOFF))}},{key:"shininessMask",get:function(){return this._shininessMask},set:function(t){this._shininessMask=t,this.setEnabled(Rn.SHININESS_MASK)}},{key:"shininessMaskChannel",get:function(){return this._shininessMaskChannel},set:function(t){this._shininessMaskChannel=t,this.setEnabled(Rn.SHININESS_MASK_CHANNEL)}},{key:"shininessMaskInvert",get:function(){return this._shininessMaskInvert},set:function(t){this._shininessMaskInvert=t,this.setEnabled(Rn.SHININESS_MASK_INVERT)}},{key:"lightEmissionMask",get:function(){return this._lightEmissionMask},set:function(t){this._lightEmissionMask=t,this.setEnabled(Rn.LIGHT_EMISSION_MASK)}},{key:"lightEmissionMaskChannel",get:function(){return this._lightEmissionMaskChannel},set:function(t){this._lightEmissionMaskChannel=t,this.setEnabled(Rn.LIGHT_EMISSION_MASK_CHANNEL)}},{key:"lightEmissionMaskInvert",get:function(){return this._lightEmissionMaskInvert},set:function(t){this._lightEmissionMaskInvert=t,this.setEnabled(Rn.LIGHT_EMISSION_MASK_INVERT)}},{key:"reflectionMask",get:function(){return this._reflectionMask},set:function(t){this._reflectionMask=t,this.setEnabled(Rn.REFLECTION_MASK)}},{key:"reflectionMaskChannel",get:function(){return this._reflectionMaskChannel},set:function(t){this._reflectionMaskChannel=t,this.setEnabled(Rn.REFLECTION_MASK_CHANNEL)}},{key:"reflectionMaskInvert",get:function(){return this._reflectionMaskInvert},set:function(t){this._reflectionMaskInvert=t,this.setEnabled(Rn.REFLECTION_MASK_INVERT)}},{key:"cullFace",get:function(){return this._cullFace},set:function(t){this._cullFace=t,this.setEnabled(Rn.CULL_FACE)}},{key:"roughness",get:function(){return this._roughness},set:function(t){this._roughness=t,this.setEnabled(Rn.ROUGHNESS)}},{key:"roughnessMask",get:function(){return this._roughnessMask},set:function(t){this._roughnessMask=t,this.setEnabled(Rn.ROUGHNESS)}},{key:"roughnessMaskChannel",get:function(){return this._roughnessMaskChannel},set:function(t){this._roughnessMaskChannel=t,this.setEnabled(Rn.ROUGHNESS)}},{key:"roughnessMaskInvert",get:function(){return this._roughnessMaskInvert},set:function(t){this._roughnessMaskInvert=t,this.setEnabled(Rn.ROUGHNESS)}},{key:"unlit",get:function(){return this._unlit},set:function(t){this._unlit=t,this.setEnabled(Rn.UNLIT)}},{key:"clone",value:function(){var e=new t;return e.assign(this),e}},{key:"assign",value:function(t){this._modifierFlags=t._modifierFlags,this._diffuse=t._diffuse,this._specular=t._specular,this._shininess=t._shininess,this._lightEmission=t._lightEmission,this._refractionAmount=t._refractionAmount,this._reflectionAmount=t._reflectionAmount,this._texture=t._texture,this._lightmap=t._lightmap,this._normalMap=t._normalMap,this._textureOffset=t._textureOffset,this._textureScale=t._textureScale,this._lightmapOffset=t._lightmapOffset,this._lightmapScale=t._lightmapScale,this._normalMapOffset=t._normalMapOffset,this._normalMapScale=t._normalMapScale,this._castShadows=t._castShadows,this._receiveShadows=t._receiveShadows,this._alphaCutoff=t._alphaCutoff,this._shininessMask=t._shininessMask,this._shininessMaskChannel=t._shininessMaskChannel,this._shininessMaskInvert=t._shininessMaskInvert,this._lightEmissionMask=t._lightEmissionMask,this._lightEmissionMaskChannel=t._lightEmissionMaskChannel,this._lightEmissionMaskInvert=t._lightEmissionMaskInvert,this._reflectionMask=t._reflectionMask,this._reflectionMaskChannel=t._reflectionMaskChannel,this._reflectionMaskInvert=t._reflectionMaskInvert,this._cullFace=t._cullFace,this._roughness=t._roughness,this._roughnessMask=t._roughnessMask,this._roughnessMaskChannel=t._roughnessMaskChannel,this._roughnessMaskInvert=t._roughnessMaskInvert,this._unlit=t._unlit}},{key:"serialize",value:function(){var t={},e=this._modifierFlags;return e&Rn.DIFFUSE&&(t.diffuseR=this._diffuse.r,t.diffuseG=this._diffuse.g,t.diffuseB=this._diffuse.b,t.diffuseA=this._diffuse.a),e&Rn.SPECULAR&&(t.specularR=this._specular.r,t.specularG=this._specular.g,t.specularB=this._specular.b,t.specularA=this._specular.a),e&Rn.SHININESS&&(t.shininess=this._shininess),e&Rn.SHININESS_MASK&&(t.shininessMask=this._shininessMask),e&Rn.SHININESS_MASK_CHANNEL&&(t.shininessMaskChannel=this._shininessMaskChannel),e&Rn.SHININESS_MASK_INVERT&&(t.invertShininessMask=this._shininessMaskInvert),e&Rn.LIGHT_EMISSION&&(t.lightEmission=this._lightEmission),e&Rn.LIGHT_EMISSION_MASK&&(t.lightEmissionMask=this._lightEmissionMask),e&Rn.LIGHT_EMISSION_MASK_CHANNEL&&(t.lightEmissionMaskChannel=this._lightEmissionMaskChannel),e&Rn.LIGHT_EMISSION_MASK_INVERT&&(t.invertLightEmissionMask=this._lightEmissionMaskInvert),e&Rn.REFRACTION_AMOUNT&&(t.reflectionAmount=this._refractionAmount),e&Rn.REFLECTION_AMOUNT&&(t.refractionAmount=this._reflectionAmount),e&Rn.TEXTURE&&(t.texture=this._texture),e&Rn.LIGHT_MAP&&(t.lightmap=this._lightmap),e&Rn.NORMAL_MAP&&(t.normalMap=this._normalMap),e&Rn.TEXTURE_OFFSET&&(t.textureScaleX=this._textureScale.x,t.textureScaleY=this._textureScale.y),e&Rn.TEXTURE_SCALE&&(t.textureScaleX=this._textureScale.x,t.textureScaleY=this._textureScale.y),e&Rn.LIGHT_MAP_OFFSET&&(t.lightmapOffsetX=this._lightmapOffset.x,t.lightmapOffsetY=this._lightmapOffset.y),e&Rn.LIGHT_MAP_SCALE&&(t.lightmapScaleX=this._lightmapScale.x,t.lightmapScaleY=this._lightmapScale.y),e&Rn.NORMAL_MAP_OFFSET&&(t.normalMapOffsetX=this._normalMapOffset.x,t.normalMapOffsetY=this._normalMapOffset.y),e&Rn.NORMAL_MAP_SCALE&&(t.normalMapScaleX=this._normalMapScale.x,t.normalMapScaleY=this._normalMapScale.y),e&Rn.CAST_SHADOWS&&(t.castShadows=this._castShadows),e&Rn.RECEIVE_SHADOWS&&(t.receiveShadows=this._receiveShadows),e&Rn.ALPHA_CUTOFF&&(t.alphaCutoff=this._alphaCutoff),e&Rn.REFLECTION_MASK&&(t.reflectionMask=this._reflectionMask),e&Rn.REFLECTION_MASK_CHANNEL&&(t.reflectionMaskChannel=this._reflectionMaskChannel),e&Rn.REFLECTION_MASK_INVERT&&(t.invertReflectionMask=this._reflectionMaskInvert),e&Rn.CULL_FACE&&(t.cullFace=this._cullFace),e&Rn.ROUGHNESS&&(t.roughness=this._roughness,t.roughnessMask=this._roughnessMask,t.roughnessMaskChannel=this._roughnessMaskChannel,t.invertRoughnessMask=this._roughnessMaskInvert),e&Rn.UNLIT&&(t.unlit=this._unlit),t}}])&&Nn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Vn(t,e,n){return Mn.FromImage(t,e,n)}function Fn(t){return new _e(0==t?1:0,1==t?1:0,2==t?1:0,3==t?1:0)}function jn(t){if(!t)return null;switch(t.length){case 2:return new ce(t[0],t[1]);case 3:return new fe(t[0],t[1],t[2]);case 4:return new _e(t[0],t[1],t[2],t[3])}return null}var Gn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._diffuse=de.White(),this._specular=de.White(),this._shininess=0,this._lightEmission=0,this._refractionAmount=0,this._reflectionAmount=0,this._texture=null,this._lightmap=null,this._normalMap=null,this._textureOffset=new ce,this._textureScale=new ce(1),this._lightmapOffset=new ce,this._lightmapScale=new ce(1),this._normalMapOffset=new ce,this._normalMapScale=new ce(1),this._castShadows=!0,this._receiveShadows=!0,this._alphaCutoff=.5,this._shininessMask=null,this._shininessMaskChannel=0,this._shininessMaskInvert=!1,this._lightEmissionMask=null,this._lightEmissionMaskChannel=0,this._lightEmissionMaskInvert=!1,this._reflectionMask=null,this._reflectionMaskChannel=0,this._reflectionMaskInvert=!1,this._cullFace=!0,this._roughness=0,this._roughnessMask=null,this._roughnessMaskChannel=0,this._roughnessMaskInvert=!1,this._unlit=!1,this._selectMode=!1}var e,n,i;return e=t,n=[{key:"clone",value:function(){var e=new t;return e.assign(this),e}},{key:"assign",value:function(t){this._diffuse=new de(t.diffuse),this._specular=new de(t.specular),this._shininess=t.shininess,this._lightEmission=t.lightEmission,this._refractionAmount=t.refractionAmount,this._reflectionAmount=t.reflectionAmount,this._texture=t.texture,this._lightmap=t.lightmap,this._normalMap=t.normalMap,this._textureOffset=new ce(t.textureOffset),this._textureScale=new ce(t.textureScale),this._lightmapOffset=new ce(t.ligthmapOffset),this._lightmapScale=new ce(t.lightmapScale),this._normalMapOffset=new ce(t.normalMapOffset),this._normalMapScale=new ce(t.normalMapScale),this._castShadows=t.castShadows,this._receiveShadows=t.receiveShadows,this._alphaCutoff=t.alphaCutoff,this._shininessMask=t.shininessMask,this._shininessMaskChannel=t.shininessMaskChannel,this._shininessMaskInvert=t.shininessMaskInvert,this._lightEmissionMask=t.lightEmissionMask,this._lightEmissionMaskChannel=t.lightEmissionMaskChannel,this._lightEmissionMaskInvert=t.lightEmissionMaskInvert,this._reflectionMask=t.reflectionMask,this._reflectionMaskChannel=t.reflectionMaskChannel,this._reflectionMaskInvert=t.reflectionMaskInvert,this._cullFace=t.cullFace,this._roughness=t.roughness,this._roughnessMask=t.roughnessMask,this._roughnessMaskChannel=t.roughnessMaskChannel,this._roughnessMaskInvert=t.roughnessMaskInvert,this._unlit=t.unlit}},{key:"isTransparent",get:function(){return this._diffuse.a<1}},{key:"diffuse",get:function(){return this._diffuse},set:function(t){this._diffuse=t}},{key:"specular",get:function(){return this._specular},set:function(t){this._specular=t}},{key:"shininess",get:function(){return this._shininess},set:function(t){isNaN(t)||(this._shininess=t)}},{key:"lightEmission",get:function(){return this._lightEmission},set:function(t){isNaN(t)||(this._lightEmission=t)}},{key:"refractionAmount",get:function(){return this._refractionAmount},set:function(t){this._refractionAmount=t}},{key:"reflectionAmount",get:function(){return this._reflectionAmount},set:function(t){this._reflectionAmount=t}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t}},{key:"lightmap",get:function(){return this._lightmap},set:function(t){this._lightmap=t}},{key:"normalMap",get:function(){return this._normalMap},set:function(t){this._normalMap=t}},{key:"textureOffset",get:function(){return this._textureOffset},set:function(t){this._textureOffset=t}},{key:"textureScale",get:function(){return this._textureScale},set:function(t){this._textureScale=t}},{key:"lightmapOffset",get:function(){return this._lightmapOffset},set:function(t){this._lightmapOffset=t}},{key:"lightmapScale",get:function(){return this._lightmapScale},set:function(t){this._lightmapScale=t}},{key:"normalMapOffset",get:function(){return this._normalMapOffset},set:function(t){this._normalMapOffset=t}},{key:"normalMapScale",get:function(){return this._normalMapScale},set:function(t){this._normalMapScale=t}},{key:"castShadows",get:function(){return this._castShadows},set:function(t){this._castShadows=t}},{key:"receiveShadows",get:function(){return this._receiveShadows},set:function(t){this._receiveShadows=t}},{key:"alphaCutoff",get:function(){return this._alphaCutoff},set:function(t){isNaN(t)||(this._alphaCutoff=t)}},{key:"shininessMask",get:function(){return this._shininessMask},set:function(t){this._shininessMask=t}},{key:"shininessMaskChannel",get:function(){return this._shininessMaskChannel},set:function(t){this._shininessMaskChannel=t}},{key:"shininessMaskInvert",get:function(){return this._shininessMaskInvert},set:function(t){this._shininessMaskInvert=t}},{key:"lightEmissionMask",get:function(){return this._lightEmissionMask},set:function(t){this._lightEmissionMask=t}},{key:"lightEmissionMaskChannel",get:function(){return this._lightEmissionMaskChannel},set:function(t){this._lightEmissionMaskChannel=t}},{key:"lightEmissionMaskInvert",get:function(){return this._lightEmissionMaskInvert},set:function(t){this._lightEmissionMaskInvert=t}},{key:"reflectionMask",get:function(){return this._reflectionMask},set:function(t){this._reflectionMask=t}},{key:"reflectionMaskChannel",get:function(){return this._reflectionMaskChannel},set:function(t){this._reflectionMaskChannel=t}},{key:"reflectionMaskInvert",get:function(){return this._reflectionMaskInvert},set:function(t){this._reflectionMaskInvert=t}},{key:"cullFace",get:function(){return this._cullFace},set:function(t){this._cullFace=t}},{key:"roughness",get:function(){return this._roughness},set:function(t){this._roughness=t}},{key:"roughnessMask",get:function(){return this._roughnessMask},set:function(t){this._roughnessMask=t}},{key:"roughnessMaskChannel",get:function(){return this._roughnessMaskChannel},set:function(t){this._roughnessMaskChannel=t}},{key:"roughnessMaskInvert",get:function(){return this._roughnessMaskInvert},set:function(t){this._roughnessMaskInvert=t}},{key:"unlit",get:function(){return this._unlit},set:function(t){this._unlit=t}},{key:"selectMode",get:function(){return this._selectMode},set:function(t){this._selectMode=t}},{key:"lightEmissionMaskChannelVector",get:function(){return Fn(this.lightEmissionMaskChannel)}},{key:"shininessMaskChannelVector",get:function(){return Fn(this.shininessMaskChannel)}},{key:"reflectionMaskChannelVector",get:function(){return Fn(this.reflectionMaskChannel)}},{key:"roughnessMaskChannelVector",get:function(){return Fn(this.roughnessMaskChannel)}},{key:"getExternalResources",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];function e(e){e&&e.fileName&&""!=e.fileName&&-1==t.indexOf(e.fileName)&&t.push(e.fileName)}return e(this.texture),e(this.lightmap),e(this.normalMap),e(this.shininessMask),e(this.lightEmissionMask),e(this.reflectionMask),e(this.roughnessMask),t}},{key:"copyMaterialSettings",value:function(t,e){e&Rn.DIFFUSE&&(t.diffuse=this.diffuse),e&Rn.SPECULAR&&(t.specular=this.specular),e&Rn.SHININESS&&(t.shininess=this.shininess),e&Rn.LIGHT_EMISSION&&(t.lightEmission=this.lightEmission),e&Rn.REFRACTION_AMOUNT&&(t.refractionAmount=this.refractionAmount),e&Rn.REFLECTION_AMOUNT&&(t.reflectionAmount=this.reflectionAmount),e&Rn.TEXTURE&&(t.texture=this.texture),e&Rn.LIGHT_MAP&&(t.lightmap=this.lightmap),e&Rn.NORMAL_MAP&&(t.normalMap=this.normalMap),e&Rn.TEXTURE_OFFSET&&(t.textureOffset=this.textureOffset),e&Rn.TEXTURE_SCALE&&(t.textureScale=this.textureScale),e&Rn.LIGHT_MAP_OFFSET&&(t.lightmapOffset=this.lightmapOffset),e&Rn.LIGHT_MAP_SCALE&&(t.lightmapScale=this.lightmapScale),e&Rn.NORMAL_MAP_OFFSET&&(t.normalMapOffset=this.normalMapOffset),e&Rn.NORMAL_MAP_SCALE&&(t.normalMapScale=this.normalMapScale),e&Rn.CAST_SHADOWS&&(t.castShadows=this.castShadows),e&Rn.RECEIVE_SHADOWS&&(t.receiveShadows=this.receiveShadows),e&Rn.ALPHA_CUTOFF&&(t.alphaCutoff=this.alphaCutoff),e&Rn.SHININESS_MASK&&(t.shininessMask=this.shininessMask),e&Rn.SHININESS_MASK_CHANNEL&&(t.shininessMaskChannel=this.shininessMaskChannel),e&Rn.SHININESS_MASK_INVERT&&(t.shininessMaskInvert=this.shininessMaskInvert),e&Rn.LIGHT_EMISSION_MASK&&(t.lightEmissionMask=this.lightEmissionMask),e&Rn.LIGHT_EMISSION_MASK_CHANNEL&&(t.lightEmissionMaskChannel=this.lightEmissionMaskChannel),e&Rn.LIGHT_EMISSION_MASK_INVERT&&(t.lightEmissionMaskInvert=this.lightEmissionMaskInvert),e&Rn.REFLECTION_MASK&&(t.reflectionMask=this.reflectionMask),e&Rn.REFLECTION_MASK_CHANNEL&&(t.reflectionMaskChannel=this.reflectionMaskChannel),e&Rn.REFLECTION_MASK_INVERT&&(t.reflectionMaskInvert=this.reflectionMaskInvert),e&Rn.CULL_FACE&&(t.cullFace=this.cullFace),e&Rn.ROUGHNESS&&(t.reflectionAmount=this.reflectionAmount,t.reflectionMask=this.reflectionMask,t.reflectionMaskChannel=this.reflectionMaskChannel,t.reflectionMaskInvert=this.reflectionMaskInvert),e&Rn.UNLIT&&(t.unlit=this.unlit)}},{key:"applyModifier",value:function(t,e,n){e.isEnabled(Rn.DIFFUSE)&&(this.diffuse=e.diffuse),e.isEnabled(Rn.SPECULAR)&&(this.specular=e.specular),e.isEnabled(Rn.SHININESS)&&(this.shininess=e.shininess),e.isEnabled(Rn.LIGHT_EMISSION)&&(this.lightEmission=e.lightEmission),e.isEnabled(Rn.REFRACTION_AMOUNT)&&(this.refractionAmount=e.refractionAmount),e.isEnabled(Rn.REFLECTION_AMOUNT)&&(this.reflectionAmount=e.reflectionAmount),e.isEnabled(Rn.TEXTURE)&&(this.texture=getTexture(t,e.texture,n)),e.isEnabled(Rn.LIGHT_MAP)&&(this.lightmap=getTexture(t,e.lightmap,n)),e.isEnabled(Rn.NORMAL_MAP)&&(this.normalMap=getTexture(t,e.normalMap,n)),e.isEnabled(Rn.TEXTURE_OFFSET)&&(this.textureOffset=e.textureOffset),e.isEnabled(Rn.TEXTURE_SCALE)&&(this.textureScale=e.textureScale),e.isEnabled(Rn.LIGHT_MAP_OFFSET)&&(this.lightmapOffset=e.lightmapOffset),e.isEnabled(Rn.LIGHT_MAP_SCALE)&&(this.lightmapScale=e.lightmapScale),e.isEnabled(Rn.NORMAL_MAP_OFFSET)&&(this.normalMapOffset=e.normalMapOffset),e.isEnabled(Rn.NORMAL_MAP_SCALE)&&(this.normalMapScale=e.normalMapScale),e.isEnabled(Rn.CAST_SHADOWS)&&(this.castShadows=e.castShadows),e.isEnabled(Rn.RECEIVE_SHADOWS)&&(this.receiveShadows=e.receiveShadows),e.isEnabled(Rn.ALPHA_CUTOFF)&&(this.alphaCutoff=e.alphaCutoff),e.isEnabled(Rn.SHININESS_MASK)&&(this.shininessMask=getTexture(t,e.shininessMask,n)),e.isEnabled(Rn.SHININESS_MASK_CHANNEL)&&(this.shininessMaskChannel=e.shininessMaskChannel),e.isEnabled(Rn.SHININESS_MASK_INVERT)&&(this.shininessMaskInvert=e.shininessMaskInvert),e.isEnabled(Rn.LIGHT_EMISSION_MASK)&&(this.lightEmissionMask=getTexture(t,e.lightEmissionMask,n)),e.isEnabled(Rn.LIGHT_EMISSION_MASK_CHANNEL)&&(this.lightEmissionMaskChannel=e.lightEmissionMaskChannel),e.isEnabled(Rn.LIGHT_EMISSION_MASK_INVERT)&&(this.lightEmissionMaskInvert=e.lightEmissionMaskInvert),e.isEnabled(Rn.REFLECTION_MASK)&&(this.reflectionMask=getTexture(t,e.reflectionMask,n)),e.isEnabled(Rn.REFLECTION_MASK_CHANNEL)&&(this.reflectionMaskChannel=e.reflectionMaskChannel),e.isEnabled(Rn.REFLECTION_MASK_INVERT)&&(this.reflectionMaskInvert=e.reflectionMaskInvert),e.isEnabled(Rn.CULL_FACE)&&(this.cullFace=e.cullFace),e.isEnabled(Rn.ROUGHNESS)&&(this.roughness=e.roughness,this.roughnessMask=getTexture(t,e.roughnessMask,n),this.roughnessMaskChannel=e.roughnessMaskChannel,this.roughnessMaskInvert=e.roughnessMaskInvert),e.isEnabled(Rn.UNLIT)&&(this.unlit=e.unlit)}},{key:"getModifierWithMask",value:function(t){var e=new Pn;return e.modifierFlags=t,e.isEnabled(Rn.DIFFUSE)&&(e.diffuse=this.diffuse),e.isEnabled(Rn.SPECULAR)&&(e.specular=this.specular),e.isEnabled(Rn.SHININESS)&&(e.shininess=this.shininess),e.isEnabled(Rn.LIGHT_EMISSION)&&(e.lightEmission=this.lightEmission),e.isEnabled(Rn.REFRACTION_AMOUNT)&&(e.refractionAmount=this.refractionAmount),e.isEnabled(Rn.REFLECTION_AMOUNT)&&(e.reflectionAmount=this.reflectionAmount),e.isEnabled(Rn.TEXTURE)&&(e.texture=getPath(this.texture)),e.isEnabled(Rn.LIGHT_MAP)&&(e.lightmap=getPath(this.lightmap)),e.isEnabled(Rn.NORMAL_MAP)&&(e.normalMap=getPath(this.normalMap)),e.isEnabled(Rn.TEXTURE_OFFSET)&&(e.textureOffset=this.textureOffset),e.isEnabled(Rn.TEXTURE_SCALE)&&(e.textureScale=this.textureScale),e.isEnabled(Rn.LIGHT_MAP_OFFSET)&&(e.lightmapOffset=this.lightmapOffset),e.isEnabled(Rn.LIGHT_MAP_SCALE)&&(e.lightmapScale=this.lightmapScale),e.isEnabled(Rn.NORMAL_MAP_OFFSET)&&(e.normalMapOffset=this.normalMapOffset),e.isEnabled(Rn.NORMAL_MAP_SCALE)&&(e.normalMapScale=this.normalMapScale),e.isEnabled(Rn.CAST_SHADOWS)&&(e.castShadows=this.castShadows),e.isEnabled(Rn.RECEIVE_SHADOWS)&&(e.receiveShadows=this.receiveShadows),e.isEnabled(Rn.ALPHA_CUTOFF)&&(e.alphaCutoff=this.alphaCutoff),e.isEnabled(Rn.SHININESS_MASK)&&(e.shininessMask=getPath(this.shininessMask)),e.isEnabled(Rn.SHININESS_MASK_CHANNEL)&&(e.shininessMaskChannel=this.shininessMaskChannel),e.isEnabled(Rn.SHININESS_MASK_INVERT)&&(e.shininessMaskInvert=this.shininessMaskInvert),e.isEnabled(Rn.LIGHT_EMISSION_MASK)&&(e.lightEmissionMask=getPath(this.lightEmissionMask)),e.isEnabled(Rn.LIGHT_EMISSION_MASK_CHANNEL)&&(e.lightEmissionMaskChannel=this.lightEmissionMaskChannel),e.isEnabled(Rn.LIGHT_EMISSION_MASK_INVERT)&&(e.lightEmissionMaskInver=this.lightEmissionMaskInver),e.isEnabled(Rn.REFLECTION_MASK)&&(e.reflectionMask=getPath(this.reflectionMask)),e.isEnabled(Rn.REFLECTION_MASK_CHANNEL)&&(e.reflectionMaskChannel=this.reflectionMaskChannel),e.isEnabled(Rn.REFLECTION_MASK_INVERT)&&(e.reflectionMaskInvert=this.reflectionMaskInvert),e.isEnabled(Rn.CULL_FACE)&&(e.cullFace=this.cullFace),e.isEnabled(Rn.ROUGHNESS)&&(e.roughness=this.roughness,e.roughnessMask=getPath(this.roughnessMask),e.roughnessMaskChannel=this.roughnessMaskChannel,e.roughnessMaskInvert=this.roughnessMaskInvert),e.isEnabled(Rn.UNLIT)&&(e.unlit=this.unlit),e}}],i=[{key:"FromMaterialDefinition",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new Promise((function(r,s){var o=new t;o.diffuse=jn(n.diffuse)||de.White(),o.specular=jn(n.specular)||de.White(),o.shininess=n.shininess||0,o.shininessMaskChannel=n.shininessMaskChannel||0,o.shininessMaskInvert=n.shininessMaskInvert||!1,o.lightEmission=n.lightEmission||0,o.lightEmissionMaskChannel=n.lightEmissionMaskChannel||0,o.lightEmissionMaskInvert=n.lightEmissionMaskInvert||!1,o.refractionAmount=n.refractionAmount||0,o.reflectionAmount=n.reflectionAmount||0,o.reflectionMaskChannel=n.reflectionMaskChannel||0,o.reflectionMaskInvert=n.reflectionMaskInvert||!1,o.textureOffset=jn(n.textureOffset)||new ce(0,0),o.textureScale=jn(n.textureScale)||new ce(1,1),o.normalMapOffset=jn(n.normalMapOffset)||new ce(0,0),o.normalMapScale=jn(n.normalMapScale)||new ce(1,1),o.cullFace=void 0===n.cullFace||n.cullFace,o.castShadows=void 0===n.castShadows||n.castShadows,o.receiveShadows=void 0===n.receiveShadows||n.receiveShadows,o.alphaCutoff=void 0===n.alphaCutoff?.5:n.alphaCutoff,o.name=n.name,o.description=n.description,o.roughness=n.roughness||0,o.roughnessMaskChannel=n.roughnessMaskChannel||0,o.roughnessMaskInvert=n.roughnessMaskInvert||!1,o.unlit=n.unlit||!1;var a=[];a.push(readTexture(e,i,n.shininessMask,o,"shininessMask")),a.push(readTexture(e,i,n.lightEmissionMask,o,"lightEmissionMask")),a.push(readTexture(e,i,n.reflectionMask,o,"reflectionMask")),a.push(readTexture(e,i,n.texture,o,"texture")),a.push(readTexture(e,i,n.normalMap,o,"normalMap")),a.push(readTexture(e,i,n.roughnessMask,o,"roughnessMask")),Promise.all(a).then((function(){r(o)}))}))}},{key:"GetMaterialWithJson",value:function(e,n,i){var r=new t;function s(t,e){return e?t?t+e:e:null}return void 0===n.cullFace&&(n.cullFace=!0),r.diffuse.set(n.diffuseR,n.diffuseG,n.diffuseB,n.diffuseA),r.specular.set(n.specularR,n.specularG,n.specularB,n.specularA),r.shininess=n.shininess,r.lightEmission=n.lightEmission,r.refractionAmount=n.refractionAmount,r.reflectionAmount=n.reflectionAmount,r.textureOffset.set(n.textureOffsetX,n.textureOffsetY),r.textureScale.set(n.textureScaleX,n.textureScaleY),r.lightmapOffset.set(n.lightmapOffsetX,n.lightmapOffsetY),r.lightmapScale.set(n.lightmapScaleX,n.lightmapScaleY),r.normalMapOffset.set(n.normalMapOffsetX,n.normalMapOffsetY),r.normalMapScale.set(n.normalMapScaleX,n.normalMapScaleY),r.alphaCutoff=n.alphaCutoff,r.castShadows=n.castShadows,r.receiveShadows=n.receiveShadows,r.shininessMaskChannel=n.shininessMaskChannel,r.shininessMaskInvert=n.invertShininessMask,r.lightEmissionMaskChannel=n.lightEmissionMaskChannel,r.lightEmissionMaskInvert=n.invertLightEmissionMask,r.reflectionMaskChannel=n.reflectionMaskChannel,r.reflectionMaskInvert=n.invertReflectionMask,r.roughness=n.roughness,r.roughnessMaskChannel=n.roughnessMaskChannel,r.roughnessMaskInvert=n.invertRoughnessMask,r.cullFace=n.cullFace,r.unlit=n.unlit,i&&"/"!=i[i.length-1]&&(i+="/"),n.texture=s(i,n.texture),n.lightmap=s(i,n.lightmap),n.normalMap=s(i,n.normalMap),n.shininessMask=s(i,n.shininessMask),n.lightEmissionMask=s(i,n.lightEmissionMask),n.reflectionMask=s(i,n.reflectionMask),n.roughnessMask=s(i,n.roughnessMask),new Promise((function(t,i){var s=[];n.texture&&s.push(n.texture),n.lightmap&&-1==s.indexOf(n.lightmap)&&s.push(n.lightmap),n.normalMap&&-1==s.indexOf(n.normalMap)&&s.push(n.normalMap),n.shininessMask&&-1==s.indexOf(n.shininessMask)&&s.push(n.shininessMask),n.lightEmissionMask&&-1==s.indexOf(n.lightEmissionMask)&&s.push(n.lightEmissionMask),n.reflectionMask&&-1==s.indexOf(n.reflectionMask)&&s.push(n.reflectionMask),n.roughnessMask&&-1==s.indexOf(n.roughnessMask)&&s.push(n.roughnessMask),O.Load(s).then((function(i){r.texture=Vn(e,i[n.texture],n.texture),r.lightmap=Vn(e,i[n.lightmap],n.lightmap),r.normalMap=Vn(e,i[n.normalMap],n.normalMap),r.shininessMask=Vn(e,i[n.shininessMask],n.shininessMask),r.lightEmissionMask=Vn(e,i[n.lightEmissionMask],n.lightEmissionMask),r.reflectionMask=Vn(e,i[n.reflectionMask],n.reflectionMask),r.roughnessMask=Vn(e,i[n.roughnessMask],n.roughnessMask),t(r)}))}))}}],n&&Ln(e.prototype,n),i&&Ln(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Bn(t){return Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bn(t)}function Dn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Un(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xn(t,e){return Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xn(t,e)}function Hn(t,e){if(e&&("object"===Bn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function zn(t){return zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},zn(t)}var Wn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xn(t,e)}(o,bg.base.LoaderPlugin);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=zn(i);if(r){var n=zn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Hn(this,t)});function o(){return Dn(this,o),s.apply(this,arguments)}return e=o,(n=[{key:"acceptType",value:function(t,e){return"bg2mat"==O.GetExtension(t)}},{key:"load",value:function(t,e,n){return new Promise((function(i,r){if(n)try{"string"==typeof n&&(n=JSON.parse(n));var s=[],o=e.substring(0,e.lastIndexOf("/")+1);n.forEach((function(e){s.push(Gn.FromMaterialDefinition(t,e,o))})),Promise.all(s).then((function(t){i(t)}))}catch(t){r(t)}else r(new Error("Error loading material. Data is null."))}))}}])&&Un(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}();function Yn(t){return Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yn(t)}function Kn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qn(t,e){return qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qn(t,e)}function Zn(t,e){if(e&&("object"===Yn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Jn(t){return Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Jn(t)}var Qn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qn(t,e)}(o,bg.base.LoaderPlugin);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Jn(i);if(r){var n=Jn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Zn(this,t)});function o(){return Kn(this,o),s.apply(this,arguments)}return e=o,(n=[{key:"acceptType",value:function(t,e){return bg.utils.Resource.IsVideo(t)}},{key:"load",value:function(t,e,n){return new Promise((function(i,r){if(n){var s=new bg.base.Texture(t);s.create(),s.bind(),s.setVideo(n),s.fileName=e,i(s)}else r(new Error("Error loading video texture data"))}))}}])&&$n(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}();window.s_bg_base_imageTools={base64Images:{}};const ti={Bg2matLoaderPlugin:Wn,BufferType:Be,Effect:jt,DrawMode:De,imageTools:{isAbsolutePath:function(t){return/^(f|ht)tps?:\/\//i.test(t)},mergePaths:function(t,e){return"/"!=t.slice(-1)?t+"/"+e:t+e},getTexture:function(t,e,n){var i,r,s=null;return e&&(isAbsolutePath(e)||("/"!=n.slice(-1)&&(n+="/"),e="".concat(n).concat(e)),(s=an.Get(t).find(e))||((s=new Mn(t)).create(),s.fileName=e,an.Get(t).register(e,s),i=e,r=s,O.Load(i).then((function(t){r.bind(),s.minFilter=mn.GetMinFilter(),s.magFilter=mn.GetMagFilter(),r.fileName=i,r.setImage(t)})))),s},getPath:function(t){return t?t.fileName:""},readTexture:function(t,e,n,i,r){return new Promise((function(s){if(n)if(/data\:image\/[a-z]+\;base64\,/.test(n)){var o=R(n);window.s_bg_base_imageTools.base64Images[o]?i[r]=window.s_bg_base_imageTools.base64Images[o]:(i[r]=Mn.FromBase64Image(t,n),window.s_bg_base_imageTools.base64Images[o]=i[r]),s(i[r])}else{var a=e+n;Yt.Load(t,a).then((function(t){i[r]=t,s(t)}))}else s()}))}},LoaderPlugin:Xt,Loader:Yt,PolyList:Ue,MaterialFlag:Rn,Material:Gn,MaterialModifier:Pn,ShaderType:Ct,Shader:Rt,ShaderLibrary:Ye,ShaderSource:Ze,TextureUnit:{TEXTURE_0:0,TEXTURE_1:1,TEXTURE_2:2,TEXTURE_3:3,TEXTURE_4:4,TEXTURE_5:5,TEXTURE_6:6,TEXTURE_7:7,TEXTURE_8:8,TEXTURE_9:9,TEXTURE_10:10,TEXTURE_11:11,TEXTURE_12:12,TEXTURE_13:13,TEXTURE_14:14,TEXTURE_15:15,TEXTURE_16:16,TEXTURE_17:17,TEXTURE_18:18,TEXTURE_19:19,TEXTURE_20:20,TEXTURE_21:21,TEXTURE_22:22,TEXTURE_23:23,TEXTURE_24:24,TEXTURE_25:25,TEXTURE_26:26,TEXTURE_27:27,TEXTURE_28:28,TEXTURE_29:29,TEXTURE_30:30},TextureWrap:bn,TextureFilter:wn,TextureTarget:kn,TextureDataType:En,Texture:Mn,TextureCache:an,TextureEffect:Cn,TextureLoaderPlugin:mn,VideoTextureLoaderPlugin:Qn};function ei(t){return ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ei(t)}function ni(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ii(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ri(t,e){return ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ri(t,e)}function si(t,e){if(e&&("object"===ei(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oi(t){return oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},oi(t)}var ai=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ri(t,e)}(o,t);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=oi(i);if(r){var n=oi(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return si(this,t)});function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return ni(this,o),(t=s.call(this,new Qt(6)))._v[0]=e,t._v[1]=n,t._v[2]=i,t._v[3]=r,t._v[4]=a,t._v[5]=u,t}return e=o,(n=[{key:"elemAtIndex",value:function(t){return this._v[t]}},{key:"equals",value:function(t){return this._v[0]==t._v[0]&&this._v[1]==t._v[1]&&this._v[2]==t._v[2]&&this._v[3]==t._v[3]&&this._v[4]==t._v[4]&&this._v[5]==t._v[5]}},{key:"notEquals",value:function(t){return this._v[0]!=t._v[0]||this._v[1]!=t._v[1]||this._v[2]!=t._v[2]||this._v[3]!=t._v[3]||this._v[4]!=t._v[4]||this._v[5]!=t._v[5]}},{key:"assign",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],this._v[2]=t._v[2],this._v[3]=t._v[3],this._v[4]=t._v[4],this._v[5]=t._v[5]}},{key:"set",value:function(t,e,n,i,r,s){this._v[0]=t,this._v[1]=void 0===e?t:e,this._v[2]=void 0===e?t:n,this._v[3]=void 0===e?t:i,this._v[4]=void 0===e?t:r,this._v[5]=void 0===e?t:s}},{key:"left",get:function(){return this._v[0]},set:function(t){this._v[0]=t}},{key:"right",get:function(){return this._v[1]},set:function(t){this._v[1]=t}},{key:"bottom",get:function(){return this._v[2]},set:function(t){this._v[2]=t}},{key:"top",get:function(){return this._v[3]},set:function(t){this._v[3]=t}},{key:"back",get:function(){return this._v[4]},set:function(t){this._v[4]=t}},{key:"front",get:function(){return this._v[5]},set:function(t){this._v[5]=t}},{key:"width",get:function(){return Math.abs(this._v[1]-this._v[0])}},{key:"height",get:function(){return Math.abs(this._v[3]-this._v[2])}},{key:"depth",get:function(){return Math.abs(this._v[5]-this._v[4])}},{key:"isNan",value:function(){return isNaN(this._v[0])||isNaN(this._v[1])||isNaN(this._v[2])||isNaN(this._v[3])||isNaN(this._v[4])||isNaN(this._v[5])}},{key:"toString",value:function(){return"["+this._v+"]"}},{key:"isInBounds",value:function(t){return t.x>=this._v[0]&&t.x<=this._v[1]&&t.y>=this._v[2]&&t.y<=this._v[3]&&t.z>=this._v[4]&&t.z<=this._v[5]}}])&&ii(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(le);function ui(t){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(t)}function hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function li(t,e){return li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},li(t,e)}function ci(t,e){if(e&&("object"===ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fi(t){return fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},fi(t)}var _i=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&li(t,e)}(a,t);var e,n,i,r,s,o=(r=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=fi(r);if(s){var n=fi(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return ci(this,t)});function a(t,e,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),r=o.call(this),void 0===t?r.zero():void 0===e?t._v&&t._v.lenght>=4?r.clone(t):t._m&&9==t._m.length?r.initWithMatrix3(t):t._m&&16==t._m.length?r.initWithMatrix4(t):r.zero():void 0!==t&&void 0!==e&&void 0!==n&&void 0!==i?r.initWithValues(t,e,n,i):r.zero(),r}return e=a,i=[{key:"MakeWithMatrix",value:function(t){return new a(t)}}],(n=[{key:"initWithValues",value:function(t,e,n,i){return this._v[0]=e*xe(t/2),this._v[1]=n*xe(t/2),this._v[2]=i*xe(t/2),this._v[3]=Oe(t/2),this}},{key:"clone",value:function(t){this._v[0]=t._v[0],this._v[1]=t._v[1],this._v[2]=t._v[2],this._v[3]=t._v[3]}},{key:"initWithMatrix3",value:function(t){var e=Ae(1+t._m[0]+t._m[4]+t._m[8])/2,n=4*e;this._v[0]=(t._m[7]-t._m[5])/e,this._v[1]=(t._m[2]-t._m[6])/n,this._v[2]=(t._m[3]-t._m[1])/n,this._v[3]=e}},{key:"initWithMatrix4",value:function(t){var e=Ae(1+t._m[0]+t._m[5]+t._m[10])/2,n=4*e;this._v[0]=(t._m[9]-t._m[6])/e,this._v[1]=(t._m[2]-t._m[8])/n,this._v[2]=(t._m[4]-t._m[1])/n,this._v[3]=e}},{key:"getMatrix4",value:function(){var t=Pe.Identity(),e=this._v;return t.setRow(0,new _e(1-2*e[1]*e[1]-2*e[2]*e[2],2*e[0]*e[1]-2*e[2]*e[3],2*e[0]*e[2]+2*e[1]*e[3],0)),t.setRow(1,new _e(2*e[0]*e[1]+2*e[2]*e[3],1-2*e[0]*e[0]-2*e[2]*e[2],2*e[1]*e[2]-2*e[0]*e[3],0)),t.setRow(2,new _e(2*e[0]*e[2]-2*e[1]*e[3],2*e[1]*e[2]+2*e[0]*e[3],1-2*e[0]*e[0]-2*e[1]*e[1],0)),t}},{key:"getMatrix3",value:function(){var t=ke.Identity(),e=this._v;return t.setRow(0,new Vector3(1-2*e[1]*e[1]-2*e[2]*e[2],2*e[0]*e[1]-2*e[2]*e[3],2*e[0]*e[2]+2*e[1]*e[3])),t.setRow(1,new Vector3(2*e[0]*e[1]+2*e[2]*e[3],1-2*e[0]*e[0]-2*e[2]*e[2],2*e[1]*e[2]-2*e[0]*e[3])),t.setRow(2,new Vector3(2*e[0]*e[2]-2*e[1]*e[3],2*e[1]*e[2]+2*e[0]*e[3],1-2*e[0]*e[0]-2*e[1]*e[1])),t}}])&&hi(e.prototype,n),i&&hi(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}(_e);const mi={utils:L,app:St,base:ti,math:{Axis:Kt,PI:$t,DEG_TO_RAD:qt,RAD_TO_DEG:Zt,PI_2:1.5707963267948966,PI_4:.785398163397448,PI_8:.392699081698724,TWO_PI:6.283185307179586,EPSILON:Jt,NumericArray:Qt,NumericArrayHighP:te,FLOAT_MAX:3402823e32,checkPowerOfTwo:Me,checkZero:Se,equals:function(t,e){return Math.abs(t-e)<Jt},degreesToRadians:function(t){return Math.fround(Se(t*qt))},radiansToDegrees:function(t){return Math.fround(Se(t*Zt))},sin:xe,cos:Oe,tan:Te,cotan:function(t){return Math.fround(Se(1/Te(t)))},atan:function(t){return Math.fround(Se(Math.atan(t)))},atan2:function(t,e){return Math.fround(Se(Math.atan2f(t,e)))},random:function(){return Math.random()},seededRandom:Ie,max:function(t,e){return Math.fround(Math.max(t,e))},min:function(t,e){return Math.fround(Math.min(t,e))},abs:function(t){return Math.fround(Math.abs(t))},sqrt:Ae,lerp:function(t,e,n){return Math.fround((1-n)*t+n*e)},square:function(t){return Math.fround(t*t)},Vector:le,Vector2:ce,Vector3:fe,Vector4:_e,Size2D:me,Size3D:pe,Position2D:ve,Viewport:ye,Color:de,Bounds:ai,Quaternion:_i,Matrix3:ke,Matrix4:Pe}}},9:(t,e,n)=>{function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.d(e,{Z:()=>r}),t=n.hmd(t);var r=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,r;return n=e,(r=[{key:"isElectronApp",get:function(){return!!t.exports}}])&&i(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}()}},i={};function r(t){var e=i[t];if(void 0!==e)return e.exports;var s=i[t]={id:t,loaded:!1,exports:{}};return n[t](s,s.exports,r),s.loaded=!0,s.exports}return r.m=n,r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.f={},r.e=t=>Promise.all(Object.keys(r.f).reduce(((e,n)=>(r.f[n](t,e),e)),[])),r.u=t=>t+".0f670139fc44daab623c.js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="bg2e:",r.l=(n,i,s,o)=>{if(t[n])t[n].push(i);else{var a,u;if(void 0!==s)for(var h=document.getElementsByTagName("script"),l=0;l<h.length;l++){var c=h[l];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==e+s){a=c;break}}a||(u=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",e+s),a.src=n),t[n]=[i];var f=(e,i)=>{a.onerror=a.onload=null,clearTimeout(_);var r=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(i))),e)return e(i)},_=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),u&&document.head.appendChild(a)}},r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={179:0};r.f.j=(e,n)=>{var i=r.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise(((n,r)=>i=t[e]=[n,r]));n.push(i[2]=s);var o=r.p+r.u(e),a=new Error;r.l(o,(n=>{if(r.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,s,[o,a,u]=n,h=0;if(o.some((e=>0!==t[e]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);u&&u(r)}for(e&&e(n);h<o.length;h++)s=o[h],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0},n=self.webpackChunkbg2e=self.webpackChunkbg2e||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),r(2)})()}));
//# sourceMappingURL=bg2e.js.map